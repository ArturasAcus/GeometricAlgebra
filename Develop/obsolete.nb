(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    565229,      12888]
NotebookOptionsPosition[    557444,      12764]
NotebookOutlinePosition[    557938,      12784]
CellTagsIndexPosition[    557895,      12781]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Obsolete functions  from Geometric Algebra & Calculus", "Title",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"9afea453-cc25-4c79-a71c-e5dfbdd1d324"],

Cell[TextData[StyleBox["Last edit (2022-05-30). ",
 FontSize->16]], "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"4e44f443-be07-4aab-b2e3-346b3c4e2be1"]
}, Open  ]],

Cell[TextData[StyleBox["Here is placed rarely used functions and functions \
which was reimplemented in a better way.  If your still need them, run them  \
from this notebook (from a global context). The original position of the  \
obsolete functions was not changed",
 FontSize->16]], "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"b7096c71-859b-4301-9d48-460b7bed196f"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".Copyright,  License, credit, references and notes"
}], "Section",ExpressionUUID->"d8cfecff-afda-4dd1-b50c-05b0a8572010"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Setup & configuration"
}], "Section",ExpressionUUID->"246089b4-9667-4177-8ba9-b641a2c1b982"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Initialization"
}], "Section",ExpressionUUID->"2153a712-150f-4eab-9c82-4673c6899f50"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Objects: orthonormal base notation, definition and internal \
representations"
}], "Section",ExpressionUUID->"d373e055-74a0-4e3d-a30c-88ebbd8d41d2"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Products and expansions"
}], "Section",ExpressionUUID->"304188e1-9b37-431a-8354-d6f45e36f849"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Groebner Basis (only sorting is implemented at the moment)"
}], "Section",ExpressionUUID->"5a369682-a6ac-4123-ba78-b7d12d19d351"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Involutions and mathematical functions of multivectors"
}], "Section",ExpressionUUID->"60614cca-24a6-49cb-92b4-25008c1bebb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TheContextSymbolList", "=", 
   RowBox[{"{", 
    RowBox[{"gaSqrt", ",", "gaSqrtN", ",", "gaEliminateGrade"}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"6300459f-05d0-43dc-a673-2dcc3f54f916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeclareIntoContext", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"Unprotect", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"ClearAll", "@@", "TheContextSymbolList"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "TheContextSymbolList", "]"}], ";"}]}], "Input",
 CellLabel->
  "In[489]:=",ExpressionUUID->"f12f28a6-7fcc-4d1c-8984-9448d950161d"],

Cell["\<\
gaSqrt[ ] is now obsolete. The gaEliminateGrade[ ] was removed (it was \
devoted to specific purpose). Run these functions after loading GA package! \
Functions will be created in the global context!\
\>", "Text",ExpressionUUID->"f2fd5974-1777-4119-8d78-63f518bd19a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "usage"}], "=", 
   "\"\<gaEliminateGrade[multivector_,eliminateGrade_List,opts___?OptionQ] is \
a command, which multiplies the given general multivector by the same \
multivector acted by involution from the right in attempt to remove from the \
product grades listed in eliminateGrade list. Empty output means that given \
grades cannot be eliminated by mentioned procedure.\>\""}], ";", 
  RowBox[{
   RowBox[{"OutputType", "::", "usage"}], "=", 
   "\"\<OutputType is an option for gaEliminateGrade[], which change output \
presentation. Possible values are SignChangeGrades and Evaluation \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvolutionPosition", "::", "usage"}], "=", 
   "\"\<InvolutionPosition is an option for gaEliminateGrade[], which decides \
from which side invuluted multivector is multiplied. Possible values are \
Right (default) and Left.\>\""}], ";"}]}], "Input",
 CellLabel->
  "In[506]:=",ExpressionUUID->"861ce4db-13c5-4c7e-94a6-7b3f35ef7cae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "::", "usage"}], "=", 
   "\"\<Old implementation. Yields square root of general multivector in \
radicals. Works for vector space dimension n\[LessEqual]3 only.\>\""}], 
  ";"}]], "Input",ExpressionUUID->"e53eb3a5-3dbb-4160-b104-0fe712990f26"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Unary operators"
}], "Subsection",ExpressionUUID->"c5c60def-87c3-4330-baa1-b293dc3443c3"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Involutions, conjugations and Hodge dual"
}], "Subsubsection",ExpressionUUID->"cbda8825-46d2-4dbc-bf15-a559fedee625"],

Cell[CellGroupData[{

Cell[TextData[{
 "Specialized command ",
 StyleBox["gaEliminateGrade[ ]",
  FontWeight->"Bold"],
 ", which try to eliminate grades in the geometric product using grade \
negations only"
}], "Item",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10002.},ExpressionUUID->"6d0cb4c2-0d15-4321-826a-9aff885a5b2b"],

Cell["\<\
gaEliminateGrade takes multivector and by multiplying on the same multivector \
on the right, acted by gaGradeNegate tries to remove listed grades in the \
product. \
\>", "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10002.},ExpressionUUID->"b13b6fce-2f0d-49d4-ad75-161c51c20775"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "zero"}], "=", 
   "\"\<Zero grade in elimination list not allowed.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "nothingToDo"}], "=", 
   "\"\<Multivector doesn't have grades listed in elimination list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gaEliminateGrade", "::", "involutionPosition"}], "=", 
    "\"\<Involution position can be Right (default) or Left only. Default is \
used\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", 
    RowBox[{
     RowBox[{"SignChangeGrades", " ", "or", " ", "Output"}], "\[Rule]", 
     "Evaluation"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "gaEliminateGrade", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OutputType", "\[Rule]", "Evaluation"}], ",", " ", 
     RowBox[{"InvolutionPosition", "\[Rule]", "Right"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bs", "=", 
     RowBox[{
     "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaEliminateGrade", "[", 
     RowBox[{"expr_", ",", "eliminateGrade_List", ",", 
      RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", "s", ",", "prototype", ",", "relGrades", ",", 
        "checkValueRules", ",", "productWithPrototype", ",", 
        "theEquationsToCheck", ",", "trowCondition", ",", "baseElems", ",", 
        "subsRules", ",", "possibleSolutions", ",", "gradesForOutput", ",", 
        RowBox[{"grades", "=", 
         RowBox[{"gaGradeList", "[", "expr", "]"}]}], ",", 
        RowBox[{"outputType", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OutputType", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"gaEliminateGrade", ",", "OutputType"}], "]"}]}], ")"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"invPos", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"InvolutionPosition", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"gaEliminateGrade", ",", "InvolutionPosition"}], "]"}]}], 
          ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"exceptional", " ", "cases"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"eliminateGrade", ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"gaEliminateGrade", "::", "zero"}], "]"}], ";", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"grades", ",", "0"}], "]"}], ",", "eliminateGrade"}], 
            "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"gaEliminateGrade", "::", "nothingToDo"}], "]"}], ";", 
           "expr"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prototype", "=", 
            RowBox[{"Expand", "[", 
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gaGetMV", "[", 
                    RowBox[{"expr", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], ",", 
                    RowBox[{"p", "[", "#", "]"}]}], "}"}]}], ")"}], "/.", 
                   RowBox[{
                    RowBox[{"p", "[", "0", "]"}], "\[Rule]", "1"}]}], ")"}], 
                 "&"}], "/@", "grades"}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"invPos", ",", "Right", ",", 
             RowBox[{"productWithPrototype", "=", 
              RowBox[{"gaPE", "[", 
               RowBox[{"expr", "\[GeometricProduct]", "prototype"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "Left", ",", 
             RowBox[{"productWithPrototype", "=", 
              RowBox[{"gaPE", "[", 
               RowBox[{"prototype", "\[GeometricProduct]", "expr"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "_", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{"gaEliminateGrade", "::", "involutionPosition"}], 
               "]"}], ";", 
              RowBox[{"productWithPrototype", "=", 
               RowBox[{"gaPE", "[", 
                RowBox[{"expr", "\[GeometricProduct]", "prototype"}], 
                "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"baseElems", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"productWithPrototype", ",", "_bs", ",", "Infinity"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"subsRules", "=", 
            RowBox[{"Thread", "[", 
             RowBox[{"Rule", "[", 
              RowBox[{"baseElems", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Unique", "[", "s", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "baseElems", "]"}], "}"}]}], "]"}]}],
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"relGrades", "=", 
            RowBox[{"Rest", "[", "grades", "]"}]}], ";", 
           RowBox[{"checkValueRules", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "/@", "relGrades"}], ")"}], ",", "#"}], "]"}],
                 "]"}], "&"}], ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"Length", "[", "relGrades", "]"}]}], "]"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"theEquationsToCheck", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"gaGetMV", "[", 
                 RowBox[{"productWithPrototype", ",", 
                  RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
               "eliminateGrade"}], ")"}], "/.", "subsRules"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"trowCondition", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "theEquationsToCheck", "]"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"possibleSolutions", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Reap", "[", 
                RowBox[{"Scan", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"(", 
                    RowBox[{"theEquationsToCheck", "/.", "#"}], ")"}], "]"}], 
                    "===", "trowCondition"}], ",", 
                    RowBox[{"Sow", "[", "#", "]"}]}], "]"}], "&"}], ",", 
                  "checkValueRules"}], "]"}], "]"}], "]"}], ",", "1"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gradesForOutput", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "/@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"Rule", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "&"}], "/@",
                 "possibleSolutions"}], ")"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{"p", "->", "Identity"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"outputType", "===", "SignChangeGrades"}], ",", 
             "gradesForOutput", ",", "\[IndentingNewLine]", 
             RowBox[{"Switch", "[", 
              RowBox[{"invPos", ",", "Right", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"expr", "\[GeometricProduct]", 
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                "gradesForOutput"}], ",", "\[IndentingNewLine]", "Left", ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}], "\[GeometricProduct]", 
                   "expr"}], ")"}], "&"}], "/@", "gradesForOutput"}], ",", 
               "\[IndentingNewLine]", "_", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"expr", "\[GeometricProduct]", 
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                "gradesForOutput"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellLabel->
  "In[559]:=",ExpressionUUID->"269103f7-1b09-472e-9d30-30f51e79cf13"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Functions of single argument"
}], "Subsection",ExpressionUUID->"da217918-c99d-4ce2-ae95-92ce0cf52804"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Square root of multivector for n\[LessEqual]3"
}], "Subsubsection",ExpressionUUID->"4752c398-43a4-45e3-97b3-28112bde453f"],

Cell["\<\
Here we implement square root algorithm of general multivector for n\
\[LessEqual]3 case. \
\>", "Text",ExpressionUUID->"58de283e-5610-4dc9-8dc9-070c4976700d"],

Cell[CellGroupData[{

Cell["Method selection and help functions ", "Item",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"32c12529-7849-486e-89a9-69ba227b5a1b"],

Cell[TextData[{
 "Help functions used by ",
 StyleBox["gaSqrtOf[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"4ff226a4-2f04-46ef-8a78-ec99f393841e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"positiveQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"PossibleZeroQ", "[", "x", "]"}], ",", "False", ",", 
     RowBox[{"Positive", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonNegativeQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"PossibleZeroQ", "[", "x", "]"}], ",", "True", ",", 
     RowBox[{"Positive", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonzeroQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Not", "[", 
    RowBox[{"PossibleZeroQ", "[", "x", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zeroQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"PossibleZeroQ", "[", "x", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[570]:=",ExpressionUUID->"f1e67b12-9351-49ef-b1d2-67ecd077fab7"],

Cell["The older implementation", "Text",ExpressionUUID->"58ccba73-06f7-42b4-9dda-3ca5231ed05f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "gaSqrt", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Quiet", "\[Rule]", "False"}], ",", 
     RowBox[{"GeneratedParameters", "\[Rule]", "C"}], ",", 
     RowBox[{"Simplify", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "::", "Method"}], "=", "\"\<Unknown method `1`.\>\""}], 
  ";"}]}], "Input",
 CellLabel->
  "In[588]:=",ExpressionUUID->"71089eed-51f7-44d7-abed-8d0aaa3cf3fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aAlgebra", "=", 
        RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", 
       RowBox[{"aMethod", "=", 
        RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}]}], ",", 
       "theMethod", ",", "theAlgebra"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aAlgebra", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"theAlgebra", "=", "gaRunningAlgebra"}], ",", 
        RowBox[{"theAlgebra", "=", "aAlgebra"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aMethod", "===", "Automatic"}], ",", 
        RowBox[{"theMethod", "=", "theAlgebra"}], ",", 
        RowBox[{"theMethod", "=", "aMethod"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "2", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"3", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "2", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "3", ",", "0"}], "]"}]}], "}"}], ",", 
          "theMethod"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gaSqrt", "[", 
          RowBox[{"expr", ",", "theMethod", ",", "opts"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaSqrt", "::", "Method"}], ",", "theMethod"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[590]:=",ExpressionUUID->"9e5f6de5-b136-45eb-b35e-feb565f56d72"],

Cell["\<\
gaSqrtN is private (undocumented) function which was used to check results \
numerically. Inactivated\
\>", "Text",ExpressionUUID->"e8647c23-339e-4c90-817b-d00dd41117c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ps", "=", 
           RowBox[{"First", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"gaGetMV", "[", 
               RowBox[{
                RowBox[{"gaOrthonormalBasis", "[", "alg", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], 
                 "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], ",", "a1", ",", 
          "s", ",", "v1", ",", "v", ",", "V1", ",", "V", ",", "S", ",", 
          "coeffv1", ",", "coeffV1", ",", "bnames", ",", "genericMV", ",", 
          "takeMe", ",", "b", ",", "eqs", ",", "solEqs"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"V1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"V", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1", " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", "V1"}], ")"}], "\[GeometricProduct]", 
             "ps"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gaPE", "[", 
                 RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                "genericMV"}], ",", "_bs", ",", "takeMe"}], "]"}], ",", 
             "_takeMe", ",", "Infinity"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Equal", "[", 
             RowBox[{"x", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         RowBox[{"coeffV1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"V1", ",", "_V", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                "}"}], "]"}], ",", "Reals"}], "]"}], ",", "Reals", ",", "6", 
            ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "alg", ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"S", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "alg", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], ")"}], "/.", "solEqs"}], 
             "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "3"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"e5542a98-dda4-4ed2-a9da-0e70a77573c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "a1", ",", "v", ",", "v1", ",", "s", ",", "S", ",", "b", ",", "b1", 
          ",", "coeffv1", ",", "genericMV", ",", "bnames", ",", "eqs", ",", 
          "solEqs"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1", " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "alg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"gaGetMV", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"gaPE", "[", 
                    RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                   "b1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
                "_bs", ",", "takeMe"}], "]"}], ",", "_takeMe", ",", 
              "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Equal", "[", 
              RowBox[{"x", ",", "0"}], "]"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"solEqs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"NSolve", "[", 
              RowBox[{"eqs", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                 "}"}], "]"}], ",", "Reals", ",", 
               RowBox[{"VerifySolutions", "\[Rule]", "True"}]}], "]"}], 
             "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], ",", 
              "Reals"}], "]"}], ",", "Reals", ",", "6", ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gaPE", "[", 
                RowBox[{"s", "+", 
                 RowBox[{"gaGeneralMultivector", "[", 
                  RowBox[{"v", ",", "alg", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}], " ", "+", 
                 RowBox[{"S", "*", 
                  RowBox[{"gaI", "[", "alg", "]"}]}]}], "]"}], ")"}], "/.", 
              "solEqs"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "2"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"fdf686ac-d973-4a1a-96b9-eeeef646c5e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "a1", ",", "v", ",", "v1", ",", "s", ",", "b", ",", "b1", ",", 
          "coeffv1", ",", "genericMV", ",", "bnames", ",", "eqs", ",", 
          "solEqs"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1"}], " ", "]"}]}], ";", 
         RowBox[{"b1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{"gaGetMV", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"gaPE", "[", 
                   RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                  "b1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", "_bs", ",", 
               "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Equal", "[", 
             RowBox[{"x", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"solEqs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"NSolve", "[", 
              RowBox[{"eqs", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                 "}"}], "]"}], ",", "Reals", ",", 
               RowBox[{"VerifySolutions", "\[Rule]", "True"}]}], "]"}], 
             "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "coeffv1"}], "}"}], "]"}], ",", "Reals"}], 
             "]"}], ",", "Reals", ",", "6", ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gaPE", "[", 
                RowBox[{"s", "+", 
                 RowBox[{"gaGeneralMultivector", "[", 
                  RowBox[{"v", ",", "alg", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}]}], " ", "]"}], ")"}], "/.",
               "solEqs"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "1"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"320c1fd9-2c1f-4690-b7da-8b52eb4d68ef"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,0) case", "Item",ExpressionUUID->"e0bb99f1-b6b2-4fae-be26-6d65ff645b34"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"c1267408-fb42-4e01-9013-6cece29d0b1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "0"}], "]"}]}], ",", "v", ",", "s", ",", 
          "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "are", " ", "present", " ", "we",
           " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", "ordering"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}]}],
                  "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"GeometricAlgebra`p`printDetails", "[", 
          RowBox[{"quiet", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<The s is\>\"", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sSRules", "/.", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", "\"\<s\>\""}], "}"}]}], ")"}], ",", 
                RowBox[{"{", 
                 RowBox[{"___", ",", 
                  RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                 "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", "0"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"b", "[", "0", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"b", "[", "0", "]"}], "]"}]}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"nonNegativeQN", "[", 
                RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"Union", "[", "specAnswer00", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"583eed70-e129-4d3e-a372-817114be155d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,1) case", "Item",ExpressionUUID->"8ab08e55-bec0-44d6-b19f-ec3f874690e3"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"dedf9d7c-0afc-4807-a4c6-5d2a75546f9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], ",", "v", ",", "s", ",", 
          "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "are", " ", "present", " ", "we",
           " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", "ordering"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}]}],
                  "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s is\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", "0"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"-", 
              RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"-", 
                   RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"nonNegativeQN", "[", 
                RowBox[{"-", 
                 RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"-", 
              RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"Union", "[", "specAnswer00", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"1084e821-5e43-4ea5-b447-e8eea822ee14"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,0) case", "Item",ExpressionUUID->"5489a124-a492-4370-89c2-8bea07b23fcc"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"8efafede-b9af-46a8-ac6b-2da4f6b30f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"2", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"2", ",", "0"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"9bed5b40-59d5-4674-8cd1-450bd33201bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,1) case (the algebra is isomorphic to Cl(2,0)) ", "Item",ExpressionUUID->"328d4f1e-abf1-46c3-adff-d0b4b0b9d828"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"50df9421-1a9d-4138-8a81-2151507f9197"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"b", "[", "0", "]"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"7d839d58-17e2-469b-8a90-02c1b91dd383"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,2) case", "Item",ExpressionUUID->"797bfead-0439-49d6-891f-45f3f52db796"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"423b2b2f-8185-4dac-a5a7-4646dc8c9ac3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "2"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "2"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "determinant", " ", "norm", " ", "is", " ", "always", " ", 
           "positive", " ", "for", " ", "cl", 
           RowBox[{"(", 
            RowBox[{"0", ",", "2"}], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                 "}"}]}], "}"}], "/.", 
              RowBox[{"{", 
               RowBox[{"detSqrt", "->", 
                RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"d886fe9c-ba1f-4439-8c5c-39fdbdbb47c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(3,0) case", "Item",ExpressionUUID->"bfe6d47a-c8fe-4120-a368-9b9f9f8ad02f"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"41568810-f1c8-4284-8c4f-752393da4190"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"3", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"3", ",", "0"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "theTransformation", ",", "\[IndentingNewLine]", 
          "solTemplate", ",", "ps", ",", "bnames", ",", "bCCb0", ",", 
          "bCCbI0", ",", "detSqrt", ",", "genericMV", ",", "takeMe", ",", "b",
           ",", "stS", ",", "s2pS2", ",", "stSs2pS2", ",", "s", ",", "S", ",",
           "sSRulesT", ",", "sSRules", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "+", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=", 
                RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "+", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
                     "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "5", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "2", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "5", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}],
                     "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", " ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{"zeroQN", "[", 
           RowBox[{
            RowBox[{"4", "*", "bCCb0", "*", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], "+", 
            RowBox[{"bCCbI0", "^", "2"}], "-", 
            RowBox[{"4", "*", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "4"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S"}], " ", "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesPositive"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{"-", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesNegative"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "+", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "explicit", " ", "equations", " ", "and", " ", "their", " ", 
               "solutions"}], ",", " ", 
              RowBox[{"which", " ", "depend", " ", "on", " ", 
               RowBox[{"parameters", ".", " ", "Not"}], " ", "all", " ", 
               "parameters", " ", "have", " ", "numerical", " ", "values", 
               " ", "in", " ", 
               RowBox[{
                RowBox[{"R", " ", "!!"}], "!"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "1", "]"}], "*", 
                    RowBox[{"V", "[", "1", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"7f172efb-1641-453b-9665-\
359c59f30340"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,1) case", "Item",ExpressionUUID->"64049c0c-c575-4904-a093-abd750ee256f"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"5768c394-99d0-4319-8260-cb701d700939"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"2", ",", "1"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "theTransformation", ",", "solTemplate", ",", "ps", 
          ",", "bnames", ",", "\[IndentingNewLine]", "bCCb0", ",", "bCCbI0", 
          ",", "detSqrt", ",", "genericMV", ",", "takeMe", ",", "b", ",", 
          "stS", ",", "s2pS2", ",", "stSs2pS2", ",", "s", ",", "S", ",", 
          "sSRulesT", ",", "sSRules", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules", ",", 
          "freeParamRulesMissed"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "-", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"in", " ", "cl", 
           RowBox[{"(", "21", ")"}], " ", "determinant", " ", "can", " ", 
           "be", " ", 
           RowBox[{"negative", ".", " ", "Then"}], " ", "there", " ", "are", 
           " ", "no", " ", "solutions"}], " ", "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", 
            RowBox[{
             RowBox[{"bCCb0", "^", "2"}], "-", 
             RowBox[{"bCCbI0", "^", "2"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stSs2pS2", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"(*", " ", 
                  RowBox[{"s", "=", 
                   RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Generic", "  ", 
                RowBox[{"s", "^", "2"}]}], "-", 
               RowBox[{"S", "^", "2"}]}], "=!=", 
              RowBox[{
              "0", "  ", "solution", " ", "of", " ", "first", " ", "system", 
               " ", "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"sSRulesT", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "-", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], " ", "means", 
                    " ", 
                    RowBox[{"nonzeroQN", "[", "stS", "]"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "/.", 
                    "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
                "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"take", " ", "on", " ", 
                RowBox[{"s", "^", "2"}]}], "-", 
               RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"sSRules", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                   "sSRulesT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Show", " ", 
              RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"quiet", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"CellPrint", "[", 
                RowBox[{"{", 
                 RowBox[{"TextCell", "[", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                   "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"quiet", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"CellPrint", "[", 
                 RowBox[{"{", 
                  RowBox[{"TextCell", "[", 
                   RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                    "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                  "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplate", "=", 
             RowBox[{"gaPE", "[", 
              RowBox[{"s", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"v", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}], " ", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"S", "+", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRules", "=", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
                 "]"}], ",", "1"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"genericAnswer", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
               ")"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                   "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has no \
solution!\>\"", "]"}], "}"}], "]"}], " ", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"genericAnswer", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{
           RowBox[{"zeroQN", "[", 
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], "]"}], "||", 
           RowBox[{"zeroQN", "[", 
            RowBox[{
             RowBox[{"-", "bCCb0"}], "-", "bCCbI0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "+", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "-", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "+", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "+", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", " ", 
                   RowBox[{"(*", 
                    RowBox[{"s", "\[NotEqual]", 
                    RowBox[{
                    "0", " ", "is", " ", "ensured", " ", "by", " ", 
                    "positiveQ"}]}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sSRulesPositive", "]"}], "===", "List"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{"-", "S"}], " ", "-", "bCCb0", "-", "bCCbI0", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "+", 
               RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
           "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "+", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "-", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "-", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
                   "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sSRulesNegative", "]"}], "===", "List"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "-", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "-", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "1", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "2", "]"}], "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "3", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "1", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "2", "]"}], "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "3", "]"}], "2"]}], "\[Equal]", "0"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "1", "]"}], " ", 
                    RowBox[{"V", "[", "1", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "2", "]"}], " ", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "3", "]"}], " ", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"specAnswer00", "=", 
              RowBox[{"{", 
               RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], "}"}]}],
              ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"b69ef5de-a255-4916-8aa9-\
9108fcb606b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,2) case (the algebra is isomorphic to Cl(3,0) )", "Item",ExpressionUUID->"74f8001e-15e4-4704-8e61-b6f416fbfeb2"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"918cab6c-cc2c-46c0-9a11-e030ca2346e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "theTransformation", ",", 
          "ps", ",", "bnames", ",", "bCCb0", ",", "bCCbI0", ",", "detSqrt", 
          ",", "genericMV", ",", "takeMe", ",", "b", ",", "stS", ",", "s2pS2",
           ",", "stSs2pS2", ",", "s", ",", "S", ",", "sSRulesT", ",", 
          "sSRules", ",", "solTemplate", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "+", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=!=", "S"}], " ", "*)"}], "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "+", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
                     "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{"zeroQN", "[", 
           RowBox[{
            RowBox[{"bCCbI0", "^", "2"}], "+", 
            RowBox[{"4", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
             RowBox[{"(", 
              RowBox[{"bCCb0", "-", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"bCCbI0", "^", "2"}], "+", 
             RowBox[{"4", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
              RowBox[{"(", 
               RowBox[{"bCCb0", "-", 
                RowBox[{
                 RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
            "\[Equal]", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "2", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesPositive"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "S"}], " ", 
             RowBox[{"bCCbI0", "^", "2"}]}], "+", 
            RowBox[{"4", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
             RowBox[{"(", 
              RowBox[{"bCCb0", "-", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
           "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesNegative"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "+", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], "+", 
                    
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "7", "]"}], "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}], "]"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], 
                    ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], "+", 
                    
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "7", "]"}], "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}], "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"V", "[", "2", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], 
                    ")"}]}]}]}], "}"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "1", "]"}], " ", 
                    RowBox[{"V", "[", "1", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "2", "]"}], " ", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "3", "]"}], " ", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"specAnswer00", "=", 
              RowBox[{"{", 
               RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], "}"}]}],
              ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"d86a50c8-e258-460e-9c03-\
bd22c334874d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,3) case", "Item",ExpressionUUID->"3d0c09a2-0346-4269-b483-eccb54055148"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"18a5a6ff-048e-406a-8e29-8ee664ae3e42"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "3"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "3"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "ps", ",", 
          "theTransformation", ",", "solTemplate", ",", "bnames", ",", 
          "bCCb0", ",", "bCCbI0", ",", "detSqrt", ",", "genericMV", ",", 
          "takeMe", ",", "b", ",", "stS", ",", "s2pS2", ",", "stSs2pS2", ",", 
          "s", ",", "S", ",", "sSRulesT", ",", "sSRules", ",", 
          "genericAnswer", ",", "equalsSCase", ",", "sSRulesPositive", ",", 
          "sSRulesPositiveT", ",", "vVRulesPositive", ",", "sSRulesNegativeT",
           ",", "sSRulesNegative", ",", "vVRulesNegative", ",", "v", ",", "V",
           ",", "vVRules", ",", "solTemplateSpec1", ",", "solTemplateSpec2", 
          ",", "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", 
          ",", "specAnswer2", ",", "specAnswer00", ",", "freeParamRules", ",",
           "freeParamRulesMissed"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "-", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", "All", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=", 
                RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "-", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], " ", "means", 
                    " ", 
                    RowBox[{"nonzeroQN", "[", "stS", "]"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "/.", 
                    "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is \>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is \>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{
           RowBox[{"zeroQN", "[", 
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], "]"}], "||", 
           RowBox[{"zeroQN", "[", 
            RowBox[{
             RowBox[{"-", "bCCb0"}], "-", "bCCbI0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "+", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "+", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "-", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "+", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", " ", 
                   RowBox[{"(*", 
                    RowBox[{"s", "\[NotEqual]", 
                    RowBox[{
                    "0", " ", "is", " ", "ensured", " ", "by", " ", 
                    "positiveQ"}]}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
                   "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "1", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "5", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "1", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "5", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{"-", "S"}], " ", "-", "bCCb0", "-", "bCCbI0", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "+", 
               RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
           "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "-", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "+", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "-", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "-", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "-", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "-", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "-", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"specAnswer00", "=", 
               RowBox[{"{", 
                RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], 
                "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "1", "]"}], "*", 
                    RowBox[{"V", "[", "1", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{
            RowBox[{"S", "^", "2"}], " ", "and", " ", "replace", " ", 
            RowBox[{"v", "[", "i", "]"}], " ", "by", " ", 
            RowBox[{"C", "[", 
             RowBox[{"1", ",", "i"}], "]"}], " ", "and", " ", 
            RowBox[{"V", "[", "i", "]"}], " ", "by", " ", 
            RowBox[{"C", "[", 
             RowBox[{"2", ",", "i"}], "]"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"183d1da1-7cd0-447e-b98f-\
37402b018610"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[740]:=",ExpressionUUID->"f0cf4a30-fede-4afe-93bb-2ca3a1a402d8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Idempotents, left ideals, bilateral ideals, ideal basis"
}], "Section",ExpressionUUID->"e3a03971-e817-458b-81c9-e2dafb9dd869"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Tensor products and matrix representation of algebra"
}], "Section",ExpressionUUID->"336f3799-5846-4a02-a51d-b59298a2a91d"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Multivector inverse, reciprocal base, some bivector algebra formulas, \
blade and versor decomposition (not finished yet) [",
 StyleBox["gaDeterminantFormula, ExplicitFormula to replace by gaFormula. Too \
many similar names and duplications.",
  FontColor->RGBColor[1, 0, 0]],
 "]"
}], "Section",ExpressionUUID->"7e860192-8e40-40bc-a8a6-dd51050ec853"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Linear transformations"
}], "Section",ExpressionUUID->"39ed1d48-63a5-4efb-bcef-7b64dfe1d017"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Multivector derivatives (inactivated, not yet useful)"
}], "Section",ExpressionUUID->"dd66f057-db78-49d6-9fd9-189b65743a87"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Close Package"
}], "Section",ExpressionUUID->"9d64e97a-daf9-489a-b86e-8a6b45e34461"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Notes, drawbacks, future plans"
}], "Section",ExpressionUUID->"64646392-2c84-44bd-8289-d306a45113a6"]
},
CellGrouping->Manual,
WindowSize->{1416.75, 1516.5},
WindowMargins->{{20.25, Automatic}, {Automatic, 3}},
ShowSelection->True,
ShowCellTags->True,
TrackCellChangeTimes->False,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b2e34cb7-41f4-490f-838e-cf4fa00019f1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 98, "Title",ExpressionUUID->"9afea453-cc25-4c79-a71c-e5dfbdd1d324",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[768, 27, 190, 4, 36, "Text",ExpressionUUID->"4e44f443-be07-4aab-b2e3-346b3c4e2be1",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[973, 34, 408, 7, 60, "Text",ExpressionUUID->"b7096c71-859b-4301-9d48-460b7bed196f",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1384, 43, 165, 4, 68, "Section",ExpressionUUID->"d8cfecff-afda-4dd1-b50c-05b0a8572010"],
Cell[1552, 49, 138, 4, 54, "Section",ExpressionUUID->"246089b4-9667-4177-8ba9-b641a2c1b982"],
Cell[1693, 55, 131, 4, 54, "Section",ExpressionUUID->"2153a712-150f-4eab-9c82-4673c6899f50"],
Cell[1827, 61, 194, 5, 54, "Section",ExpressionUUID->"d373e055-74a0-4e3d-a30c-88ebbd8d41d2"],
Cell[2024, 68, 140, 4, 54, "Section",ExpressionUUID->"304188e1-9b37-431a-8354-d6f45e36f849"],
Cell[2167, 74, 175, 4, 54, "Section",ExpressionUUID->"5a369682-a6ac-4123-ba78-b7d12d19d351"],
Cell[2345, 80, 171, 4, 54, "Section",ExpressionUUID->"60614cca-24a6-49cb-92b4-25008c1bebb7"],
Cell[2519, 86, 229, 5, 25, "Input",ExpressionUUID->"6300459f-05d0-43dc-a673-2dcc3f54f916"],
Cell[2751, 93, 409, 9, 51, "Input",ExpressionUUID->"f12f28a6-7fcc-4d1c-8984-9448d950161d"],
Cell[3163, 104, 278, 4, 35, "Text",ExpressionUUID->"f2fd5974-1777-4119-8d78-63f518bd19a5"],
Cell[3444, 110, 1077, 21, 174, "Input",ExpressionUUID->"861ce4db-13c5-4c7e-94a6-7b3f35ef7cae"],
Cell[4524, 133, 300, 6, 29, "Input",ExpressionUUID->"e53eb3a5-3dbb-4160-b104-0fe712990f26"],
Cell[CellGroupData[{
Cell[4849, 143, 170, 7, 54, "Subsection",ExpressionUUID->"c5c60def-87c3-4330-baa1-b293dc3443c3"],
Cell[CellGroupData[{
Cell[5044, 154, 236, 10, 45, "Subsubsection",ExpressionUUID->"cbda8825-46d2-4dbc-bf15-a559fedee625"],
Cell[CellGroupData[{
Cell[5305, 168, 312, 9, 32, "Item",ExpressionUUID->"6d0cb4c2-0d15-4321-826a-9aff885a5b2b",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[5620, 179, 304, 7, 35, "Text",ExpressionUUID->"b13b6fce-2f0d-49d4-ad75-161c51c20775",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[5927, 188, 10562, 250, 773, "Input",ExpressionUUID->"269103f7-1b09-472e-9d30-30f51e79cf13",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16538, 444, 183, 7, 54, "Subsection",ExpressionUUID->"da217918-c99d-4ce2-ae95-92ce0cf52804"],
Cell[CellGroupData[{
Cell[16746, 455, 241, 10, 45, "Subsubsection",ExpressionUUID->"4752c398-43a4-45e3-97b3-28112bde453f"],
Cell[16990, 467, 169, 3, 35, "Text",ExpressionUUID->"58de283e-5610-4dc9-8dc9-070c4976700d"],
Cell[CellGroupData[{
Cell[17184, 474, 167, 3, 32, "Item",ExpressionUUID->"32c12529-7849-486e-89a9-69ba227b5a1b",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[17354, 479, 157, 4, 35, "Text",ExpressionUUID->"4ff226a4-2f04-46ef-8a78-ec99f393841e"],
Cell[17514, 485, 1064, 32, 92, "Input",ExpressionUUID->"f1e67b12-9351-49ef-b1d2-67ecd077fab7"],
Cell[18581, 519, 95, 0, 35, "Text",ExpressionUUID->"58ccba73-06f7-42b4-9dda-3ca5231ed05f"],
Cell[18679, 521, 573, 16, 51, "Input",ExpressionUUID->"71089eed-51f7-44d7-abed-8d0aaa3cf3fa"],
Cell[19255, 539, 2848, 72, 174, "Input",ExpressionUUID->"9e5f6de5-b136-45eb-b35e-feb565f56d72"],
Cell[22106, 613, 180, 3, 35, "Text",ExpressionUUID->"e8647c23-339e-4c90-817b-d00dd41117c6"],
Cell[22289, 618, 6176, 145, 401, "Input",ExpressionUUID->"e5542a98-dda4-4ed2-a9da-0e70a77573c1"],
Cell[28468, 765, 6315, 150, 401, "Input",ExpressionUUID->"fdf686ac-d973-4a1a-96b9-eeeef646c5e1"],
Cell[34786, 917, 5995, 142, 381, "Input",ExpressionUUID->"320c1fd9-2c1f-4690-b7da-8b52eb4d68ef"]
}, Closed]],
Cell[CellGroupData[{
Cell[40818, 1064, 83, 0, 28, "Item",ExpressionUUID->"e0bb99f1-b6b2-4fae-be26-6d65ff645b34"],
Cell[40904, 1066, 353, 6, 58, "Text",ExpressionUUID->"c1267408-fb42-4e01-9013-6cece29d0b1e"],
Cell[41260, 1074, 16583, 384, 1371, "Input",ExpressionUUID->"583eed70-e129-4d3e-a372-817114be155d"]
}, Closed]],
Cell[CellGroupData[{
Cell[57880, 1463, 83, 0, 28, "Item",ExpressionUUID->"8ab08e55-bec0-44d6-b19f-ec3f874690e3"],
Cell[57966, 1465, 353, 6, 58, "Text",ExpressionUUID->"dedf9d7c-0afc-4807-a4c6-5d2a75546f9c"],
Cell[58322, 1473, 17212, 399, 1412, "Input",ExpressionUUID->"1084e821-5e43-4ea5-b447-e8eea822ee14"]
}, Closed]],
Cell[CellGroupData[{
Cell[75571, 1877, 83, 0, 28, "Item",ExpressionUUID->"5489a124-a492-4370-89c2-8bea07b23fcc"],
Cell[75657, 1879, 353, 6, 58, "Text",ExpressionUUID->"8efafede-b9af-46a8-ac6b-2da4f6b30f01"],
Cell[76013, 1887, 22804, 523, 1515, "Input",ExpressionUUID->"9bed5b40-59d5-4674-8cd1-450bd33201bb"]
}, Closed]],
Cell[CellGroupData[{
Cell[98854, 2415, 123, 0, 28, "Item",ExpressionUUID->"328d4f1e-abf1-46c3-adff-d0b4b0b9d828"],
Cell[98980, 2417, 353, 6, 58, "Text",ExpressionUUID->"50df9421-1a9d-4138-8a81-2151507f9197"],
Cell[99336, 2425, 22732, 521, 1515, "Input",ExpressionUUID->"7d839d58-17e2-469b-8a90-02c1b91dd383"]
}, Closed]],
Cell[CellGroupData[{
Cell[122105, 2951, 83, 0, 28, "Item",ExpressionUUID->"797bfead-0439-49d6-891f-45f3f52db796"],
Cell[122191, 2953, 353, 6, 58, "Text",ExpressionUUID->"423b2b2f-8185-4dac-a5a7-4646dc8c9ac3"],
Cell[122547, 2961, 22733, 523, 1474, "Input",ExpressionUUID->"d886fe9c-ba1f-4439-8c5c-39fdbdbb47c3"]
}, Closed]],
Cell[CellGroupData[{
Cell[145317, 3489, 83, 0, 28, "Item",ExpressionUUID->"bfe6d47a-c8fe-4120-a368-9b9f9f8ad02f"],
Cell[145403, 3491, 353, 6, 58, "Text",ExpressionUUID->"41568810-f1c8-4284-8c4f-752393da4190"],
Cell[145759, 3499, 93710, 2096, 4568, "Input",ExpressionUUID->"7f172efb-1641-453b-9665-359c59f30340"]
}, Closed]],
Cell[CellGroupData[{
Cell[239506, 5600, 83, 0, 28, "Item",ExpressionUUID->"64049c0c-c575-4904-a093-abd750ee256f"],
Cell[239592, 5602, 353, 6, 58, "Text",ExpressionUUID->"5768c394-99d0-4319-8260-cb701d700939"],
Cell[239948, 5610, 113053, 2518, 5303, "Input",ExpressionUUID->"b69ef5de-a255-4916-8aa9-9108fcb606b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[353038, 8133, 123, 0, 28, "Item",ExpressionUUID->"74f8001e-15e4-4704-8e61-b6f416fbfeb2"],
Cell[353164, 8135, 353, 6, 58, "Text",ExpressionUUID->"918cab6c-cc2c-46c0-9a11-e030ca2346e5"],
Cell[353520, 8143, 90441, 2045, 4568, "Input",ExpressionUUID->"d86a50c8-e258-460e-9c03-bd22c334874d"]
}, Closed]],
Cell[CellGroupData[{
Cell[443998, 10193, 83, 0, 28, "Item",ExpressionUUID->"3d0c09a2-0346-4269-b483-eccb54055148"],
Cell[444084, 10195, 353, 6, 58, "Text",ExpressionUUID->"18a5a6ff-048e-406a-8e29-8ee664ae3e42"],
Cell[444440, 10203, 111444, 2502, 5008, "Input",ExpressionUUID->"183d1da1-7cd0-447e-b98f-37402b018610"]
}, Closed]],
Cell[555899, 12708, 159, 4, 25, "Input",ExpressionUUID->"f0cf4a30-fede-4afe-93bb-2ca3a1a402d8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[556097, 12717, 172, 4, 68, "Section",ExpressionUUID->"e3a03971-e817-458b-81c9-e2dafb9dd869"],
Cell[556272, 12723, 169, 4, 54, "Section",ExpressionUUID->"336f3799-5846-4a02-a51d-b59298a2a91d"],
Cell[556444, 12729, 398, 9, 132, "Section",ExpressionUUID->"7e860192-8e40-40bc-a8a6-dd51050ec853"],
Cell[556845, 12740, 139, 4, 54, "Section",ExpressionUUID->"39ed1d48-63a5-4efb-bcef-7b64dfe1d017"],
Cell[556987, 12746, 170, 4, 54, "Section",ExpressionUUID->"dd66f057-db78-49d6-9fd9-189b65743a87"],
Cell[557160, 12752, 130, 4, 54, "Section",ExpressionUUID->"9d64e97a-daf9-489a-b86e-8a6b45e34461"],
Cell[557293, 12758, 147, 4, 54, "Section",ExpressionUUID->"64646392-2c84-44bd-8289-d306a45113a6"]
}
]
*)

