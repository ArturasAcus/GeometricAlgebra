(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    792925,      18595]
NotebookOptionsPosition[    775033,      18331]
NotebookOutlinePosition[    775543,      18351]
CellTagsIndexPosition[    775500,      18348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Obsolete functions  from Geometric Algebra & Calculus", "Title",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"9afea453-cc25-4c79-a71c-e5dfbdd1d324"],

Cell[TextData[StyleBox["Last edit (2024-05-03). ",
 FontSize->16]], "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"4e44f443-be07-4aab-b2e3-346b3c4e2be1"]
}, Open  ]],

Cell[TextData[StyleBox["Here is placed rarely used functions and functions \
which was reimplemented in a better way.  If your still need them, run them  \
from this notebook (from a global context). The original position of the  \
obsolete functions was not changed",
 FontSize->16]], "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"b7096c71-859b-4301-9d48-460b7bed196f"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".Copyright,  License, credit, references and notes"
}], "Section",ExpressionUUID->"d8cfecff-afda-4dd1-b50c-05b0a8572010"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Setup & configuration"
}], "Section",ExpressionUUID->"246089b4-9667-4177-8ba9-b641a2c1b982"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Initialization"
}], "Section",ExpressionUUID->"2153a712-150f-4eab-9c82-4673c6899f50"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Objects: orthonormal base notation, definition and internal \
representations"
}], "Section",ExpressionUUID->"d373e055-74a0-4e3d-a30c-88ebbd8d41d2"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ". Products and expansions"
}], "Section",ExpressionUUID->"304188e1-9b37-431a-8354-d6f45e36f849"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TheContextSymbolList", "=", 
   RowBox[{"{", 
    RowBox[{
    "gaCompactPlainRepresentation", ",", 
     "gaCompactAssociationRepresentation"}], "}"}]}], ";"}]], "Input",Expressi\
onUUID->"759e0625-efc6-47e0-a17d-83900192f928"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeclareIntoContext", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"Unprotect", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"ClearAll", "@@", "TheContextSymbolList"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "TheContextSymbolList", "]"}], ";"}]}], "Input",
 CellLabel->
  "In[198]:=",ExpressionUUID->"8e2eb4bf-ce36-4b31-8744-b7b7904786a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaCompactPlainRepresentation", "::", "usage"}], "=", 
   "\"\<gaCompactPlainRepresentation[expr, opt:gaNonCommutativeMonomialOrder\
\[Rule]\\\"InvDeg[Lex]\\\"] rewrites expr using compact index representation. \
In particular it replaces mvDownUp[{do__Integer},{}]:> mvDownUp[integer,0], \
where integer enumerates basis element in the gaNonCommutativeMonomialOrder \
ordered orthonormal basis.\>\""}], ";"}]], "Input",
 CellLabel->
  "In[239]:=",ExpressionUUID->"0e023f4d-15c7-4116-8afa-39d964b58fcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaCompactAssociationRepresentation", "::", "usage"}], "=", 
   "\"\<gaCompactAssociationRepresentation[expr, \
opt:gaNonCommutativeMonomialOrder\[Rule]\\\"InvDeg[Lex]\\\"] rewrites expr \
using compact index representation inside Association representations. In \
particular it replaces keys mvDownUp[{do__Integer},{}]:> mvDownUp[integer,0], \
where integer enumerates basis element in the gaNonCommutativeMonomialOrder \
ordered orthonormal basis.\>\""}], ";"}]], "Input",
 CellLabel->
  "In[240]:=",ExpressionUUID->"cc7660da-f93a-4b11-98b7-294a8745ff3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[864]:=",ExpressionUUID->"a314b866-2667-4c1d-902a-1cc2dba298d9"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Implementation of non-commutativity and noncommutative element detection"
}], "Subsection",ExpressionUUID->"d137b774-f937-486d-9bd7-5fd33bc8d35b"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Grade, index extraction from general expressions"
}], "Subsection",ExpressionUUID->"b70f1179-3daf-403e-8708-0fc594dd4ca7"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Taking parts of multivector "
}], "Subsection",ExpressionUUID->"c8de79d9-8ee5-4657-a5be-2750efa5f7b1"],

Cell[TextData[{
 " ",
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". gaGetMV",
 "[ ]",
 " extract from expression part of specified grade"
}], "Subsubsection",ExpressionUUID->"4b03d21d-cc75-4eec-9c44-6ddfcdace8d9"],

Cell[CellGroupData[{

Cell[TextData[{
 " ",
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". gaComponentList[ ] splits expanded expression into list of components \
2024-05-03"
}], "Subsubsection",ExpressionUUID->"0e1415c1-0323-4301-9eb5-f8dc9ce1a1d0"],

Cell["\<\
Getting components in compact representation: we construct the base manually \
in a simple way\
\>", "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10001.},ExpressionUUID->"c8c3e373-71e7-4b43-b30e-0ac149b1bde3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaComponentCoefficientAndBasisList", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"op", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theOption", ",", 
          RowBox[{"theAlgebra", "=", 
           RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", "coeffs", ",", 
          "indices", ",", "theBasis", ",", "restBasisParameters"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"option", " ", "handling"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gaSetNamedOptionValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "gaComponentCoefficientAndBasisList", ",", "#", ",", 
               "theOption"}], "}"}], ",", 
             RowBox[{
              RowBox[{
              "gaOptionCheck", "[", 
               "testOptionComponentCoefficientAndBasisList", "]"}], "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OptionValue", "[", "#", "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s_Symbol", ",", "y___Rule"}], "}"}], ":>", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ToString", "[", "s", "]"}], ",", "y"}], "}"}]}], 
                 "}"}]}], ")"}], "]"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"First", "/@", 
            RowBox[{"{", "op", "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "set", " ", "method", " ", "value", " ", "if", " ", "it", " ", 
           "was", " ", "not", " ", "set"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], "]"}], "===", 
            "theOption"}], ",", 
           RowBox[{
            RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], "=", 
            RowBox[{"(", 
             RowBox[{"Quiet", "/.", 
              RowBox[{
              "Options", "[", "gaComponentCoefficientAndBasisList", "]"}]}], 
             ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{
             "theOption", "[", "\"\<gaNonCommutativeMonomialOrder\>\"", "]"}],
              "]"}], "===", "theOption"}], ",", 
           RowBox[{
            RowBox[{
            "theOption", "[", "\"\<gaNonCommutativeMonomialOrder\>\"", "]"}], 
            "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gaNonCommutativeMonomialOrder", "/.", 
                RowBox[{
                "Options", "[", "gaComponentCoefficientAndBasisList", "]"}]}],
                ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "gaNonCommutativeMonomialOrder", "->", "gaRunningOrdering"}], 
               "}"}]}], ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"theOption", "[", "\"\<CoefficientFunction\>\"", "]"}], 
             "]"}], "===", "theOption"}], ",", 
           RowBox[{
            RowBox[{"theOption", "[", "\"\<CoefficientFunction\>\"", "]"}], 
            "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CoefficientFunction", "/.", 
                RowBox[{
                "Options", "[", "gaComponentCoefficientAndBasisList", "]"}]}],
                ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"CoefficientFunction", "->", "Expand"}], "}"}]}], 
             ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "theOption", "[", "\"\<gaNonCommutativeMonomialOrder\>\"", "]"}], 
            "=!=", "gaRunningOrdering"}], ",", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{
              "gaComponentCoefficientAndBasisList", "::", "compactbasis"}], 
              ",", "gaRunningOrdering", ",", 
              RowBox[{
              "theOption", "[", "\"\<gaNonCommutativeMonomialOrder\>\"", 
               "]"}]}], "]"}], ";", " ", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"restBasisParameters", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"FirstCase", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlgebra", ",", "gaRunningOrdering"}], "]"}], ",", 
               "_bs"}], "]"}], ",", "2"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"construct", " ", "the", " ", "compact", " ", "basis"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"indices", "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"2", "^", 
             RowBox[{"gaDimensionOfVectorSpace", "[", "theAlgebra", "]"}]}], 
            "-", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", 
             RowBox[{"mvDownUp", "[", 
              RowBox[{"0", ",", 
               RowBox[{"_Integer", "?", "Positive"}]}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"theBasis", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"bs", "[", 
               RowBox[{
                RowBox[{"mvDownUp", "[", 
                 RowBox[{"#", ",", "0"}], "]"}], ",", "theAlgebra", ",", 
                "restBasisParameters"}], "]"}], "&"}], "/@", "indices"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"theBasis", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"bs", "[", 
               RowBox[{
                RowBox[{"mvDownUp", "[", 
                 RowBox[{"0", ",", "#"}], "]"}], ",", "theAlgebra", ",", 
                "restBasisParameters"}], "]"}], "&"}], "/@", "indices"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"coeffs", "=", 
          RowBox[{"CoefficientArrays", "[", 
           RowBox[{"expr", ",", "theBasis"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "coeffs", "]"}], "===", "1"}], ",", 
           RowBox[{"coeffs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"coeffs", ",", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "theBasis", "]"}], "}"}]}], "]"}]}], 
              "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"theOption", "[", "\"\<CoefficientFunction\>\"", "]"}], "/@", 
            RowBox[{"Flatten", "[", "coeffs", "]"}]}], ")"}], "*", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "theBasis"}], "}"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"{", "expr", "}"}], ",", 
          RowBox[{
          "GeometricProduct", "|", "OuterProduct", "|", "InnerProduct", "|", 
           "LeftContract", "|", "RightContract", "|", "MV"}], ",", 
          RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}], "&&", 
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"{", "expr", "}"}], ",", 
          RowBox[{"mvDownUp", "[", 
           RowBox[{"_List", ",", "_List"}], "]"}]}], "]"}], "&&", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"expr", ",", "\"\<Quaternion\>\""}], "]"}], "&&", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"bs", "[", 
           RowBox[{"_Association", ",", "__"}], "]"}]}], "]"}]}], ")"}]}]}]}],
    "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUUID->"fe8e12e2-\
fee0-4c9b-9f8d-576c546c53e5"]
}, Closed]]
}, Open  ]],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Products notations and precedence implementation (based on modification \
of UnicodeSymbols.tr file)"
}], "Subsection",ExpressionUUID->"12d768d1-d4e8-443c-8193-af0e56387e6c"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". GeometricProduct,",
 " OuterProduct,  LeftContract and RightContract book keeping (general \
multivectors, no ordering rules)"
}], "Subsection",ExpressionUUID->"920d1dfa-501f-4fac-b444-8221440fbcd1"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". GeometricMatrixProduct, OuterMatrixProduct,InnerMatrixProduct "
}], "Subsection",ExpressionUUID->"d07d0b62-f9e0-4091-9ba6-6b96ff62be73"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Implementation and book keeping for geometric, outer products in \
orthonormal base."
}], "Subsection",ExpressionUUID->"1b7250b8-7e24-4849-893b-d6e34db43544"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Tools to analyse compilation to C problems (unevaluatable by default, \
useful in the case of compilation problems)"
}], "Subsubsection",ExpressionUUID->"22e83c37-cece-45bf-bd1e-5941ab704605"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Subset counting functions"
}], "Subsubsection",ExpressionUUID->"4d6f273a-a6c9-496c-873e-f10f708dfd88"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Various products signature maps, see ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Staples", " ", "package", " ", "implementation"}], 
   TraditionalForm]],ExpressionUUID->"3c9c4034-4e08-4232-9a29-11c932fbd765"]
}], "Subsubsection",ExpressionUUID->"ac214813-a822-4fd8-a149-b299831fe75e"],

Cell["\<\
If compact representation is used we recompute the mappings using plain \
Additive representation commands above\
\>", "Text",ExpressionUUID->"c4568d30-c21f-4b9f-b6aa-cc0a49d0cb45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i1_Integer", ",", "0"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i2_Integer", ",", "0"}], "]"}], ",", "GeometricProduct", ",", 
     "alg_Cl"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"alg", ",", "gaRunningOrdering"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"alg", ",", "gaRunningOrdering"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "GeometricProduct", ",", "alg"}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[351]:=",ExpressionUUID->"06dc5628-111e-4101-beea-b872d1160f1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i1_Integer"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i2_Integer"}], "]"}], ",", "GeometricProduct", ",", 
     "alg_Cl"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"alg", ",", "gaRunningOrdering"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"alg", ",", "gaRunningOrdering"}], "]"}]}], "]"}]}], "]"}], 
     ",", "GeometricProduct", ",", "alg"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[352]:=",ExpressionUUID->"0325b2ad-41d0-4a9e-ab18-2ddde716dc81"],

Cell["\<\
If compact representation is used we recompute the mappings using plain \
Additive representation commands above\
\>", "Text",ExpressionUUID->"bb635bfe-d382-4941-8012-b3395590a9cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i1_Integer", ",", "0"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i2_Integer", ",", "0"}], "]"}], ",", "OuterProduct", ",", 
     "___"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"gaRunningAlgebra", ",", "gaRunningOrdering"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"gaRunningAlgebra", ",", "gaRunningOrdering"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "OuterProduct"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[357]:=",ExpressionUUID->"8784d2a7-f062-422f-8810-d68d587f3ca1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i1_Integer"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i2_Integer"}], "]"}], ",", "OuterProduct", ",", 
     "___"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"gaRunningAlgebra", ",", "gaRunningOrdering"}], "]"}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"gaRunningAlgebra", ",", "gaRunningOrdering"}], "]"}]}], 
        "]"}]}], "]"}], ",", "OuterProduct"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[358]:=",ExpressionUUID->"5c35e9e1-2974-4e22-b01f-83077ce9558a"],

Cell["\<\
If compact representation is used we recompute the mappings using plain \
Additive representation commands above\
\>", "Text",ExpressionUUID->"c107d3a7-65aa-48be-8ff8-a5894333eaaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i1_Integer", ",", "0"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"i2_Integer", ",", "0"}], "]"}], ",", 
     RowBox[{"h", ":", 
      RowBox[{"(", 
       RowBox[{"LeftContract", "|", "RightContract", "|", "InnerProduct"}], 
       ")"}]}], ",", "al_Cl"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"al", ",", "gaRunningOrdering"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"al", ",", "gaRunningOrdering"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "h", ",", "al"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[362]:=",ExpressionUUID->"3322879b-e4a9-41a1-88dc-55a832950a43"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i1_Integer"}], "]"}], ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{"0", ",", "i2_Integer"}], "]"}], ",", 
     RowBox[{"h", ":", 
      RowBox[{"(", 
       RowBox[{"LeftContract", "|", "RightContract", "|", "InnerProduct"}], 
       ")"}]}], ",", "al_Cl"}], "]"}], ":=", 
   RowBox[{"productSignatureMap", "[", 
    RowBox[{
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"al", ",", "gaRunningOrdering"}], "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"i2", ",", 
         RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
          RowBox[{"al", ",", "gaRunningOrdering"}], "]"}]}], "]"}]}], "]"}], 
     ",", "h", ",", "al"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[363]:=",ExpressionUUID->"7c60e1fb-9cd9-4a98-8744-f9473ebb8a57"]
}, Closed]]
}, Open  ]],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Expansions and conversions between different products"
}], "Subsection",ExpressionUUID->"c46d245b-c23d-4ec1-aad7-f53835f354c8"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Multivector (orthonormal basis) representation  in ",
 StyleBox["Mathematica\[CloseCurlyQuote]",
  FontSlant->"Italic"],
 "s Association form "
}], "Subsubsection",ExpressionUUID->"3f0c3fd6-20cd-49e0-9bbf-df925a6b51fd"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". gaProductPairExpand[ ]  in internal \
\[OpenCurlyDoubleQuote]AssociationRepresentation\[CloseCurlyDoubleQuote] \
form"
}], "Subsubsection",ExpressionUUID->"6287ce71-e6ac-4b87-9bf8-5cc394b1d4a1"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". gaProductPairExpand[ ] expansions for MV given in standard \
\[OpenCurlyDoubleQuote]PlainRepresentation\[CloseCurlyDoubleQuote] form"
}], "Subsubsection",ExpressionUUID->"71b27afb-2132-467a-b122-c5d508bcba95"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". gaProductExpand[ ] main part"
}], "Subsubsection",ExpressionUUID->"692defce-ca50-4322-a5d8-61e0683ee7a4"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Simple powers"
}], "Subsubsection",ExpressionUUID->"10fa0e49-d336-44ab-aa83-9fea6a380c3b"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". General multivector construction, random multivector with integer \
coefficients"
}], "Subsubsection",ExpressionUUID->"2daf5d7e-dc63-4934-a109-d4fcf4da5e6d"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Multivector (orthonormal basis) representation  in Compact/nonCompact \
form "
}], "Subsubsection",ExpressionUUID->"17ae3335-b69b-4bb5-b4f1-e5d1687609de"],

Cell["\<\
Conversion is based on the below constructed rules. The compact form is \
almost untested. In fact  it is not used.\
\>", "Text",ExpressionUUID->"a947def1-2ad1-4bc4-b3a3-7fa50f24d621"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compactRepresentationReplacementRules", "[", 
   RowBox[{"algebra_Cl", ",", "ordering_String"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"compactRepresentationReplacementRules", "[", 
     RowBox[{"algebra", ",", "ordering"}], "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MapAt", "[", 
          RowBox[{"First", ",", "#", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"First", "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"gaOrthonormalBasis", "[", 
               RowBox[{"algebra", ",", "ordering"}], "]"}], ",", "1"}], 
             "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", "}"}], "\[Rule]", "0"}]}], "}"}], "]"}]}], 
   ")"}]}]], "Input",
 CellLabel->
  "In[389]:=",ExpressionUUID->"14097973-5ad2-4ea7-b26c-c7da8aec6148"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
   RowBox[{"algebra_Cl", ",", "ordering_String"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"reverseCompactRepresentationReplacementRules", "[", 
     RowBox[{"algebra", ",", "ordering"}], "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Reverse", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MapAt", "[", 
            RowBox[{"First", ",", "#", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"First", "/@", 
             RowBox[{"First", "/@", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"gaOrthonormalBasis", "[", 
                 RowBox[{"algebra", ",", "ordering"}], "]"}], ",", "1"}], 
               "]"}]}]}]}], "]"}]}], ")"}]}], ",", 
       RowBox[{"0", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ")"}]}]], "Input",
 CellLabel->
  "In[390]:=",ExpressionUUID->"e3268b0f-229b-4de3-9621-2c0ccb1b2016"],

Cell["\<\
Convert into compact representation:  mvDownUp[{do__Integer},{}]:> \
mvDownUp[integer,0] and mvDownUp[{},{do__Integer}]:> mvDownUp[0,integer]\
\>", "Text",ExpressionUUID->"1c127f23-d111-42ea-bb5e-6415f7355ac2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaCompactPlainRepresentation", "::", "BasisOrOrdering"}], "=", 
   "\"\<Orthonormal basis of `1` with the required ordering `2` is not \
defined. \>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gaCompactPlainRepresentation", "::", "downup"}], "=", 
   "\"\<Expression `1` contains both down and up indices. Compact \
representation not implemented.\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[391]:=",ExpressionUUID->"cd3339ae-76e7-4b9d-931b-aee3b237170c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaCompactPlainRepresentation", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theAlgebra", "=", 
        RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", 
       RowBox[{"theOrdering", "=", "gaRunningOrdering"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"gaOrthonormalBasis", "[", 
          RowBox[{"theAlgebra", ",", "theOrdering"}], "]"}], "]"}], "=!=", 
        "gaOrthonormalBasis"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Replace", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mvDownUp", "[", 
             RowBox[{
              RowBox[{"{", "do__Integer", "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"mvDownUp", "[", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"{", "do", "}"}], ",", 
                RowBox[{"compactRepresentationReplacementRules", "[", 
                 RowBox[{"theAlgebra", ",", "theOrdering"}], "]"}]}], "]"}], 
              ",", "0"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"mvDownUp", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "up__Integer", "}"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"mvDownUp", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"{", "up", "}"}], ",", 
                RowBox[{"compactRepresentationReplacementRules", "[", 
                 RowBox[{"theAlgebra", ",", "theOrdering"}], "]"}]}], "]"}]}],
              "]"}]}]}], "}"}], ",", "All"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"gaCompactPlainRepresentation", "::", "BasisOrOrdering"}], 
         ",", "theAlgebra", ",", "theOrdering"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"mvDownUp", "[", 
      RowBox[{
       RowBox[{"{", "do__", "}"}], ",", 
       RowBox[{"{", "up__", "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellLabel->
  "In[393]:=",ExpressionUUID->"19ce5d1d-44e8-45d2-9510-94b7333574ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaCompactPlainRepresentation", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"gaCompactPlainRepresentation", "::", "downup"}], ",", 
       "expr"}], "]"}], ";", "expr"}], ")"}], "/;", 
   RowBox[{"!", 
    RowBox[{"FreeQ", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"mvDownUp", "[", 
       RowBox[{
        RowBox[{"{", "do__", "}"}], ",", 
        RowBox[{"{", "up__", "}"}]}], "]"}]}], "]"}]}]}]}]], "Input",
 CellLabel->
  "In[394]:=",ExpressionUUID->"efdcc58f-59cd-47b1-9df9-3cc10e5eade8"],

Cell["\<\
Inside Association we have to use KeyMap. Possible problem: mvDownUp[{},{}] \
is not replaced by mvDownUp[ 0,0] when using gaAssociationRepresentation[ ]: \
may be separateCommands for gaCompactAssciationRepresentation and its inverse \
is needed?\
\>", "Text",ExpressionUUID->"db2bd680-bda6-472e-acc0-a77a1d86df47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaCompactAssociationRepresentation", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], ",", 
       RowBox[{"theAlgebra", "=", 
        RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", 
       RowBox[{"theOrdering", "=", "gaRunningOrdering"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"gaOrthonormalBasis", "[", 
          RowBox[{"theAlgebra", ",", "theOrdering"}], "]"}], "]"}], "=!=", 
        "gaOrthonormalBasis"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"gaAssociationRepresentation", "[", "expr", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bs", "[", 
            RowBox[{"data_Association", ",", "algebra_Cl"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"algebra", ",", "theOrdering"}], "]"}], "]"}], "=!=", 
              "gaOrthonormalBasis"}], ",", "\[IndentingNewLine]", 
             RowBox[{"bs", "[", 
              RowBox[{
               RowBox[{"KeyMap", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ReplaceAll", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"compactRepresentationReplacementRules", "[", 
                    RowBox[{"algebra", ",", "theOrdering"}], "]"}]}], "]"}], 
                  "&"}], ",", "data"}], "]"}], ",", "algebra"}], "]"}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{
               "gaCompactPlainRepresentation", "::", "BasisOrOrdering"}], ",",
                "algebra", ",", "theOrdering"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "}"}], ",", "All"}], "]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"gaCompactPlainRepresentation", "::", "BasisOrOrdering"}], 
         ",", "theAlgebra", ",", "theOrdering"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"mvDownUp", "[", 
        RowBox[{
         RowBox[{"{", "do__", "}"}], ",", 
         RowBox[{"{", "up__", "}"}]}], "]"}]}], "]"}], "&&", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"expr", ",", "_Association"}], "]"}]}], ")"}]}]}]], "Input",
 CellLabel->
  "In[395]:=",ExpressionUUID->"3ff442c9-bf3a-4d9c-b9cc-d184f5cacc3a"]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[835]:=",ExpressionUUID->"22d496fd-d256-453b-b3a2-888781a9b824"]
}, Open  ]],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Groebner Basis (only sorting is implemented at the moment)"
}], "Section",ExpressionUUID->"5a369682-a6ac-4123-ba78-b7d12d19d351"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ". Involutions and mathematical functions of multivectors"
}], "Section",ExpressionUUID->"60614cca-24a6-49cb-92b4-25008c1bebb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TheContextSymbolList", "=", 
   RowBox[{"{", 
    RowBox[{"gaSqrt", ",", "gaSqrtN", ",", "gaEliminateGrade"}], "}"}]}], 
  ";"}]], "Input",ExpressionUUID->"6300459f-05d0-43dc-a673-2dcc3f54f916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeclareIntoContext", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"Unprotect", "@@", "TheContextSymbolList"}], ";", 
  RowBox[{"ClearAll", "@@", "TheContextSymbolList"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "TheContextSymbolList", "]"}], ";"}]}], "Input",
 CellLabel->
  "In[489]:=",ExpressionUUID->"f12f28a6-7fcc-4d1c-8984-9448d950161d"],

Cell["\<\
gaSqrt[ ] is now obsolete. The gaEliminateGrade[ ] was removed (it was \
devoted to specific purpose). Run these functions after loading GA package! \
Functions will be created in the global context!\
\>", "Text",ExpressionUUID->"f2fd5974-1777-4119-8d78-63f518bd19a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "usage"}], "=", 
   "\"\<gaEliminateGrade[multivector_,eliminateGrade_List,opts___?OptionQ] is \
a command, which multiplies the given general multivector by the same \
multivector acted by involution from the right in attempt to remove from the \
product grades listed in eliminateGrade list. Empty output means that given \
grades cannot be eliminated by mentioned procedure.\>\""}], ";", 
  RowBox[{
   RowBox[{"OutputType", "::", "usage"}], "=", 
   "\"\<OutputType is an option for gaEliminateGrade[], which change output \
presentation. Possible values are SignChangeGrades and Evaluation \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvolutionPosition", "::", "usage"}], "=", 
   "\"\<InvolutionPosition is an option for gaEliminateGrade[], which decides \
from which side invuluted multivector is multiplied. Possible values are \
Right (default) and Left.\>\""}], ";"}]}], "Input",
 CellLabel->
  "In[506]:=",ExpressionUUID->"861ce4db-13c5-4c7e-94a6-7b3f35ef7cae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "::", "usage"}], "=", 
   "\"\<Old implementation. Yields square root of general multivector in \
radicals. Works for vector space dimension n\[LessEqual]3 only.\>\""}], 
  ";"}]], "Input",ExpressionUUID->"e53eb3a5-3dbb-4160-b104-0fe712990f26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[864]:=",ExpressionUUID->"214722ac-de12-43d8-a51c-e6671ef3ae80"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Unary operators"
}], "Subsection",ExpressionUUID->"c5c60def-87c3-4330-baa1-b293dc3443c3"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Involutions, conjugations and Hodge dual"
}], "Subsubsection",ExpressionUUID->"cbda8825-46d2-4dbc-bf15-a559fedee625"],

Cell[CellGroupData[{

Cell[TextData[{
 "Specialized command ",
 StyleBox["gaEliminateGrade[ ]",
  FontWeight->"Bold"],
 ", which try to eliminate grades in the geometric product using grade \
negations only"
}], "Item",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10002.},ExpressionUUID->"6d0cb4c2-0d15-4321-826a-9aff885a5b2b"],

Cell["\<\
gaEliminateGrade takes multivector and by multiplying on the same multivector \
on the right, acted by gaGradeNegate tries to remove listed grades in the \
product. \
\>", "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10002.},ExpressionUUID->"b13b6fce-2f0d-49d4-ad75-161c51c20775"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "zero"}], "=", 
   "\"\<Zero grade in elimination list not allowed.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaEliminateGrade", "::", "nothingToDo"}], "=", 
   "\"\<Multivector doesn't have grades listed in elimination list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gaEliminateGrade", "::", "involutionPosition"}], "=", 
    "\"\<Involution position can be Right (default) or Left only. Default is \
used\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", 
    RowBox[{
     RowBox[{"SignChangeGrades", " ", "or", " ", "Output"}], "\[Rule]", 
     "Evaluation"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "gaEliminateGrade", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OutputType", "\[Rule]", "Evaluation"}], ",", " ", 
     RowBox[{"InvolutionPosition", "\[Rule]", "Right"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bs", "=", 
     RowBox[{
     "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaEliminateGrade", "[", 
     RowBox[{"expr_", ",", "eliminateGrade_List", ",", 
      RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", "s", ",", "prototype", ",", "relGrades", ",", 
        "checkValueRules", ",", "productWithPrototype", ",", 
        "theEquationsToCheck", ",", "trowCondition", ",", "baseElems", ",", 
        "subsRules", ",", "possibleSolutions", ",", "gradesForOutput", ",", 
        RowBox[{"grades", "=", 
         RowBox[{"gaGradeList", "[", "expr", "]"}]}], ",", 
        RowBox[{"outputType", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OutputType", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"gaEliminateGrade", ",", "OutputType"}], "]"}]}], ")"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"invPos", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"InvolutionPosition", "/.", 
            RowBox[{"{", "opts", "}"}]}], "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"gaEliminateGrade", ",", "InvolutionPosition"}], "]"}]}], 
          ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"exceptional", " ", "cases"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"eliminateGrade", ",", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"gaEliminateGrade", "::", "zero"}], "]"}], ";", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"grades", ",", "0"}], "]"}], ",", "eliminateGrade"}], 
            "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"gaEliminateGrade", "::", "nothingToDo"}], "]"}], ";", 
           "expr"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prototype", "=", 
            RowBox[{"Expand", "[", 
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"gaGetMV", "[", 
                    RowBox[{"expr", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], ",", 
                    RowBox[{"p", "[", "#", "]"}]}], "}"}]}], ")"}], "/.", 
                   RowBox[{
                    RowBox[{"p", "[", "0", "]"}], "\[Rule]", "1"}]}], ")"}], 
                 "&"}], "/@", "grades"}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"invPos", ",", "Right", ",", 
             RowBox[{"productWithPrototype", "=", 
              RowBox[{"gaPE", "[", 
               RowBox[{"expr", "\[GeometricProduct]", "prototype"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "Left", ",", 
             RowBox[{"productWithPrototype", "=", 
              RowBox[{"gaPE", "[", 
               RowBox[{"prototype", "\[GeometricProduct]", "expr"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "_", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{"gaEliminateGrade", "::", "involutionPosition"}], 
               "]"}], ";", 
              RowBox[{"productWithPrototype", "=", 
               RowBox[{"gaPE", "[", 
                RowBox[{"expr", "\[GeometricProduct]", "prototype"}], 
                "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"baseElems", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"productWithPrototype", ",", "_bs", ",", "Infinity"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"subsRules", "=", 
            RowBox[{"Thread", "[", 
             RowBox[{"Rule", "[", 
              RowBox[{"baseElems", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Unique", "[", "s", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "baseElems", "]"}], "}"}]}], "]"}]}],
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"relGrades", "=", 
            RowBox[{"Rest", "[", "grades", "]"}]}], ";", 
           RowBox[{"checkValueRules", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"Rule", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"p", "/@", "relGrades"}], ")"}], ",", "#"}], "]"}],
                 "]"}], "&"}], ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"Length", "[", "relGrades", "]"}]}], "]"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"theEquationsToCheck", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"gaGetMV", "[", 
                 RowBox[{"productWithPrototype", ",", 
                  RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
               "eliminateGrade"}], ")"}], "/.", "subsRules"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"trowCondition", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "theEquationsToCheck", "]"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"possibleSolutions", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Reap", "[", 
                RowBox[{"Scan", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"(", 
                    RowBox[{"theEquationsToCheck", "/.", "#"}], ")"}], "]"}], 
                    "===", "trowCondition"}], ",", 
                    RowBox[{"Sow", "[", "#", "]"}]}], "]"}], "&"}], ",", 
                  "checkValueRules"}], "]"}], "]"}], "]"}], ",", "1"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gradesForOutput", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "/@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"Rule", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "&"}], "/@",
                 "possibleSolutions"}], ")"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{"p", "->", "Identity"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"outputType", "===", "SignChangeGrades"}], ",", 
             "gradesForOutput", ",", "\[IndentingNewLine]", 
             RowBox[{"Switch", "[", 
              RowBox[{"invPos", ",", "Right", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"expr", "\[GeometricProduct]", 
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                "gradesForOutput"}], ",", "\[IndentingNewLine]", "Left", ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}], "\[GeometricProduct]", 
                   "expr"}], ")"}], "&"}], "/@", "gradesForOutput"}], ",", 
               "\[IndentingNewLine]", "_", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"expr", "\[GeometricProduct]", 
                   RowBox[{"gaGradeNegate", "[", 
                    RowBox[{"expr", ",", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                "gradesForOutput"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellLabel->
  "In[559]:=",ExpressionUUID->"269103f7-1b09-472e-9d30-30f51e79cf13"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Functions of single argument"
}], "Subsection",ExpressionUUID->"da217918-c99d-4ce2-ae95-92ce0cf52804"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Square root of multivector for n\[LessEqual]3"
}], "Subsubsection",ExpressionUUID->"4752c398-43a4-45e3-97b3-28112bde453f"],

Cell["\<\
Here we implement square root algorithm of general multivector for n\
\[LessEqual]3 case. \
\>", "Text",ExpressionUUID->"58de283e-5610-4dc9-8dc9-070c4976700d"],

Cell[CellGroupData[{

Cell["Method selection and help functions ", "Item",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"32c12529-7849-486e-89a9-69ba227b5a1b"],

Cell[TextData[{
 "Help functions used by ",
 StyleBox["gaSqrtOf[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"4ff226a4-2f04-46ef-8a78-ec99f393841e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"positiveQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"PossibleZeroQ", "[", "x", "]"}], ",", "False", ",", 
     RowBox[{"Positive", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonNegativeQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"PossibleZeroQ", "[", "x", "]"}], ",", "True", ",", 
     RowBox[{"Positive", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonzeroQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"Not", "[", 
    RowBox[{"PossibleZeroQ", "[", "x", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zeroQN", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"PossibleZeroQ", "[", "x", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[570]:=",ExpressionUUID->"f1e67b12-9351-49ef-b1d2-67ecd077fab7"],

Cell["The older implementation", "Text",ExpressionUUID->"58ccba73-06f7-42b4-9dda-3ca5231ed05f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "gaSqrt", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Quiet", "\[Rule]", "False"}], ",", 
     RowBox[{"GeneratedParameters", "\[Rule]", "C"}], ",", 
     RowBox[{"Simplify", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "::", "Method"}], "=", "\"\<Unknown method `1`.\>\""}], 
  ";"}]}], "Input",
 CellLabel->
  "In[588]:=",ExpressionUUID->"71089eed-51f7-44d7-abed-8d0aaa3cf3fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaSqrt", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aAlgebra", "=", 
        RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", 
       RowBox[{"aMethod", "=", 
        RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}]}], ",", 
       "theMethod", ",", "theAlgebra"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aAlgebra", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"theAlgebra", "=", "gaRunningAlgebra"}], ",", 
        RowBox[{"theAlgebra", "=", "aAlgebra"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aMethod", "===", "Automatic"}], ",", 
        RowBox[{"theMethod", "=", "theAlgebra"}], ",", 
        RowBox[{"theMethod", "=", "aMethod"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "2", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"3", ",", "0", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"1", ",", "2", ",", "0"}], "]"}], ",", 
            RowBox[{"Cl", "[", 
             RowBox[{"0", ",", "3", ",", "0"}], "]"}]}], "}"}], ",", 
          "theMethod"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"gaSqrt", "[", 
          RowBox[{"expr", ",", "theMethod", ",", "opts"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaSqrt", "::", "Method"}], ",", "theMethod"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[590]:=",ExpressionUUID->"9e5f6de5-b136-45eb-b35e-feb565f56d72"],

Cell["\<\
gaSqrtN is private (undocumented) function which was used to check results \
numerically. Inactivated\
\>", "Text",ExpressionUUID->"e8647c23-339e-4c90-817b-d00dd41117c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ps", "=", 
           RowBox[{"First", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"gaGetMV", "[", 
               RowBox[{
                RowBox[{"gaOrthonormalBasis", "[", "alg", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], 
                 "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], ",", "a1", ",", 
          "s", ",", "v1", ",", "v", ",", "V1", ",", "V", ",", "S", ",", 
          "coeffv1", ",", "coeffV1", ",", "bnames", ",", "genericMV", ",", 
          "takeMe", ",", "b", ",", "eqs", ",", "solEqs"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"V1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"V", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1", " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", "V1"}], ")"}], "\[GeometricProduct]", 
             "ps"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gaPE", "[", 
                 RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                "genericMV"}], ",", "_bs", ",", "takeMe"}], "]"}], ",", 
             "_takeMe", ",", "Infinity"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Equal", "[", 
             RowBox[{"x", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         RowBox[{"coeffV1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"V1", ",", "_V", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                "}"}], "]"}], ",", "Reals"}], "]"}], ",", "Reals", ",", "6", 
            ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "alg", ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"S", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "alg", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], ")"}], "/.", "solEqs"}], 
             "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "3"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"e5542a98-dda4-4ed2-a9da-0e70a77573c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "a1", ",", "v", ",", "v1", ",", "s", ",", "S", ",", "b", ",", "b1", 
          ",", "coeffv1", ",", "genericMV", ",", "bnames", ",", "eqs", ",", 
          "solEqs"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1", " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "alg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"gaGetMV", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"gaPE", "[", 
                    RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                   "b1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
                "_bs", ",", "takeMe"}], "]"}], ",", "_takeMe", ",", 
              "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Equal", "[", 
              RowBox[{"x", ",", "0"}], "]"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"solEqs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"NSolve", "[", 
              RowBox[{"eqs", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                 "}"}], "]"}], ",", "Reals", ",", 
               RowBox[{"VerifySolutions", "\[Rule]", "True"}]}], "]"}], 
             "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], ",", 
              "Reals"}], "]"}], ",", "Reals", ",", "6", ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gaPE", "[", 
                RowBox[{"s", "+", 
                 RowBox[{"gaGeneralMultivector", "[", 
                  RowBox[{"v", ",", "alg", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}], " ", "+", 
                 RowBox[{"S", "*", 
                  RowBox[{"gaI", "[", "alg", "]"}]}]}], "]"}], ")"}], "/.", 
              "solEqs"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "2"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"fdf686ac-d973-4a1a-96b9-eeeef646c5e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bs", "=", 
      RowBox[{
      "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", "]"}]}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gaSqrtN", "[", 
      RowBox[{"expr_", ",", "alg_Cl", ",", 
       RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "a1", ",", "v", ",", "v1", ",", "s", ",", "b", ",", "b1", ",", 
          "coeffv1", ",", "genericMV", ",", "bnames", ",", "eqs", ",", 
          "solEqs"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"v", ",", "alg", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a1", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", "v1"}], " ", "]"}]}], ";", 
         RowBox[{"b1", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "alg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}]}], "-", 
               "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{"gaGetMV", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"gaPE", "[", 
                   RowBox[{"a1", "\[GeometricProduct]", "a1"}], "]"}], "-", 
                  "b1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", "_bs", ",", 
               "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
            RowBox[{"Equal", "[", 
             RowBox[{"x", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coeffv1", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"v1", ",", "_v", ",", "Infinity"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"s", ",", "S", ",", "coeffv1"}], "}"}], "]"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"solEqs", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"NSolve", "[", 
              RowBox[{"eqs", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "S", ",", "coeffv1", ",", "coeffV1"}], 
                 "}"}], "]"}], ",", "Reals", ",", 
               RowBox[{"VerifySolutions", "\[Rule]", "True"}]}], "]"}], 
             "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"solEqs", "=", 
          RowBox[{"FindInstance", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"Element", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"s", ",", "coeffv1"}], "}"}], "]"}], ",", "Reals"}], 
             "]"}], ",", "Reals", ",", "6", ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"solEqs", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"Head", "[", "solEqs", "]"}], "===", "FindInstance"}], 
           ",", "Null", ",", "True", ",", 
           RowBox[{"gaPE", "[", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gaPE", "[", 
                RowBox[{"s", "+", 
                 RowBox[{"gaGeneralMultivector", "[", 
                  RowBox[{"v", ",", "alg", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}]}], " ", "]"}], ")"}], "/.",
               "solEqs"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"gaDimensionOfVectorSpace", "[", "alg", "]"}], "===", 
       "1"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUU\
ID->"320c1fd9-2c1f-4690-b7da-8b52eb4d68ef"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,0) case", "Item",ExpressionUUID->"e0bb99f1-b6b2-4fae-be26-6d65ff645b34"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"c1267408-fb42-4e01-9013-6cece29d0b1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "0"}], "]"}]}], ",", "v", ",", "s", ",", 
          "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "are", " ", "present", " ", "we",
           " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", "ordering"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}]}],
                  "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"GeometricAlgebra`p`printDetails", "[", 
          RowBox[{"quiet", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<The s is\>\"", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sSRules", "/.", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", "\"\<s\>\""}], "}"}]}], ")"}], ",", 
                RowBox[{"{", 
                 RowBox[{"___", ",", 
                  RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                 "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", "0"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"b", "[", "0", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"b", "[", "0", "]"}], "]"}]}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"nonNegativeQN", "[", 
                RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"b", "[", "0", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"Union", "[", "specAnswer00", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"583eed70-e129-4d3e-a372-817114be155d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,1) case", "Item",ExpressionUUID->"8ab08e55-bec0-44d6-b19f-ec3f874690e3"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"dedf9d7c-0afc-4807-a4c6-5d2a75546f9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], ",", "v", ",", "s", ",", 
          "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "are", " ", "present", " ", "we",
           " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", "ordering"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], "}"}]}],
                  "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s is\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", "0"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"-", 
              RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"-", 
                   RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"nonNegativeQN", "[", 
                RowBox[{"-", 
                 RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"nonNegativeQN", "[", 
             RowBox[{"-", 
              RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"Union", "[", "specAnswer00", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"1084e821-5e43-4ea5-b447-e8eea822ee14"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,0) case", "Item",ExpressionUUID->"5489a124-a492-4370-89c2-8bea07b23fcc"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"8efafede-b9af-46a8-ac6b-2da4f6b30f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"2", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"2", ",", "0"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"9bed5b40-59d5-4674-8cd1-450bd33201bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,1) case (the algebra is isomorphic to Cl(2,0)) ", "Item",ExpressionUUID->"328d4f1e-abf1-46c3-adff-d0b4b0b9d828"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"50df9421-1a9d-4138-8a81-2151507f9197"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "1"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", "det", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"detSqrt", "->", 
                  RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"sSRules", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"b", "[", "0", "]"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"7d839d58-17e2-469b-8a90-02c1b91dd383"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,2) case", "Item",ExpressionUUID->"797bfead-0439-49d6-891f-45f3f52db796"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"423b2b2f-8185-4dac-a5a7-4646dc8c9ac3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "2"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "2"}], "]"}]}], ",", "v", ",", "s", ",", "S", 
          ",", "solTemplate", ",", "genericMV", ",", "b", ",", "bnames", ",", 
          "det", ",", "detSqrt", ",", "theTransformation", ",", "sSRules", 
          ",", "vVRules", ",", "genericAnswer", ",", "freeParamRules", ",", 
          "specAnswer00", ",", "specAnswer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"since", " ", "explicit", " ", 
          RowBox[{"b", "[", "0", "]"}], " ", 
          RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
          RowBox[{"b", "[", "7", "]"}], " ", 
          RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", " ",
           "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
          "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{"S", "*", 
             RowBox[{"gaI", "[", "theAlg", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"det", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"b", "[", "3", "]"}], "^", "2"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "determinant", " ", "norm", " ", "is", " ", "always", " ", 
           "positive", " ", "for", " ", "cl", 
           RowBox[{"(", 
            RowBox[{"0", ",", "2"}], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"sSRules", "=", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "detSqrt"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"S", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}], ",", 
                  RowBox[{"s", "\[Rule]", 
                   RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"detSqrt", "+", 
                    RowBox[{"b", "[", "0", "]"}]}], "]"}]}], "]"}]}]}], 
                 "}"}]}], "}"}], "/.", 
              RowBox[{"{", 
               RowBox[{"detSqrt", "->", 
                RowBox[{"Sqrt", "[", "det", "]"}]}], "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"takeMe", "->", "Identity"}], "}"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The s and S are\>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sSRules", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", "\"\<s\>\""}], ",", 
                    RowBox[{"S", "\[Rule]", "\"\<S\>\""}]}], "}"}]}], ")"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                 "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"When", " ", "s"}], "\[Equal]", 
            RowBox[{
            "0", " ", "the", " ", "solution", " ", "only", " ", "exists", " ",
              "when", " ", 
             RowBox[{"b", "[", "1", "]"}]}]}], "=", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], "=", 
            RowBox[{
             RowBox[{"b", "[", "3", "]"}], "=", "0"}]}]}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"All", " ", "solutions", "  ", "taken"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"freeParamRules", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"S", "\[Rule]", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "]"}]}], 
                "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"solTemplate", "/.", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", "0"}], "}"}]}], ")"}], "/.", 
                  "#"}], ")"}], "&"}], "/@", "freeParamRules"}], ")"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
               RowBox[{"zeroQN", "[", 
                RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "specAnswer00", "]"}]}], 
                    "}"}], "]"}], "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            "s"}], "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "1", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "2", "]"}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"b", "[", "3", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", "specAnswer00", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
               RowBox[{"genParam", "[", 
                RowBox[{"1", ",", "in"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",Exp\
ressionUUID->"d886fe9c-ba1f-4439-8c5c-39fdbdbb47c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(3,0) case", "Item",ExpressionUUID->"bfe6d47a-c8fe-4120-a368-9b9f9f8ad02f"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"41568810-f1c8-4284-8c4f-752393da4190"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"3", ",", "0"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"3", ",", "0"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "theTransformation", ",", "\[IndentingNewLine]", 
          "solTemplate", ",", "ps", ",", "bnames", ",", "bCCb0", ",", 
          "bCCbI0", ",", "detSqrt", ",", "genericMV", ",", "takeMe", ",", "b",
           ",", "stS", ",", "s2pS2", ",", "stSs2pS2", ",", "s", ",", "S", ",",
           "sSRulesT", ",", "sSRules", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "+", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=", 
                RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "+", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
                     "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "5", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "2", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "S"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "5", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "S", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "S", "]"}]}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}],
                     "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", " ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{"zeroQN", "[", 
           RowBox[{
            RowBox[{"4", "*", "bCCb0", "*", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], "+", 
            RowBox[{"bCCbI0", "^", "2"}], "-", 
            RowBox[{"4", "*", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "4"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S"}], " ", "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesPositive"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{"-", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesNegative"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "+", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "explicit", " ", "equations", " ", "and", " ", "their", " ", 
               "solutions"}], ",", " ", 
              RowBox[{"which", " ", "depend", " ", "on", " ", 
               RowBox[{"parameters", ".", " ", "Not"}], " ", "all", " ", 
               "parameters", " ", "have", " ", "numerical", " ", "values", 
               " ", "in", " ", 
               RowBox[{
                RowBox[{"R", " ", "!!"}], "!"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "1", "]"}], "*", 
                    RowBox[{"V", "[", "1", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"7f172efb-1641-453b-9665-\
359c59f30340"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,1) case", "Item",ExpressionUUID->"64049c0c-c575-4904-a093-abd750ee256f"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"5768c394-99d0-4319-8260-cb701d700939"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"2", ",", "1"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "theTransformation", ",", "solTemplate", ",", "ps", 
          ",", "bnames", ",", "\[IndentingNewLine]", "bCCb0", ",", "bCCbI0", 
          ",", "detSqrt", ",", "genericMV", ",", "takeMe", ",", "b", ",", 
          "stS", ",", "s2pS2", ",", "stSs2pS2", ",", "s", ",", "S", ",", 
          "sSRulesT", ",", "sSRules", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules", ",", 
          "freeParamRulesMissed"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "-", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"in", " ", "cl", 
           RowBox[{"(", "21", ")"}], " ", "determinant", " ", "can", " ", 
           "be", " ", 
           RowBox[{"negative", ".", " ", "Then"}], " ", "there", " ", "are", 
           " ", "no", " ", "solutions"}], " ", "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonNegativeQN", "[", 
            RowBox[{
             RowBox[{"bCCb0", "^", "2"}], "-", 
             RowBox[{"bCCbI0", "^", "2"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stSs2pS2", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"(*", " ", 
                  RowBox[{"s", "=", 
                   RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stS", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                    
                    RowBox[{"s2pS2", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                   "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Generic", "  ", 
                RowBox[{"s", "^", "2"}]}], "-", 
               RowBox[{"S", "^", "2"}]}], "=!=", 
              RowBox[{
              "0", "  ", "solution", " ", "of", " ", "first", " ", "system", 
               " ", "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"sSRulesT", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "-", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], " ", "means", 
                    " ", 
                    RowBox[{"nonzeroQN", "[", "stS", "]"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "/.", 
                    "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
                "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"take", " ", "on", " ", 
                RowBox[{"s", "^", "2"}]}], "-", 
               RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"sSRules", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                   "sSRulesT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Show", " ", 
              RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"quiet", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"CellPrint", "[", 
                RowBox[{"{", 
                 RowBox[{"TextCell", "[", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                   "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"quiet", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"CellPrint", "[", 
                 RowBox[{"{", 
                  RowBox[{"TextCell", "[", 
                   RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                    "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
                  "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplate", "=", 
             RowBox[{"gaPE", "[", 
              RowBox[{"s", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"v", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}], " ", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"S", "+", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRules", "=", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"s", "^", "2"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"S", "^", "2"}]}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
                    "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
                 "]"}], ",", "1"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"genericAnswer", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
               ")"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                   "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has no \
solution!\>\"", "]"}], "}"}], "]"}], " ", "}"}], "]"}], "]"}], "}"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"genericAnswer", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{
           RowBox[{"zeroQN", "[", 
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], "]"}], "||", 
           RowBox[{"zeroQN", "[", 
            RowBox[{
             RowBox[{"-", "bCCb0"}], "-", "bCCbI0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "+", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "-", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "+", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "+", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", " ", 
                   RowBox[{"(*", 
                    RowBox[{"s", "\[NotEqual]", 
                    RowBox[{
                    "0", " ", "is", " ", "ensured", " ", "by", " ", 
                    "positiveQ"}]}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}]}], 
                    "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sSRulesPositive", "]"}], "===", "List"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{"-", "S"}], " ", "-", "bCCb0", "-", "bCCbI0", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "+", 
               RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
           "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "+", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "-", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "-", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
                   "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}]}], ")"}]}]}], 
                    "]"}]}]}], ")"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", "\[IndentingNewLine]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sSRulesNegative", "]"}], "===", "List"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "-", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "-", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "1", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "2", "]"}], "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"v", "[", "3", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "1", "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "2", "]"}], "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"V", "[", "3", "]"}], "2"]}], "\[Equal]", "0"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "1", "]"}], " ", 
                    RowBox[{"V", "[", "1", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "2", "]"}], " ", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "3", "]"}], " ", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"specAnswer00", "=", 
              RowBox[{"{", 
               RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], "}"}]}],
              ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"b69ef5de-a255-4916-8aa9-\
9108fcb606b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,2) case (the algebra is isomorphic to Cl(3,0) )", "Item",ExpressionUUID->"74f8001e-15e4-4704-8e61-b6f416fbfeb2"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"918cab6c-cc2c-46c0-9a11-e030ca2346e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "theTransformation", ",", 
          "ps", ",", "bnames", ",", "bCCb0", ",", "bCCbI0", ",", "detSqrt", 
          ",", "genericMV", ",", "takeMe", ",", "b", ",", "stS", ",", "s2pS2",
           ",", "stSs2pS2", ",", "s", ",", "S", ",", "sSRulesT", ",", 
          "sSRules", ",", "solTemplate", ",", "genericAnswer", ",", 
          "equalsSCase", ",", "sSRulesPositive", ",", "sSRulesPositiveT", ",",
           "vVRulesPositive", ",", "sSRulesNegativeT", ",", "sSRulesNegative",
           ",", "vVRulesNegative", ",", "v", ",", "V", ",", "vVRules", ",", 
          "solTemplateSpec1", ",", "solTemplateSpec2", ",", 
          "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", ",", 
          "specAnswer2", ",", "specAnswer00", ",", "freeParamRules"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"since", " ", "explicit", " ", 
           RowBox[{"b", "[", "0", "]"}], " ", 
           RowBox[{"(", "scalar", ")"}], " ", "and", " ", 
           RowBox[{"b", "[", "7", "]"}], " ", 
           RowBox[{"(", "speudoscalar", ")"}], " ", "are", " ", "present", 
           " ", "we", " ", "require", " ", "\"\<InvDeg[Lex]\>\"", " ", 
           "ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "+", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"!", " ", 
           RowBox[{"algebra", " ", "specific"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=!=", "S"}], " ", "*)"}], "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "-", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "-", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", "detSqrt"}], "]"}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "+", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "-", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], ")"}]}],
                     "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}]}],
                     ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{
                    RowBox[{"-", "s2pS2"}], "+", "sSSqrt"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}],
                     "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is\>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "+", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{"zeroQN", "[", 
           RowBox[{
            RowBox[{"bCCbI0", "^", "2"}], "+", 
            RowBox[{"4", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
             RowBox[{"(", 
              RowBox[{"bCCb0", "-", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"bCCbI0", "^", "2"}], "+", 
             RowBox[{"4", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
              RowBox[{"(", 
               RowBox[{"bCCb0", "-", 
                RowBox[{
                 RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
            "\[Equal]", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "1", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "2", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "3", "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesPositive"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "S"}], " ", 
             RowBox[{"bCCbI0", "^", "2"}]}], "+", 
            RowBox[{"4", 
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "^", "2"}], 
             RowBox[{"(", 
              RowBox[{"bCCb0", "-", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "^", "2"}]}], ")"}]}]}], 
           "\[Equal]", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}], "/", 
                    "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"bCCbI0", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}], "/", "2"}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}], "/", "2"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"b", "[", "0", "]"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "bCCb0"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "5", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "s"}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                  "&"}], "/@", "sSRulesNegative"}], ")"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "+", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], "+", 
                    
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "7", "]"}], "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}], "]"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], 
                    ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], "+", 
                    
                    RowBox[{"4", "*", 
                    RowBox[{"b", "[", "7", "]"}], "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}], "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"V", "[", "2", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}]}], ")"}]}], 
                    ")"}]}]}]}], "}"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "1", "]"}], " ", 
                    RowBox[{"V", "[", "1", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "2", "]"}], " ", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"v", "[", "3", "]"}], " ", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"specAnswer00", "=", 
              RowBox[{"{", 
               RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], "}"}]}],
              ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{"S", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"d86a50c8-e258-460e-9c03-\
bd22c334874d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,3) case", "Item",ExpressionUUID->"3d0c09a2-0346-4269-b483-eccb54055148"],

Cell[TextData[{
 "Older, rather well checked realization using ConditionalExpression[  ]. \
Unfortunately, this realization do not allow symbolic inputs, therefore as \
for now we attempt to rewrite it using Piecewise under new name   ",
 StyleBox["gaSqrtOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"18a5a6ff-048e-406a-8e29-8ee664ae3e42"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bs", "=", 
        RowBox[{
        "Symbol", "[", "GeometricAlgebra`p`orthonormalBasisSymbolName", 
         "]"}]}], ",", 
       RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gaSqrt", "[", 
       RowBox[{"expr_", ",", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "3"}], "]"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"quiet", "=", 
           RowBox[{"Not", "[", 
            RowBox[{"OptionValue", "[", "Quiet", "]"}], "]"}]}], ",", 
          RowBox[{"genParam", "=", 
           RowBox[{"OptionValue", "[", "GeneratedParameters", "]"}]}], ",", 
          RowBox[{"simplify", "=", 
           RowBox[{"OptionValue", "[", "Simplify", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"theAlg", "=", 
           RowBox[{"Cl", "[", 
            RowBox[{"0", ",", "3"}], "]"}]}], ",", 
          RowBox[{"exExCC", "=", 
           RowBox[{"Expand", "[", 
            RowBox[{"gaPE", "[", 
             RowBox[{"expr", "\[GeometricProduct]", 
              RowBox[{"gaCliffordConjugate", "[", "expr", "]"}]}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "ps", ",", 
          "theTransformation", ",", "solTemplate", ",", "bnames", ",", 
          "bCCb0", ",", "bCCbI0", ",", "detSqrt", ",", "genericMV", ",", 
          "takeMe", ",", "b", ",", "stS", ",", "s2pS2", ",", "stSs2pS2", ",", 
          "s", ",", "S", ",", "sSRulesT", ",", "sSRules", ",", 
          "genericAnswer", ",", "equalsSCase", ",", "sSRulesPositive", ",", 
          "sSRulesPositiveT", ",", "vVRulesPositive", ",", "sSRulesNegativeT",
           ",", "sSRulesNegative", ",", "vVRulesNegative", ",", "v", ",", "V",
           ",", "vVRules", ",", "solTemplateSpec1", ",", "solTemplateSpec2", 
          ",", "solTemplateSpec00", ",", "specAnswer", ",", "specAnswer1", 
          ",", "specAnswer2", ",", "specAnswer00", ",", "freeParamRules", ",",
           "freeParamRulesMissed"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "obsolete"}], ",", 
           RowBox[{"gaSqrt", "[", "]"}], ",", 
           RowBox[{"gaSqrtOfMV", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetAttributes", "[", 
          RowBox[{"takeMe", ",", "HoldAll"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"gaOrthonormalBasis", "[", 
              RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}], 
             "]"}], "===", "gaOrthonormalBasis"}], ",", 
           RowBox[{"gaDefineOrthonormalBasis", "[", 
            RowBox[{"theAlg", ",", 
             RowBox[{
             "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}], 
             ",", 
             RowBox[{"gaMakeAlias", "\[Rule]", "False"}], ",", 
             RowBox[{"Quiet", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ps", "=", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"gaGetMV", "[", 
              RowBox[{
               RowBox[{"gaOrthonormalBasis", "[", 
                RowBox[{"theAlg", ",", "requireOrdering", ",", "All"}], "]"}],
                ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", "0"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{"simplify", ",", "True", ",", 
           RowBox[{"theTransformation", "=", "Simplify"}], ",", "False", ",", 
           
           RowBox[{"theTransformation", "=", "Identity"}], ",", "_", ",", 
           RowBox[{"theTransformation", "=", "simplify"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCb0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{"exExCC", ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bCCbI0", "=", 
          RowBox[{"theTransformation", "[", 
           RowBox[{"gaGetMV", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"gaPE", "[", 
               RowBox[{"exExCC", "\[GeometricProduct]", "ps"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", "0", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"detSqrt", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"bCCb0", "^", "2"}], "-", 
            RowBox[{"bCCbI0", "^", "2"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"genericMV", "=", 
          RowBox[{"gaGeneralMultivector", "[", 
           RowBox[{"b", ",", "theAlg", ",", "All", ",", 
            RowBox[{
            "gaNonCommutativeMonomialOrder", "\[Rule]", "requireOrdering"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bnames", "=", 
          RowBox[{"b", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"gaDimensionOfVectorSpace", "[", "theAlg", "]"}]}], 
               "-", "1"}]}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Set", "@@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"genericMV", "-", "expr"}], ",", "_bs", ",", 
                "takeMe"}], "]"}], ",", "_takeMe", ",", "Infinity"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"takeMe", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "0"}], ",", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", "x", "]"}], ",", "bnames"}], 
                "]"}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "generic", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "=!=", 
            RowBox[{"0", " ", "and", " ", "s"}], "=!=", "0"}], " ", "||", " ", 
           RowBox[{"S", "=!=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Select", " ", "generic", " ", "or", " ", "specific", " ", 
           "solution", " ", "of", " ", "second", " ", "system", " ", "of", 
           " ", "eqs"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"stSs2pS2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", " ", 
               RowBox[{"s", "=", 
                RowBox[{"!", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}]}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "/", "4"}], "]"}], ",", 
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}]}], "]"}]}], ",", 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "bCCb0", "]"}], "+", 
                    RowBox[{"b", "[", "0", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "bCCbI0", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "bCCb0", "]"}]}]}], 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "-", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stS", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "/", "4"}], "]"}], 
                    ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}], ",", 
                 
                 RowBox[{"s2pS2", "\[Rule]", 
                  RowBox[{"ConditionalExpression", "[", 
                   RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", "bCCbI0"}], ")"}], 
                    "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}]}]}], ")"}], "/", "8"}], 
                    "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"bCCb0", "+", "detSqrt"}], "]"}]}], "]"}]}]}], 
                "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"___", ",", 
              RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Generic", "  ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", 
           RowBox[{
           "0", "  ", "solution", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sSRulesT", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sSSqrt", "=", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"s2pS2", "^", "2"}], "-", 
                    RowBox[{"stS", "^", "2"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], ")"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", "0", "]"}], ",", 
                    RowBox[{"zeroQN", "[", "stS", "]"}]}], "]"}]}], ",", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", "s2pS2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", "stS", "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", "s2pS2", "]"}]}]}], 
                    "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], " ", "means", 
                    " ", 
                    RowBox[{"nonzeroQN", "[", "stS", "]"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "-", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], ")"}]}], "]"}],
                     ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"S", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{"stS", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}], ",", 
                    RowBox[{"positiveQN", "[", 
                    RowBox[{"s2pS2", "+", "sSSqrt"}], "]"}]}], "]"}]}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "/.", 
                    "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "stSs2pS2"}], ")"}], 
             "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Show", " ", 
           RowBox[{"what", "'"}], "s", " ", "going"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CellPrint", "[", 
             RowBox[{"{", 
              RowBox[{"TextCell", "[", 
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The parametrization of MV is A=s+v+(S+V)I\>\"", 
                    "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s2pS2=s^2-S^2 is \>\"", "]"}], 
                    ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"s2pS2", "/.", "stSs2pS2"}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", "\"\<The stS=s*S is \>\"", "]"}],
                     ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"stS", "/.", "stSs2pS2"}], "]"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<{b_S,b_I,Sqrt[D]} \>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"{", 
                    RowBox[{"bCCb0", ",", "bCCbI0", ",", "detSqrt"}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                "]"}], "]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"take", " ", "on", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"sSRules", "=", 
          RowBox[{"theTransformation", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{"sSRulesT", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"nonzeroQN", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"s", "^", "2"}], "-", 
                   RowBox[{"S", "^", "2"}]}], "/.", "#"}], "]"}], "&"}], "/@",
                "sSRulesT"}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRules", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The regular case s^2\[NotEqual]S^2 has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRules", "]"}]}], "}"}], 
                   "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], "]"}], 
               "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"solTemplate", "=", 
          RowBox[{"gaPE", "[", 
           RowBox[{"s", "+", 
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"v", ",", "theAlg", ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{
              "gaNonCommutativeMonomialOrder", "\[Rule]", 
               "requireOrdering"}]}], "]"}], " ", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"S", "+", 
               RowBox[{"gaGeneralMultivector", "[", 
                RowBox[{"V", ",", "theAlg", ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{
                 "gaNonCommutativeMonomialOrder", "\[Rule]", 
                  "requireOrdering"}]}], "]"}]}], ")"}], 
             "\[GeometricProduct]", "ps"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vVRules", "=", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{"\"\<S\>\"", "\[Rule]", "S"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "-", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "1", "]"}]}], ")"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "6", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "2", "]"}]}], ")"}]}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "5", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"S", "*", 
                    RowBox[{"b", "[", "3", "]"}]}], ")"}]}], "-", 
                    RowBox[{"s", "*", 
                    RowBox[{"b", "[", "4", "]"}]}]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"s", "^", "2"}]}], "+", 
                    RowBox[{"S", "^", "2"}]}], ")"}]}], ")"}]}], "]"}], ",", 
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{
                    RowBox[{"s", "^", "2"}], "-", 
                    RowBox[{"S", "^", "2"}]}], "]"}]}], "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "}"}], "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}], ",", "___"}], 
                    "}"}]}], "]"}], "]"}], "&"}], "/@", "sSRules"}], ")"}], 
              "]"}], ",", "1"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<S\>\"", "\[Rule]", "S"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"genericAnswer", "=", 
          RowBox[{"gaPE", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solTemplate", "/.", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", "vVRules"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Answer", " ", "of", " ", "regular", " ", "case"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Start", " ", "specific", " ", "case", " ", 
              RowBox[{"s", "^", "2"}]}], "-", 
             RowBox[{"S", "^", "2"}]}], "==", 
            RowBox[{"0", " ", "and", " ", "s"}]}], "=!=", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Specific", " ", 
             RowBox[{"s", "^", "2"}]}], "-", 
            RowBox[{"S", "^", "2"}]}], "==", 
           RowBox[{
           "0", " ", "solutions", " ", "of", " ", "first", " ", "system", " ",
             "of", " ", "eqs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"common", " ", "part", " ", "for", " ", "s"}], "=", 
           RowBox[{
            RowBox[{"S", "  ", "and", " ", "s"}], "\[Equal]", 
            RowBox[{"-", "S"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"equalsSCase", "=", 
          RowBox[{
           RowBox[{"zeroQN", "[", 
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], "]"}], "||", 
           RowBox[{"zeroQN", "[", 
            RowBox[{
             RowBox[{"-", "bCCb0"}], "-", "bCCbI0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "+", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"s", "\[Equal]", "S"}], " ", ";", " ", 
           RowBox[{
            RowBox[{"bCCb0", "-", "bCCbI0", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", "[", "0", "]"}], "-", 
                RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "+", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "-", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "+", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesPositiveT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", " ", 
                   RowBox[{"(*", 
                    RowBox[{"s", "\[NotEqual]", 
                    RowBox[{
                    "0", " ", "is", " ", "ensured", " ", "by", " ", 
                    "positiveQ"}]}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"b", "[", "0", "]"}], "*", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}]}], 
                    "]"}]}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
                   "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesPositive", "=", 
             RowBox[{"theTransformation", "/@", 
              RowBox[{"Pick", "[", 
               RowBox[{"sSRulesPositiveT", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                  "sSRulesPositiveT"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "+", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesPositive", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "1", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "5", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "1", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "[", "5", "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{"b", "[", "4", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "-", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"nonzeroQN", "[", "s", "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "+", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "-", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "+", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesPositive"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec1", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer1", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec1", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesPositive"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer1", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesPositive", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=S\[NotEqual]0 (positive) case has solution \
\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesPositive", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", 
           RowBox[{
            RowBox[{"-", "S"}], " ", "-", "bCCb0", "-", "bCCbI0", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "+", 
               RowBox[{"b", "[", "7", "]"}]}], ")"}], "2"]}], "\[Equal]", 
           "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "-", 
              RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "+", 
              RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "-", 
              RowBox[{"b", "[", "4", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sSRulesNegativeT", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"s", "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}], "&&", 
                    RowBox[{"nonNegativeQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "-", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"2", "*", "bCCb0"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ",", 
                RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sSRulesNegative", "=", 
             RowBox[{"(", 
              RowBox[{"theTransformation", "/@", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesNegativeT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nonzeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&"}], "/@", 
                   "sSRulesNegativeT"}], ")"}]}], "]"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "-", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRulesMissed", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], "*", 
                   RowBox[{"b", "[", "1", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "bCCb0"}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "^", "2"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "^", "2"}], "-", 
                    RowBox[{"16", "*", "s", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}]}], "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"s", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}]}]}], 
                    ")"}]}]}], "]"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "s"}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vVRulesNegative", "=", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRules", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "6", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "1", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "2", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "\[Rule]", 
                    RowBox[{"ConditionalExpression", "[", 
                    RowBox[{
                    RowBox[{"takeMe", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "[", "4", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "s"}], ")"}]}], "+", 
                    RowBox[{"V", "[", "3", "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "1", "]"}], "-", 
                    RowBox[{"b", "[", "6", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "2", "]"}], "+", 
                    RowBox[{"b", "[", "5", "]"}]}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{
                    RowBox[{"b", "[", "3", "]"}], "-", 
                    RowBox[{"b", "[", "4", "]"}]}], "]"}], "&&", 
                    RowBox[{"nonzeroQN", "[", "s", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                    RowBox[{"V", "[", "1", "]"}]}]}], "}"}], 
                    "\[IndentingNewLine]", "/.", "#"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"takeMe", "\[Rule]", "Identity"}], "}"}]}], ")"}],
                     "/.", 
                    RowBox[{"(", 
                    RowBox[{"freeParamRulesMissed", "/.", "#"}], ")"}]}], ",", 
                    RowBox[{"_", "\[Rule]", "Undefined"}]}], "]"}], "]"}], 
                    "&"}], "/@", "sSRulesNegative"}], ")"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", 
                RowBox[{"\"\<V[1]\>\"", "\[Rule]", 
                 RowBox[{"V", "[", "1", "]"}]}]}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"solTemplateSpec2", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{"s", "+", 
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "s"}], "+", 
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}]}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"specAnswer2", "=", 
             RowBox[{"gaPE", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"solTemplateSpec2", "/.", "#"}], ")"}], "&"}], "/@",
                 "vVRulesNegative"}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer2", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sSRulesNegative", "]"}], ">", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"CellPrint", "[", 
              RowBox[{"{", 
               RowBox[{"TextCell", "[", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", 
                    "\"\<The s=-S\[NotEqual]0 (negative) case has solution \>\
\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", "sSRulesNegative", "]"}]}],
                     "}"}], "]"}], " ", "\[IndentingNewLine]", "}"}], "]"}], 
                "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"s", "\[Equal]", "S", "\[Equal]", "0"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"equalsSCase", "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"zeroQ", "/@", 
               RowBox[{"(", 
                RowBox[{"b", "/@", 
                 RowBox[{"Range", "[", "6", "]"}]}], ")"}]}], ")"}]}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCb0", "-", 
              RowBox[{
               RowBox[{"b", "[", "0", "]"}], "^", "2"}], " ", "-", 
              RowBox[{
               RowBox[{"b", "[", "7", "]"}], "^", "2"}]}], "]"}], "&&", 
            RowBox[{"zeroQN", "[", 
             RowBox[{"bCCbI0", "-", 
              RowBox[{"2", " ", 
               RowBox[{"b", "[", "0", "]"}], "*", " ", 
               RowBox[{"b", "[", "7", "]"}]}]}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Pick", "[", 
                RowBox[{"sSRulesT", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                   "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"solTemplateSpec00", "=", 
             RowBox[{"(", 
              RowBox[{"gaPE", "[", 
               RowBox[{
                RowBox[{"gaGeneralMultivector", "[", 
                 RowBox[{"v", ",", "theAlg", ",", 
                  RowBox[{"{", "1", "}"}], ",", 
                  RowBox[{
                  "gaNonCommutativeMonomialOrder", "\[Rule]", 
                   "requireOrdering"}]}], "]"}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"gaGeneralMultivector", "[", 
                   RowBox[{"V", ",", "theAlg", ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], ")"}], 
                 "\[GeometricProduct]", "ps"}]}], "]"}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Only", " ", "one", " ", "solution", " ", "taken", " ", "here", 
              " ", "for", " ", "free", " ", 
              RowBox[{"parameters", "!"}], " ", "Some", " ", "solutions", " ",
               "can", " ", "be", " ", "missed", " ", "here"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"freeParamRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"V", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "7", "]"}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "+", 
                    RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], ")"}], "^", "2"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "[", "0", "]"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], ")"}], "^", 
                    "2"}]}], "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"specAnswer00", "=", 
               RowBox[{"{", 
                RowBox[{"solTemplateSpec00", "/.", "freeParamRules"}], 
                "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"freeParamRules", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "0", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"v", "[", "3", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "1", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "2", "]"}], "^", "2"}], "-", 
                   RowBox[{
                    RowBox[{"V", "[", "3", "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b", "[", "7", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "1", "]"}], "*", 
                    RowBox[{"V", "[", "1", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "2", "]"}], "*", 
                    RowBox[{"V", "[", "2", "]"}]}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"v", "[", "3", "]"}], "*", 
                    RowBox[{"V", "[", "3", "]"}]}]}], "\[Equal]", "0"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", "1", "]"}], ",", 
                 RowBox[{"V", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"specAnswer00", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"solTemplateSpec00", "/.", "#"}], ")"}], "&"}], "/@", 
              "freeParamRules"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"specAnswer00", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"quiet", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Pick", "[", 
                  RowBox[{"sSRulesT", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}], ">", "0"}], ")"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"CellPrint", "[", 
               RowBox[{"{", 
                RowBox[{"TextCell", "[", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "TextCell", "[", "\"\<The s=S=0  case has solution \>\"", 
                    "]"}], ",", 
                    RowBox[{"ExpressionCell", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"sSRulesT", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"s", "/.", "#"}], "]"}], "&&", 
                    RowBox[{"zeroQN", "[", 
                    RowBox[{"S", "/.", "#"}], "]"}]}], ")"}], "&"}], "/@", 
                    "sSRulesT"}], ")"}]}], "]"}], "]"}]}], "}"}], "]"}], 
                   "\[IndentingNewLine]", "}"}], "]"}], "]"}], "}"}], "]"}]}],
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "construct", " ", "special", " ", "case", " ", "answer", " ", 
            RowBox[{"s", "^", "2"}]}], "===", 
           RowBox[{
            RowBox[{"S", "^", "2"}], " ", "and", " ", "replace", " ", 
            RowBox[{"v", "[", "i", "]"}], " ", "by", " ", 
            RowBox[{"C", "[", 
             RowBox[{"1", ",", "i"}], "]"}], " ", "and", " ", 
            RowBox[{"V", "[", "i", "]"}], " ", "by", " ", 
            RowBox[{"C", "[", 
             RowBox[{"2", ",", "i"}], "]"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"equalsSCase", ",", "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
              "specAnswer00", ",", "specAnswer1", ",", "specAnswer2"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"v", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"1", ",", "in"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"V", "[", "in_Integer", "]"}], "\[RuleDelayed]", 
                RowBox[{"genParam", "[", 
                 RowBox[{"2", ",", "in"}], "]"}]}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"specAnswer", "=", 
            RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "explicit", " ", "equations", " ", "for", " ", "v", " ", "and", " ",
            "V"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Join", "[", 
          RowBox[{"genericAnswer", ",", "specAnswer"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",ExpressionUUID->"183d1da1-7cd0-447e-b98f-\
37402b018610"]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Exponent of MV for n\[LessEqual]3"
}], "Subsubsection",ExpressionUUID->"ef5a79b8-23b4-4ecc-bb0c-ff97c8b1c32b"],

Cell["\<\
Here we compute exact exponent of general multivector for n=2 and Cl(3,0) \
algebras \
\>", "Text",ExpressionUUID->"16e9211c-d78b-42b3-934d-52af48cd3710"],

Cell[CellGroupData[{

Cell["Method selection, help functions", "Item",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"2f51f5e0-693f-43ec-8449-fc8752ac97fa"],

Cell[TextData[{
 "First general code and options . Set Listable attribute to  ",
 StyleBox["gaExpOfMV[ ]",
  FontWeight->"Bold"],
 ". Then in can nicely handle the case ",
 StyleBox["gaExpOfMV[{} ]",
  FontWeight->"Bold"],
 ", which is convenient when testing MV for which logarithms don\
\[CloseCurlyQuote]t exist. "
}], "Text",ExpressionUUID->"b414f7e6-41da-4d25-88bd-17e2185915d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"gaExpOfMV", ",", "Listable"}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[582]:=",ExpressionUUID->"6c724a62-b7bd-4a0e-abc3-36127bc046a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "gaExpOfMV", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Automatic\>\"", ",", 
        RowBox[{"gaFormula", "\[Rule]", "\"\<Automatic\>\""}]}], "}"}]}], ",", 
     RowBox[{"Quiet", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaExpOfMV", "::", "lowDimensionFormula"}], "=", 
   "\"\<The algebra dimension `1` is greater than 3, \\\"LowDimension\\\" \
option will be ignored.\>\""}], ";"}]}], "Input",
 CellLabel->
  "In[583]:=",ExpressionUUID->"c2c7346d-8854-4251-8321-f381f2c5a0ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "single", " ", "argument", " ", "call", " ", "is", " ", "used", " ", "to", 
    " ", "print", " ", "valid", " ", "option", " ", "pattern", " ", "for", 
    " ", "user"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Since", " ", "only", " ", "specific", " ", "combinantions", " ", "of", 
     " ", "Method", " ", "and", " ", "gaFormula", " ", "are", " ", 
     "allowed"}], ",", " ", 
    RowBox[{"test", " ", "splits", " ", "into", " ", "pieces"}]}], " ", 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", "\"\<Method\>\"", "]"}], "=", 
     RowBox[{"Alternatives", "[", 
      RowBox[{
      "Automatic", ",", "\"\<Automatic\>\"", ",", 
       "\"\<CoordinateFree \
(gaFormula->\\\"LowDimension\\\"|\\\"ScalarPartOutOfSum\\\"|\\\"\
ScalarPartInSum\\\")\>\"", ",", "\"\<gaMatrixRepresentation\>\""}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{"{", 
       RowBox[{"theMethod_String", ",", "\"\<gaFormula\>\""}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"HoldForm", "[", 
       RowBox[{"{", 
        RowBox[{"theMethod", ",", 
         RowBox[{"gaFormula", "->", 
          RowBox[{"Alternatives", "[", 
           RowBox[{
           "Automatic", ",", "\"\<Automatic\>\"", ",", "\"\<LowDimension\>\"",
             ",", "\"\<ScalarPartOutOfSum\>\"", ",", 
            "\"\<ScalarPartInSum\>\""}], "]"}]}]}], "}"}], "]"}], "/;", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"theMethod", ",", 
        RowBox[{"Alternatives", "[", 
         RowBox[{"\"\<Automatic\>\"", ",", "\"\<CoordinateFree\>\""}], 
         "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", "\"\<Quiet\>\"", "]"}], "=", 
     RowBox[{"\"\<True\>\"", "|", "\"\<False\>\""}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"if", " ", "option", " ", "has", " ", "suboptions"}], ",", " ", 
     RowBox[{
     "test", " ", "function", " ", "should", " ", "be", " ", "defined", " ", 
      "for", " ", "each", " ", "suboption"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{"\"\<Method\>\"", ",", "val_String"}], "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"val", ",", 
       RowBox[{"Alternatives", "[", 
        RowBox[{
        "\"\<Automatic\>\"", ",", "\"\<CoordinateFree\>\"", ",", 
         "\"\<gaMatrixRepresentation\>\""}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{"\"\<Method\>\"", ",", "Automatic"}], "]"}], ":=", "True"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{"\"\<Method\>\"", ",", "val_List"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"val", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<Automatic\>\"", "|", "Automatic", "|", 
            "\"\<CoordinateFree\>\"", "|", "\"\<gaMatrixRepresentation\>\""}],
            ",", "___Rule"}], "}"}]}], "]"}], "&&", 
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "val", "]"}], ",", 
         RowBox[{
          RowBox[{"testOptionExpOfMV", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"val", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"theMethod_String", ",", "\"\<gaFormula\>\""}], "}"}], ",", 
       "val_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"val", ",", 
        RowBox[{"Alternatives", "[", 
         RowBox[{
         "Automatic", ",", "\"\<Automatic\>\"", ",", "\"\<LowDimension\>\"", 
          ",", "\"\<ScalarPartOutOfSum\>\"", ",", "\"\<ScalarPartInSum\>\""}],
          "]"}]}], "]"}], "/;", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"theMethod", ",", "\"\<CoordinateFree\>\""}], "]"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", "_"}], "]"}], ":=", "False"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testOptionExpOfMV", "[", 
      RowBox[{"\"\<Quiet\>\"", ",", "val_"}], "]"}], ":=", 
     RowBox[{"BooleanQ", "[", "val", "]"}]}], ";"}]}]}]], "Input",ExpressionUU\
ID->"0246d1e0-d3e6-410d-886b-dd403c8fd64e"],

Cell[TextData[{
 "Definitions for \[OpenCurlyDoubleQuote]gaMatrixRepresentation\
\[CloseCurlyDoubleQuote] method as well as for \
functionOfMVMinimalPolynomialImplicit[] are given along with ",
 StyleBox["gaFunctionOfMV[ ]",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"6649661c-a62f-4bc1-b940-2861cbdce1ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaExpOfMV", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", "gaExpOfMV", "}"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theOption", ",", 
       RowBox[{"theAlgebra", "=", 
        RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], ",", "theMethod", ",", 
       "theFormula"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"gaSetNamedOptionValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"gaExpOfMV", ",", "#", ",", "theOption"}], "}"}], ",", 
          RowBox[{
           RowBox[{"gaOptionCheck", "[", "testOptionExpOfMV", "]"}], "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "#", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"s_Symbol", ",", "y___Rule"}], "}"}], ":>", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ToString", "[", "s", "]"}], ",", "y"}], "}"}]}], 
              "}"}]}], ")"}], "]"}], ",", 
          RowBox[{"Quiet", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
         "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Flatten", "[", 
         RowBox[{"First", "/@", 
          RowBox[{"(", 
           RowBox[{"{", "opts", "}"}], ")"}]}], "]"}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "if", " ", "main", " ", "options", " ", "obtained", " ", 
        "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"theOption", "[", "\"\<Method\>\"", "]"}], "]"}], "===", 
         "theOption"}], ",", 
        RowBox[{
         RowBox[{"theOption", "[", "\"\<Method\>\"", "]"}], "=", 
         "\"\<Automatic\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"theOption", "[", "\"\<gaFormula\>\"", "]"}], "]"}], "===", 
         "theOption"}], ",", 
        RowBox[{
         RowBox[{"theOption", "[", "\"\<gaFormula\>\"", "]"}], "=", 
         "\"\<Automatic\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], "]"}], "===", 
         "theOption"}], ",", 
        RowBox[{
         RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], "=", 
         RowBox[{"(", 
          RowBox[{"Quiet", "/.", 
           RowBox[{"Options", "[", "gaExpOfMV", "]"}]}], ")"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"theOption", "[", "\"\<Method\>\"", "]"}], ",", 
          RowBox[{"\"\<Automatic\>\"", "|", "Automatic", "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Automatic\>\"", "|", "Automatic"}], ",", 
             "___Rule"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"theMethod", "=", "\"\<CoordinateFree\>\""}], ",", 
        RowBox[{"theMethod", "=", 
         RowBox[{"theOption", "[", "\"\<Method\>\"", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"set", " ", "gaFormula", " ", 
         RowBox[{"option", ":", " ", 
          RowBox[{
           RowBox[{"if", " ", "dimension"}], " ", ">", 
           RowBox[{
           "3", " ", "or", " ", "Method", " ", "set", " ", "to", " ", 
            "Coordinate"}]}]}]}], ",", " ", 
        RowBox[{
        "which", " ", "is", " ", "not", " ", "implemented", " ", "directly", 
         " ", "for", " ", "low", " ", "dim"}], ",", " ", 
        RowBox[{"use", " ", "gaFunctionOfMV"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gaDimensionOfVectorSpace", "[", "theAlgebra", "]"}], ">", 
         "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaExpOfMV", "::", "lowDimensionFormula"}], ",", 
           RowBox[{"gaDimensionOfVectorSpace", "[", "theAlgebra", "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"theFormula", "=", "\"\<ScalarPartInSum\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"theOption", "[", "\"\<gaFormula\>\"", "]"}], ",", 
             RowBox[{"\"\<Automatic\>\"", "|", "Automatic"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Switch", "[", 
            RowBox[{"theMethod", ",", "\"\<CoordinateFree\>\"", ",", 
             RowBox[{"theFormula", "=", "\"\<LowDimension\>\""}], ",", 
             "\[IndentingNewLine]", "\"\<gaMatrixRepresentation\>\"", ",", 
             RowBox[{"theFormula", "=", "\"\<\>\""}], ",", 
             "\[IndentingNewLine]", "_", ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"gaVerify", "::", "missing"}], ",", "theMethod", ",", 
               "gaExpOfMV"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"theMethod", "===", "\"\<CoordinateFree\>\""}], ",", 
             RowBox[{"theFormula", "=", 
              RowBox[{"theOption", "[", "\"\<gaFormula\>\"", "]"}]}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"gaVerify", "::", "missing"}], ",", "theMethod", ",", 
               "gaExpOfMV"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Information", " ", "about", " ", "option", " ", "handling"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"printDetails", "[", 
       RowBox[{
        RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Method is\>\"", ",", "theMethod"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Formula is set to \>\"", ",", "theFormula"}], "}"}]}],
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "only", " ", "available", " ", "method", " ", "log", " ", 
        "is", " ", "\"\<CoordinateFree\>\"", " ", "if", " ", "gaFunctionOfMV",
         " ", "is", " ", "used"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "theMethod", ",", "\"\<CoordinateFree\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "theFormula", ",", "\"\<LowDimension\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"expOfMV", "[", 
           RowBox[{"expr", ",", "theMethod", ",", "theFormula", ",", 
            RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}]}], "]"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<ScalarPartInSum\>\"", "|", "\"\<ScalarPartOutOfSum\>\""}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"printDetails", "[", 
            RowBox[{
             RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Call to gaFunctionOfMV[Log,MV]! More control is available \
using options for that function.\>\"", ",", "\"\<\>\""}], "}"}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"functionOfMVMinimalPolynomialImplicit", "[", 
            RowBox[{"Exp", ",", 
             RowBox[{"gaPE", "[", "expr", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Expand", "[", 
                  RowBox[{"gaPE", "[", "#", "]"}], "]"}], "&"}], ")"}]}], 
              "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "\"\<gaMatrixRepresentation\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"expOfMV", "[", 
         RowBox[{"expr", ",", "\"\<gaMatrixRepresentation\>\"", ",", 
          RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"gaVerify", "::", "missing"}], ",", "theMethod", ",", 
           "gaLogOfMV"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",ExpressionUUID->"836385f4-\
47a8-4970-80a3-2929e9664092"],

Cell[TextData[{
 "Help functions",
 StyleBox[" positiveQ[]",
  FontWeight->"Bold"],
 ", ",
 StyleBox["zeroQ[]",
  FontWeight->"Bold"],
 ",",
 StyleBox["nonNegativeQ[]",
  FontWeight->"Bold"],
 ",",
 StyleBox["nonzeroQ[]",
  FontWeight->"Bold"],
 " are defined in \[OpenCurlyDoubleQuote]Square root of MV\
\[CloseCurlyDoubleQuote] section"
}], "Text",ExpressionUUID->"ae08dbc5-b6e3-4517-8d1a-c74e67f50a71"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cl(1,0) case", "Item",ExpressionUUID->"aa0ff08b-216b-4964-a6db-4f254fc6b5f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expOfMV", "[", 
   RowBox[{
   "expr_", ",", "\"\<CoordinateFree\>\"", ",", "\"\<LowDimension\>\"", ",", 
    "quiet_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
       RowBox[{"aVB", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ",", "q2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q2", "=", 
       RowBox[{"-", 
        RowBox[{"gaPE", "[", 
         RowBox[{"aVB", "\[GeometricProduct]", 
          RowBox[{"gaCliffordConjugate", "[", "aVB", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"printDetails", "[", 
             RowBox[{"quiet", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2=0\>\""}], "}"}], 
               "}"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"Exp", "[", "a0", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "aVB"}], ")"}]}]}], ",", 
           RowBox[{"(", 
            RowBox[{"zeroQ", "[", "q2", "]"}], ")"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"printDetails", "[", 
             RowBox[{"quiet", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2>0\>\""}], "}"}], 
               "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Exp", "[", "a0", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cosh", "[", 
                RowBox[{"Sqrt", "[", "q2", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"aVB", "/", 
                  RowBox[{"Sqrt", "[", "q2", "]"}]}], ")"}], 
                RowBox[{"Sinh", "[", 
                 RowBox[{"Sqrt", "[", "q2", "]"}], "]"}]}]}], ")"}]}]}], ",", 
           
           RowBox[{"positiveQ", "[", "q2", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "/;", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cl", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]], "Input",Express\
ionUUID->"24950d0b-a519-493c-9c2a-cab2c7432441"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,1) case", "Item",ExpressionUUID->"5fa525a2-aa8b-416e-9e5e-ea2e5cee6316"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expOfMV", "[", 
   RowBox[{
   "expr_", ",", "\"\<CoordinateFree\>\"", ",", "\"\<LowDimension\>\"", ",", 
    "quiet_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
       RowBox[{"aVB", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ",", "q2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q2", "=", 
       RowBox[{"-", 
        RowBox[{"gaPE", "[", 
         RowBox[{"aVB", "\[GeometricProduct]", 
          RowBox[{"gaCliffordConjugate", "[", "aVB", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"printDetails", "[", 
             RowBox[{"quiet", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2=0\>\""}], "}"}], 
               "}"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"Exp", "[", "a0", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "aVB"}], ")"}]}]}], ",", 
           RowBox[{"(", 
            RowBox[{"zeroQ", "[", "q2", "]"}], ")"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"printDetails", "[", 
             RowBox[{"quiet", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2<0\>\""}], "}"}], 
               "}"}]}], "]"}], ";", 
            RowBox[{
             RowBox[{"Exp", "[", "a0", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"-", "q2"}], "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"aVB", "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", "q2"}], "]"}]}], ")"}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"-", "q2"}], "]"}], "]"}]}]}], ")"}]}]}], ",", 
           RowBox[{"negativeQ", "[", "q2", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
    "/;", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cl", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]], "Input",Express\
ionUUID->"223212f9-7481-4fd8-b8a6-5b5bed209380"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,0) and Cl(1,1) cases", "Item",ExpressionUUID->"98c2ccb4-6c0e-4edc-94be-4c16fea74786"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expOfMV", "[", 
   RowBox[{
   "expr_", ",", "\"\<CoordinateFree\>\"", ",", "\"\<LowDimension\>\"", ",", 
    "quiet_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
       RowBox[{"aVB", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "q2"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q2", "=", 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"gaPE", "[", 
          RowBox[{"aVB", "\[GeometricProduct]", 
           RowBox[{"gaCliffordConjugate", "[", "aVB", "]"}]}], "]"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"printDetails", "[", 
       RowBox[{"quiet", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
          "\"\<q2=gaNorm2CliffordConjugateSigned[gaGetMV[expr,{1,2}]] \>\"", 
           ",", "q2"}], "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"printDetails", "[", 
              RowBox[{"quiet", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2<0\>\""}], "}"}], 
                "}"}]}], "]"}], ";", 
             RowBox[{
              RowBox[{"Exp", "[", "a0", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"-", "q2"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"aVB", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "q2"}], "]"}]}], ")"}], 
                 RowBox[{"Sin", "[", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", "q2"}], "]"}], "]"}]}]}], ")"}]}]}], ",", 
            RowBox[{"negativeQ", "[", "q2", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"printDetails", "[", 
              RowBox[{"quiet", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2=0\>\""}], "}"}], 
                "}"}]}], "]"}], ";", 
             RowBox[{
              RowBox[{"Exp", "[", "a0", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "aVB"}], ")"}]}]}], ",", 
            RowBox[{"(", 
             RowBox[{"zeroQ", "[", "q2", "]"}], ")"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"printDetails", "[", 
              RowBox[{"quiet", ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<Piecewise: \>\"", ",", "\"\<q2>0\>\""}], "}"}], 
                "}"}]}], "]"}], ";", 
             RowBox[{
              RowBox[{"Exp", "[", "a0", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cosh", "[", 
                 RowBox[{"Sqrt", "[", "q2", "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"aVB", "/", 
                   RowBox[{"Sqrt", "[", "q2", "]"}]}], ")"}], 
                 RowBox[{"Sinh", "[", 
                  RowBox[{"Sqrt", "[", "q2", "]"}], "]"}]}]}], ")"}]}]}], ",", 
            RowBox[{"positiveQ", "[", "q2", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "$Failed"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cl", "[", 
        RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
       RowBox[{"Cl", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "}"}], ",", 
     RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]], "Input",Express\
ionUUID->"dc981f8f-ec96-4a24-9d0e-53b866c7baa1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,2) case", "Item",ExpressionUUID->"128eed3f-cf72-4dae-a0b6-476ab8e12364"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expOfMV", "[", 
   RowBox[{
   "expr_", ",", "\"\<CoordinateFree\>\"", ",", "\"\<LowDimension\>\"", ",", 
    "quiet_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], ",", 
       RowBox[{"aVB", "=", 
        RowBox[{"gaGetMV", "[", 
         RowBox[{"expr", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "q2"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q2", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"gaPE", "[", 
         RowBox[{"aVB", "\[GeometricProduct]", 
          RowBox[{"gaCliffordConjugate", "[", "aVB", "]"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"printDetails", "[", 
       RowBox[{"quiet", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
          "\"\<q2=gaNorm2CliffordConjugateSigned[gaGetMV[expr,{1,2}]] \>\"", 
           ",", "q2"}], "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", "a0", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", "q2", "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"aVB", "/", "q2"}], ")"}], 
                RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"!", 
             RowBox[{"zeroQ", "[", "q2", "]"}]}]}], "\[IndentingNewLine]", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", "a0", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"zeroQ", "[", "q2", "]"}]}], "\[IndentingNewLine]", 
           "}"}]}], "\[IndentingNewLine]", "}"}], ",", "$Failed"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cl", "[", 
       RowBox[{"0", ",", "2", ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]], "Input",Express\
ionUUID->"5b754e05-cfff-4828-a6c0-8b8f176e9837"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(3,0) case", "Item",ExpressionUUID->"e416b0a1-8d5f-458c-b894-546100422f99"],

Cell["\<\
Algorithm which outputs real coefficients. Expressed in very powerful \
Piecewise form.\
\>", "Text",ExpressionUUID->"da0ccb85-6d26-489b-aa28-5262bc398992"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bs", "=", 
      RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], ",", 
     RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expOfMV", "[", 
     RowBox[{
     "expr_", ",", "\"\<Coordinate\>\"", ",", "\"\<LowDimension\>\"", ",", 
      "quiet_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"theAlg", "=", 
          RowBox[{"Cl", "[", 
           RowBox[{"3", ",", "0", ",", "0"}], "]"}]}], ",", "aRules", ",", 
         "cfsRules", ",", "coef", ",", "a", ",", "b", ",", 
         RowBox[{"vecBivect", "=", 
          RowBox[{"gaGetMV", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "vBIP", ",", 
         "vBOPI", ",", "v", ",", "vC", ",", "sC", ",", "sS", ",", 
         "vVRulesGeneric", ",", "vVRules", ",", "genMVb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aRules", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"a", ",", "theAlg", ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], "-", 
                    RowBox[{"gaPE", "[", "expr", "]"}]}], ",", "_bs", ",", 
                   "coef"}], "]"}], ",", "_coef", ",", "Infinity"}], "]"}], "/.", 
               RowBox[{"coef", "\[Rule]", "Identity"}]}], ")"}], "==", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], ",", 
              RowBox[{"a", "[", "1", "]"}], ",", 
              RowBox[{"a", "[", "2", "]"}], ",", 
              RowBox[{"a", "[", "3", "]"}], ",", 
              RowBox[{"a", "[", "4", "]"}], ",", 
              RowBox[{"a", "[", "5", "]"}], ",", 
              RowBox[{"a", "[", "6", "]"}], ",", 
              RowBox[{"a", "[", "7", "]"}]}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vBIP", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{"vecBivect", "\[InnerProduct]", "vecBivect"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"vBOPI", "=", 
         RowBox[{"-", 
          RowBox[{"gaPE", "[", 
           RowBox[{
            RowBox[{"vecBivect", "\[OuterProduct]", "vecBivect"}], 
            "\[GeometricProduct]", 
            RowBox[{"gaI", "[", "theAlg", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"printDetails", "[", 
         RowBox[{"quiet", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<vBIP=v.v+B.B= \>\"", ",", "vBIP"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<vBOPI=-v\[OuterProduct]B*I= \>\"", ",", "vBOPI"}], 
             "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "introduce", " ", "formal", " ", "vars", " ", "sS", " ", "and", " ",
            "sC"}], ",", " ", 
          RowBox[{"since", " ", "denominator", " ", "can", " ", "vanish"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vVRulesGeneric", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "->", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sS", "+", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"sS", "^", "2"}], "+", 
                 RowBox[{"sC", "^", "2"}]}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"sS", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"sS", "^", "2"}], "+", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
              ")"}]}]}], ",", 
           RowBox[{"vC", "->", 
            RowBox[{"sC", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"sS", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"sS", "^", "2"}], "+", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
              ")"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cfsRules", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"non", " ", "zero", " ", "case"}], ",", " ", 
              RowBox[{"scalar", " ", "+", " ", "pseudovector"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "->", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"Cosh", "[", "v", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "7", "]"}], "->", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"Cosh", "[", "v", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"vector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "-", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"bivector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "4", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "vC"}], " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "5", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Cosh", "[", "v", "]"}]}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "-", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "6", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "vC"}], " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}]}], 
            "\[IndentingNewLine]", "}"}], "/.", "aRules"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"genMVb", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"b", ",", "theAlg"}], "]"}], "/.", "cfsRules"}], ")"}], "/.",
           "aRules"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI\[NotEqual]0\>\""}], 
                  "}"}], "}"}]}], "]"}], ";", 
              RowBox[{"vVRules", "=", 
               RowBox[{"(", 
                RowBox[{"vVRulesGeneric", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sS", "\[Rule]", "vBIP"}], ",", 
                   RowBox[{"sC", "->", "vBOPI"}]}], "}"}]}], ")"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"!", 
              RowBox[{"zeroQ", "[", "vBOPI", "]"}]}]}], "\[IndentingNewLine]",
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP>0\>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", 
                  RowBox[{"Sqrt", "[", "vBIP", "]"}]}], ",", 
                 RowBox[{"vC", "\[Rule]", "0"}]}], "}"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"positiveQ", "[", "vBIP", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP<0\>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", "0"}], ",", 
                 RowBox[{"vC", "->", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", "vBIP"}], "]"}]}]}], "}"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"negativeQ", "[", "vBIP", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP=0\>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", "0"}], ",", 
                 RowBox[{"vC", "->", "0"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Expand", "[", 
               RowBox[{"gaPE", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"b", ",", "theAlg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "]"}], "/.", 
                    "cfsRules"}], ")"}], "/.", "aRules"}], ")"}], "/.", 
                   "vVRules"}], ")"}], "\[GeometricProduct]", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "vecBivect"}], ")"}]}], "]"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"zeroQ", "[", "vBIP", "]"}]}]}], "\[IndentingNewLine]", 
            "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cl", "[", 
         RowBox[{"3", ",", "0", ",", "0"}], "]"}], "}"}], ",", 
       RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[599]:=",ExpressionUUID->"aeafc18d-9e18-4cd5-ba7d-1d04dccb82b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(2,1) case", "Item",ExpressionUUID->"ab81da40-c148-4f32-8c7b-0d7ee59a6b76"],

Cell["\<\
Algorithm which outputs real coefficients. Note that expressions under square \
root for cl(2,1) algebra can be negative, therefore a correct way is to \
replace them by positive with modified functions. \
\>", "Text",ExpressionUUID->"f7cfc027-c1fd-4235-9cb8-d64301bb0b14"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bs", "=", 
      RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], ",", 
     RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expOfMV", "[", 
     RowBox[{
     "expr_", ",", "\"\<Coordinate\>\"", ",", "\"\<LowDimension\>\"", ",", 
      "quiet_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"theAlg", "=", 
          RowBox[{"Cl", "[", 
           RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ",", "aRules", ",", 
         "cfsRules", ",", "coef", ",", "a", ",", "b", ",", 
         RowBox[{"vecBivect", "=", 
          RowBox[{"gaGetMV", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "vBIP", ",", 
         "vBOPI", ",", "mvIPpOP", ",", "mvIPmOP", ",", "mvIPpOP0", ",", 
         "mvIPmOP0", ",", "funcRules", ",", "vVRules", ",", "genMVb", ",", 
         "fLimit"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aRules", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"a", ",", "theAlg", ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], "-", 
                    RowBox[{"gaPE", "[", "expr", "]"}]}], ",", "_bs", ",", 
                   "coef"}], "]"}], ",", "_coef", ",", "Infinity"}], "]"}], "/.", 
               RowBox[{"coef", "\[Rule]", "Identity"}]}], ")"}], "==", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], ",", 
              RowBox[{"a", "[", "1", "]"}], ",", 
              RowBox[{"a", "[", "2", "]"}], ",", 
              RowBox[{"a", "[", "3", "]"}], ",", 
              RowBox[{"a", "[", "4", "]"}], ",", 
              RowBox[{"a", "[", "5", "]"}], ",", 
              RowBox[{"a", "[", "6", "]"}], ",", 
              RowBox[{"a", "[", "7", "]"}]}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"vBIP", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{"vecBivect", "\[InnerProduct]", "vecBivect"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"vBOPI", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{
           RowBox[{"vecBivect", "\[OuterProduct]", "vecBivect"}], 
           "\[GeometricProduct]", 
           RowBox[{"gaI", "[", "theAlg", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mvIPpOP", "=", 
         RowBox[{"vBIP", "+", "vBOPI"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mvIPmOP", "=", 
         RowBox[{"vBIP", "-", "vBOPI"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"printDetails", "[", 
         RowBox[{"quiet", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<vBIP=v.v+B.B= \>\"", ",", "vBIP"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<vBOPI=v\[OuterProduct]B*I= \>\"", ",", "vBOPI"}], 
             "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "introduce", " ", "formal", " ", "vars", " ", "mvIPpOP0", " ", 
           "and", " ", "mvIPmOP0"}], ",", " ", 
          RowBox[{"since", " ", "denominator", " ", "can", " ", 
           RowBox[{"vanish", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cfsRules", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"non", " ", "zero", " ", "case"}], ",", " ", 
              RowBox[{"scalar", " ", "+", " ", "pseudovector"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"Cosh", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"Cosh", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "7", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"Cosh", "[", "mvIPpOP0", "]"}]}], " ", "-", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"Cosh", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"vector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "+", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "-", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "-", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "+", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "-", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "+", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"bivector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "4", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "-", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "+", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "5", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "-", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "+", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "6", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "+", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                    "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "-", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"fLimit", "[", 
                   RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                    "]"}]}]}], ")"}]}]}]}], "}"}], "/.", "aRules"}], ")"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"genMVb", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"b", ",", "theAlg"}], "]"}], "/.", "cfsRules"}], ")"}], "/.",
           "aRules"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "both", " ", "mvIPmOP0", " ", "and", " ", "mvIPpOP0", " ", 
            "nonzero"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI>0 && vBIP-vBOPI>0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                 RowBox[{"mvIPmOP0", "\[Rule]", 
                  RowBox[{"Sqrt", "[", "mvIPmOP", "]"}]}], ",", 
                 RowBox[{"mvIPpOP0", "->", 
                  RowBox[{"Sqrt", "[", "mvIPpOP", "]"}]}]}], "}"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI>0 && vBIP-vBOPI<0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPmOP0", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPpOP", "]"}]}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPmOP"}], "]"}]}]}], "}"}]}], ")"}], ";", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI<0 && vBIP-vBOPI>0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPpOP0", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPpOP"}], "]"}]}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPmOP", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI<0 && vBIP-vBOPI<0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPmOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPpOP0", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPpOP"}], "]"}]}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPmOP"}], "]"}]}]}], "}"}]}], ")"}], ";", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "either", " ", "mvIPmOP0", " ", "or", " ", "mvIPpOP0", " ", "is", 
             " ", "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI>0 && vBIP-vBOPI=0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fLimit", "[", 
                    RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                     "]"}], "\[Rule]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", "1"}]}],
                  "}"}]}], ")"}], ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPpOP", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI<0 && vBIP-vBOPI=0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fLimit", "[", 
                    RowBox[{
                    RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "/", "mvIPmOP0"}],
                     "]"}], "\[Rule]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", "1"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPpOP0", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPpOP"}], "]"}]}]}], "}"}]}], ")"}], ";", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI=0 && vBIP-vBOPI>0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fLimit", "[", 
                    RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                     "]"}], "\[Rule]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", "1"}]}],
                  "}"}]}], ")"}], ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPmOP", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"positiveQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI=0 && vBIP-vBOPI<0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fLimit", "[", 
                    RowBox[{
                    RowBox[{"Sinh", "[", "mvIPpOP0", "]"}], "/", "mvIPpOP0"}],
                     "]"}], "\[Rule]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", "1"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"Sinh", "[", "mvIPmOP0", "]"}], "->", 
                   RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", 
                   RowBox[{"Cos", "[", "mvIPmOP0", "]"}]}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"-", "mvIPmOP"}], "]"}]}]}], "}"}]}], ")"}], ";", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"genMVb", "/.", "funcRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"negativeQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI=0 && vBIP-vBOPI=0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"funcRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPpOP0", "]"}], "\[Rule]", "1"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"Cosh", "[", "mvIPmOP0", "]"}], "\[Rule]", "1"}]}],
                  "}"}]}], ")"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fLimit", "\[Rule]", "Identity"}], ",", 
                  RowBox[{"mvIPmOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPmOP", "]"}]}], ",", 
                  RowBox[{"mvIPpOP0", "\[Rule]", 
                   RowBox[{"Sqrt", "[", "mvIPpOP", "]"}]}]}], "}"}]}], ")"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"b", ",", "theAlg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "]"}], "/.", 
                    "cfsRules"}], ")"}], "/.", "aRules"}], ")"}], "/.", 
                 "funcRules"}], ")"}], "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cl", "[", 
         RowBox[{"2", ",", "1", ",", "0"}], "]"}], "}"}], ",", 
       RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[601]:=",ExpressionUUID->"9eebbd76-ec49-4b3d-877b-294387587a31"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(1,2) case", "Item",ExpressionUUID->"319ebe84-125c-4890-a66f-8ebc95dfe8ec"],

Cell["\<\
Algorithm which outputs real coefficients. Direct implementation\
\>", "Text",ExpressionUUID->"467db570-c86f-4037-8b3e-fbd04850ea93"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bs", "=", 
      RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], ",", 
     RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expOfMV", "[", 
     RowBox[{
     "expr_", ",", "\"\<Coordinate\>\"", ",", "\"\<LowDimension\>\"", ",", 
      "quiet_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"theAlg", "=", 
          RowBox[{"Cl", "[", 
           RowBox[{"1", ",", "2", ",", "0"}], "]"}]}], ",", "aRules", ",", 
         "cfsRules", ",", "coef", ",", "a", ",", "b", ",", 
         RowBox[{"vecBivect", "=", 
          RowBox[{"gaGetMV", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "vBIP", ",", 
         "vBOPI", ",", "v", ",", "vC", ",", "sC", ",", "sS", ",", 
         "vVRulesGeneric", ",", "vVRules", ",", "genMVb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aRules", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"a", ",", "theAlg", ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], "-", 
                    RowBox[{"gaPE", "[", "expr", "]"}]}], ",", "_bs", ",", 
                   "coef"}], "]"}], ",", "_coef", ",", "Infinity"}], "]"}], "/.", 
               RowBox[{"coef", "\[Rule]", "Identity"}]}], ")"}], "==", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], ",", 
              RowBox[{"a", "[", "1", "]"}], ",", 
              RowBox[{"a", "[", "2", "]"}], ",", 
              RowBox[{"a", "[", "3", "]"}], ",", 
              RowBox[{"a", "[", "4", "]"}], ",", 
              RowBox[{"a", "[", "5", "]"}], ",", 
              RowBox[{"a", "[", "6", "]"}], ",", 
              RowBox[{"a", "[", "7", "]"}]}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"vBIP", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{"vecBivect", "\[InnerProduct]", "vecBivect"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"vBOPI", "=", 
         RowBox[{"-", 
          RowBox[{"gaPE", "[", 
           RowBox[{
            RowBox[{"vecBivect", "\[OuterProduct]", "vecBivect"}], 
            "\[GeometricProduct]", 
            RowBox[{"gaI", "[", "theAlg", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"printDetails", "[", 
         RowBox[{"quiet", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<vBIP=v.v+B.B= \>\"", ",", "vBIP"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<vBOPI=-v^B*I= \>\"", ",", "vBOPI"}], "}"}]}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "introduce", " ", "formal", " ", "vars", " ", "sS", " ", "and", " ",
            "sC"}], ",", " ", 
          RowBox[{"since", " ", "denominator", " ", "can", " ", "vanish"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vVRulesGeneric", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "->", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sS", "+", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"sS", "^", "2"}], "+", 
                 RowBox[{"sC", "^", "2"}]}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"sS", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"sS", "^", "2"}], "+", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
              ")"}]}]}], ",", 
           RowBox[{"vC", "->", 
            RowBox[{"sC", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"sS", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"sS", "^", "2"}], "+", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
              ")"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cfsRules", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"non", " ", "zero", " ", "case"}], ",", " ", 
              RowBox[{"scalar", " ", "+", " ", "pseudovector"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "->", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"Cosh", "[", "v", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "7", "]"}], "->", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"Cosh", "[", "v", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"vector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Cosh", "[", "v", "]"}]}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "vC"}], " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "-", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"bivector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "4", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"a", "[", "3", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "4", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "5", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "vC"}], " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "2", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "5", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "6", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"a", "[", "0", "]"}], "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"v", "^", "2"}], "+", 
                   RowBox[{"vC", "^", "2"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cosh", "[", "v", "]"}], " ", 
                  RowBox[{"Sin", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "-", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vC", "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "vC"}], " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v", " ", 
                    RowBox[{"a", "[", "1", "]"}]}], "+", 
                    RowBox[{"vC", " ", 
                    RowBox[{"a", "[", "6", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"Sinh", "[", "v", "]"}]}]}], ")"}]}]}]}], 
            "\[IndentingNewLine]", "}"}], "/.", "aRules"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"genMVb", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"b", ",", "theAlg"}], "]"}], "/.", "cfsRules"}], ")"}], "/.",
           "aRules"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI\[NotEqual]0\>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"(", 
                RowBox[{"vVRulesGeneric", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sS", "\[Rule]", "vBIP"}], ",", 
                   RowBox[{"sC", "->", "vBOPI"}]}], "}"}]}], ")"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"!", 
              RowBox[{"zeroQ", "[", "vBOPI", "]"}]}]}], "\[IndentingNewLine]",
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP>0 \>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", 
                  RowBox[{"Sqrt", "[", "vBIP", "]"}]}], ",", 
                 RowBox[{"vC", "\[Rule]", "0"}]}], "}"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"positiveQ", "[", "vBIP", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP<0 \>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", "0"}], ",", 
                 RowBox[{"vC", "->", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"-", "vBIP"}], "]"}]}]}], "}"}]}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"negativeQ", "[", "vBIP", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", "\"\<vBOPI=0 && vBIP=0 \>\""}], 
                  "}"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vVRules", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "\[Rule]", "0"}], ",", 
                 RowBox[{"vC", "->", "0"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"b", ",", "theAlg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "]"}], "/.", 
                    "cfsRules"}], ")"}], "/.", "aRules"}], ")"}], "/.", 
                 "vVRules"}], ")"}], "\[GeometricProduct]", 
               RowBox[{"(", 
                RowBox[{"1", "+", "vecBivect"}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zeroQ", "[", "vBOPI", "]"}], "&&", 
              RowBox[{"zeroQ", "[", "vBIP", "]"}]}]}], "\[IndentingNewLine]", 
            "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cl", "[", 
         RowBox[{"1", ",", "2", ",", "0"}], "]"}], "}"}], ",", 
       RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[603]:=",ExpressionUUID->"4d603e32-6208-4110-8b3b-66e0527f36d9"],

Cell["Coordinate free formula is the same as for Cl(3,0)", "Text",ExpressionUUID->"8d3023e7-973e-446c-84b4-c22a50b581c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cl(0,3) case", "Item",ExpressionUUID->"61029f99-4e2c-4d35-9a60-2d459fa78b5d"],

Cell["\<\
Algorithm which outputs real coefficients. Expressed in very powerful \
Piecewise form.\
\>", "Text",ExpressionUUID->"38b973d0-b067-4651-9363-a728a4882681"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bs", "=", 
      RowBox[{"Symbol", "[", "orthonormalBasisSymbolName", "]"}]}], ",", 
     RowBox[{"requireOrdering", "=", "\"\<InvDeg[Lex]\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expOfMV", "[", 
     RowBox[{
     "expr_", ",", "\"\<Coordinate\>\"", ",", "\"\<LowDimension\>\"", ",", 
      "quiet_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"theAlg", "=", 
          RowBox[{"Cl", "[", 
           RowBox[{"0", ",", "3", ",", "0"}], "]"}]}], ",", "aRules", ",", 
         "cfsRules", ",", "coef", ",", "a", ",", "b", ",", 
         RowBox[{"vecBivect", "=", 
          RowBox[{"gaGetMV", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", "vBIP", ",", 
         "vBOPI", ",", "mvIPpOP", ",", "mvIPmOP", ",", "mvIPpOP0", ",", 
         "mvIPmOP0", ",", "vVRules", ",", "genMVb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aRules", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"a", ",", "theAlg", ",", 
                    RowBox[{
                    "gaNonCommutativeMonomialOrder", "\[Rule]", 
                    "requireOrdering"}]}], "]"}], "-", 
                    RowBox[{"gaPE", "[", "expr", "]"}]}], ",", "_bs", ",", 
                   "coef"}], "]"}], ",", "_coef", ",", "Infinity"}], "]"}], "/.", 
               RowBox[{"coef", "\[Rule]", "Identity"}]}], ")"}], "==", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], ",", 
              RowBox[{"a", "[", "1", "]"}], ",", 
              RowBox[{"a", "[", "2", "]"}], ",", 
              RowBox[{"a", "[", "3", "]"}], ",", 
              RowBox[{"a", "[", "4", "]"}], ",", 
              RowBox[{"a", "[", "5", "]"}], ",", 
              RowBox[{"a", "[", "6", "]"}], ",", 
              RowBox[{"a", "[", "7", "]"}]}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vBIP", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{"vecBivect", "\[InnerProduct]", "vecBivect"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"vBOPI", "=", 
         RowBox[{"gaPE", "[", 
          RowBox[{
           RowBox[{"vecBivect", "\[OuterProduct]", "vecBivect"}], 
           "\[GeometricProduct]", 
           RowBox[{"gaI", "[", "theAlg", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"printDetails", "[", 
         RowBox[{"quiet", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<vBIP=v.v+B.B= \>\"", ",", "vBIP"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<vBOPI=v\[OuterProduct]B*I= \>\"", ",", "vBOPI"}], 
             "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mvIPpOP", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"vBIP", "+", "vBOPI"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mvIPmOP", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"vBIP", "-", "vBOPI"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "introduce", " ", "formal", " ", "vars", " ", "sS", " ", "and", " ",
            "sC"}], ",", " ", 
          RowBox[{
           RowBox[{"since", " ", "denominator", " ", "can", " ", 
            RowBox[{"vanish", ".", " ", "These"}], " ", "are", " ", "sqrt", 
            " ", "of", " ", "s"}], "+", 
           RowBox[{
           "SI", " ", "and", " ", "plays", " ", "an", " ", "important", " ", 
            "role"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vVRulesGeneric", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"sS", "+", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"sS", "^", "2"}], "-", 
                   RowBox[{"sC", "^", "2"}]}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"sS", "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"sS", "^", "2"}], "-", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
                ")"}]}]}], ",", 
             RowBox[{"vC", "->", 
              RowBox[{"sC", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "2", "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"sS", "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"sS", "^", "2"}], "-", 
                    RowBox[{"sC", "^", "2"}]}], "]"}]}], "]"}], ")"}]}], 
                ")"}]}]}]}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"cfsRules", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"non", " ", "zero", " ", "case"}], ",", " ", 
              RowBox[{"scalar", " ", "+", " ", "pseudovector"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"Cos", "[", "mvIPpOP", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"Cos", "[", "mvIPmOP", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "7", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"a", "[", "7", "]"}], "]"}], "*", 
                  RowBox[{"Cos", "[", "mvIPpOP", "]"}]}], " ", "-", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "*", 
                  RowBox[{"Cos", "[", "mvIPmOP", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"vector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "-", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "+", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "2", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "+", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "-", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "3", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "-", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "+", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"bivector", " ", "components"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "4", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                    ")"}]}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "-", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "3", "]"}], "+", 
                    RowBox[{"a", "[", "4", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "5", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "+", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "2", "]"}], "-", 
                    RowBox[{"a", "[", "5", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"b", "[", "6", "]"}], "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"a", "[", "0", "]"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"a", "[", "7", "]"}], "]"}], "/", "mvIPpOP0"}], 
                    ")"}]}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "-", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPpOP0", "]"}]}], " ", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{"a", "[", "7", "]"}]}], "]"}], "/", "mvIPmOP0"}], 
                   ")"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", "1", "]"}], "+", 
                    RowBox[{"a", "[", "6", "]"}]}], ")"}], "*", 
                  RowBox[{"Sin", "[", "mvIPmOP0", "]"}]}]}], ")"}]}]}]}], 
            "}"}], "/.", "aRules"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"genMVb", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gaGeneralMultivector", "[", 
             RowBox[{"b", ",", "theAlg"}], "]"}], "/.", "cfsRules"}], ")"}], "/.",
           "aRules"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI\[NotEqual]0 && \
vBIP-vBOPI\[NotEqual]0\>\""}], "}"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mvIPmOP0", "\[Rule]", "mvIPmOP"}], ",", 
                  RowBox[{"mvIPpOP0", "->", "mvIPpOP"}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"(", 
                  RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"(", 
                  RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}]}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI\[NotEqual]0 && vBIP-vBOPI=0\>\""}], "}"}], 
                 "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sin", "[", "mvIPmOP0", "]"}], "\[Rule]", "0"}], 
                  ",", 
                  RowBox[{"mvIPpOP0", "->", "mvIPpOP"}]}], "}"}]}], ")"}], 
              ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"(", 
                  RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI=0 && vBIP-vBOPI\[NotEqual]0\>\""}], "}"}], 
                 "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mvIPmOP0", "->", "mvIPmOP"}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "mvIPpOP0", "]"}], "\[Rule]", "0"}]}], 
                 "}"}]}], ")"}], ";", 
              RowBox[{"genMVb", "/.", "vVRules"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"zeroQ", "[", 
                 RowBox[{"(", 
                  RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}]}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"printDetails", "[", 
               RowBox[{"quiet", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Piecewise: \>\"", ",", 
                   "\"\<vBIP+vBOPI=0 && vBIP-vBOPI=0\>\""}], "}"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"vVRules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mvIPmOP0", "\[Rule]", "mvIPmOP"}], ",", 
                  RowBox[{"mvIPpOP0", "->", "mvIPpOP"}]}], "}"}]}], ")"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"gaGeneralMultivector", "[", 
                    RowBox[{"b", ",", "theAlg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "]"}], "/.", 
                   "cfsRules"}], ")"}], "/.", "aRules"}], ")"}], "/.", 
               "vVRules"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "+", "vBOPI"}], ")"}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"zeroQ", "[", 
                RowBox[{"(", 
                 RowBox[{"vBIP", "-", "vBOPI"}], ")"}], "]"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Cl", "[", 
         RowBox[{"0", ",", "3", ",", "0"}], "]"}], "}"}], ",", 
       RowBox[{"gaGetAlgebra", "[", "expr", "]"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[604]:=",ExpressionUUID->"ea45a2f6-e678-47b5-99e4-c2315ef35f56"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Methods, which uses characteristic polynomial and matrix representations \
\>", "Item",ExpressionUUID->"4aacd167-15b7-4827-9f95-ea5731daaaa9"],

Cell[TextData[{
 "Methods which uses matrix representations  ",
 StyleBox["gaCharacteristicPolynomial[]",
  FontWeight->"Bold"],
 " are implemented in sec 10. This is done because we want to avoid listing \
of these functions in forward definition section ."
}], "Text",ExpressionUUID->"5f74d0db-9730-492f-987b-e83dfa54c1d5"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[740]:=",ExpressionUUID->"f0cf4a30-fede-4afe-93bb-2ca3a1a402d8"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Idempotents, left ideals, bilateral ideals, ideal basis"
}], "Section",ExpressionUUID->"e3a03971-e817-458b-81c9-e2dafb9dd869"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Tensor products and matrix representation of algebra"
}], "Section",ExpressionUUID->"336f3799-5846-4a02-a51d-b59298a2a91d"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ". Multivector inverse, reciprocal base, some bivector algebra formulas, \
blade and versor decomposition (not finished yet) [",
 StyleBox["gaDeterminantFormula, ExplicitFormula to replace by gaFormula. Too \
many similar names and duplications.",
  FontColor->RGBColor[1, 0, 0]],
 "]"
}], "Section",ExpressionUUID->"7e860192-8e40-40bc-a8a6-dd51050ec853"],

Cell["\<\
Put here coordinate implementation, it is not further to work with.\
\>", "Text",ExpressionUUID->"953ff1e7-b568-4eb7-88c0-bf1aa8d97a07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[864]:=",ExpressionUUID->"4214214a-9997-4894-b3e1-57e02f9a1992"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Multivector inverse, invertibility test, determinant norm of MV, \
determinant of of MV, minimal and characteristic polynomials"
}], "Subsection",ExpressionUUID->"3c62d2ef-697e-4b24-8292-296ec305d39b"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Reciprocal base and bivector commutator algebra (Lie algebra) functions"
}], "Subsection",ExpressionUUID->"79319218-6bb3-41ca-81be-4a32ffaee378"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Decompositions into geometric product"
}], "Subsection",ExpressionUUID->"28c66667-0bd3-498f-b9f2-d763a2717b76"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Decompositions into blades"
}], "Subsection",ExpressionUUID->"611d8018-a25e-4c47-9365-8628acb9e867"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Orthonormalization  of vector set"
}], "Subsection",ExpressionUUID->"83730c7d-346f-4e71-9d32-be54a4a0d4fb"],

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Linear equation solving "
}], "Subsection",ExpressionUUID->"fcfacdc3-379b-4fca-94f3-0bd4e0a241ea"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". Functions computed by characteristic polynomial formula (gaFunctionOfMV[])"
}], "Subsection",ExpressionUUID->"90f03b92-0361-4f06-a348-08128f4d4aa8"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ".",
 
 CounterBox["Subsubsection"],
 ". Coordinate implementation of gaFunctionOfMV[] (not finished, not all \
options implemented, not recommended), removed from list of methods \
completely."
}], "Subsubsection",ExpressionUUID->"7443a484-4a3a-4cff-b616-60ff10587954"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\"\<Coordinate\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GeometricAlgebra`p`printDetails", "[", 
     RowBox[{"False", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Coordinate method implementation we moved to obsolete notebook. \
It will not be further developed.\>\"", ",", "Null"}], "}"}], "}"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"functionOfMVCoordinate", "[", 
     RowBox[{"thefunction", ",", "exprExpanded", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theOption", "[", "\"\<Quiet\>\"", "]"}], ",", 
        RowBox[{"theOption", "[", "\"\<Expand\>\"", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theOption", "[", "\"\<Inactive\>\"", "]"}], ",", 
          "Inactive", ",", "Identity"}], "]"}]}], "}"}]}], "]"}]}], ","}], 
  "*)"}]], "Input",ExpressionUUID->"fa1d3ef7-3aba-4cdb-be0e-2969c305aebc"],

Cell["\<\
Coordinate implementation. When Minimal polynomial of matrix has multiple \
roots (i.e. in case of nondiagonalizable matrices), answer can be wrong. \
Trick: add small symbolic part, then compute limiting case. The tick gives \
correct results, however, computations are slow and exact answer may not be \
obtained\
\>", "Text",ExpressionUUID->"95f17e17-b65b-4378-9272-d21f5747cd48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"functionOfMVCoordinate", "[", 
   RowBox[{"thefunction_", ",", "exprExpanded_", ",", 
    RowBox[{"{", 
     RowBox[{"quiet_", ",", "expandFunction_", ",", "activate_"}], "}"}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"theAlg", "=", 
       RowBox[{"gaGetAlgebra", "[", "exprExpanded", "]"}]}], ",", 
      "basisNoUnit", ",", "dim", ",", "prodExpr", ",", "ch", ",", "chv", ",", 
      "chEq", ",", "chEqv", ",", "be", ",", "y", ",", "denominatorAbstract", 
      ",", "numeratorAbstract", ",", "rootsOfCharacteristicEquation", ",", 
      "sumTermMainPart", ",", "canceledFraction", ",", "tempContainer", ",", 
      "denominatorValuesAtRoots", ",", "sumContainer"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "dimension", " ", "of", " ", "matrix", " ", "representations", " ", 
      "and", " ", "basis", " ", "elements", " ", "with", " ", "scalar", " ", 
      "excluded"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"gaDimensionOfRepresentation", "[", "theAlg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"basisNoUnit", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"gaOrthonormalBasis", "[", "theAlg", "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"printDetails", "[", "]"}], " ", "automatically", " ", 
        "inverts", " ", "quit", " ", "value"}], ",", " ", 
       RowBox[{"therefore", " ", "here", " ", 
        RowBox[{"is", " ", "!"}], "quiet"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "quiet"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"note", " ", "different", " ", "meaning", " ", "of", " ", 
         RowBox[{"ch", "[", 
          RowBox[{"1", ",", ".."}], "]"}], " ", "and", " ", 
         RowBox[{"ch", "[", 
          RowBox[{"baseelem", ",", "..."}], "]"}], " ", "under", " ", 
         "similar", " ", "notation"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Format", "[", 
          RowBox[{
           TagBox[
            RowBox[{"ch", "[", 
             RowBox[{"1", ",", "b_"}], "]"}],
            FullForm], ",", "StandardForm"}], "]"}], ":=", 
         RowBox[{"DisplayForm", "[", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubscriptBox", "[", 
              RowBox[{"\"\<C\>\"", ",", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<(\>\"", ",", 
                  RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<)\>\""}], 
                 "}"}], "]"}]}], "]"}], ",", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<(\>\"", ",", "\"\<A\>\"", ",", "\"\<)\>\""}], 
               "}"}], "]"}]}], "}"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Format", "[", 
          RowBox[{
           TagBox[
            RowBox[{"ch", "[", 
             RowBox[{"bb_", ",", "b_"}], "]"}],
            FullForm], ",", "StandardForm"}], "]"}], ":=", 
         RowBox[{"DisplayForm", "[", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubscriptBox", "[", 
              RowBox[{"\"\<C\>\"", ",", "\"\<(1)\>\""}], "]"}], ",", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<(\>\"", ",", 
                RowBox[{"SubsuperscriptBox", "[", 
                 RowBox[{
                 "\"\<\[DoubleStruckE]\>\"", ",", "\"\<J\>\"", ",", 
                  "\"\<\[Dagger]\>\""}], "]"}], ",", 
                RowBox[{"SuperscriptBox", "[", 
                 RowBox[{"\"\<A\>\"", ",", 
                  RowBox[{"ToString", "[", "b", "]"}]}], "]"}], ",", 
                "\"\<)\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}]}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Using Method->\>\"", ",", "\"\<Coordinate\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Degree of characteristic polynomial is d= \>\"", ",", "dim"}], 
          "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"multiple", " ", "products", " ", "of", " ", "expr"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<Computing powers of of MV up to: d-1= \>\"", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Set", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"prodExpr", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "dim"}], "]"}]}], ",", 
        RowBox[{"NestList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gaPE", "[", 
            RowBox[{"GeometricProduct", "[", 
             RowBox[{"#", ",", "exprExpanded"}], "]"}], "]"}], "&"}], ",", 
          "exprExpanded", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "all", " ", "characteristic", " ", "polynomials", " ", 
       "of", " ", "input", " ", "MV", " ", "in", " ", "advance"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ClearAll", "[", "chv", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chv", "[", 
       RowBox[{"1", ",", "0"}], "]"}], "=", 
      RowBox[{"-", "1"}]}], ";", 
     RowBox[{"Set", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"chv", "[", 
           RowBox[{"1", ",", "k"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "dim"}], "}"}]}], "]"}], ",", 
        RowBox[{"gaCharacteristicPolynomial", "[", 
         RowBox[{"exprExpanded", ",", "All", ",", 
          RowBox[{"Quiet", "->", "True"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<characteristic coefficients of MV, k=1,...d are \
\!\(\*SubscriptBox[\(C\), \((k)\)]\)(A)=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"chv", "[", 
             RowBox[{"1", ",", "k"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "dim"}], "}"}]}], "]"}]}], "}"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "construction", " ", "of", " ", "characteristic", " ", "equation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"chEqv", "=", 
      RowBox[{"(", 
       RowBox[{"Function", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "\[FormalLambda]", "}"}], ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"chv", "[", 
               RowBox[{"1", ",", 
                RowBox[{"dim", "-", "i"}]}], "]"}], "*", 
              RowBox[{
               RowBox[{"(", "\[FormalLambda]", ")"}], "^", "i"}]}], ")"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "dim"}], "}"}]}], "]"}]}], "}"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Formal characteristic equation of MV, \
\[Chi](\[FormalLambda])=\>\"", ",", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ch", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"dim", "-", "i"}]}], "]"}], "*", 
               RowBox[{
                RowBox[{"(", "\[FormalLambda]", ")"}], "^", "i"}]}], ")"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "dim"}], "}"}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ch", "[", 
              RowBox[{"1", ",", "0"}], "]"}], "->", 
             RowBox[{"-", "1"}]}], "}"}]}]}], "}"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<characteristic equation of MV, \[Chi](\[FormalLambda])=\>\"", 
          ",", 
          RowBox[{"chEqv", "[", "\[FormalLambda]", "]"}]}], "}"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hermitian", " ", "conjugated", " ", "basis"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Hermitian conjugate basis \!\(\*SuperscriptBox[\(\
\[DoubleStruckE]\), \(J\)]\)=\>\"", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"gaIndexDown", "[", 
             RowBox[{"gaHermitianConjugate", "[", "#", "]"}], "]"}], "&"}], "/@",
            "basisNoUnit"}]}], "}"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "characteristic", " ", "polynomials", " ", "of", " ", 
       "special", " ", "compination", " ", "in", " ", "advance"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"chv", "[", 
         RowBox[{"be_", ",", "n_Integer"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"chv", "[", 
           RowBox[{"be", ",", "n"}], "]"}], "=", 
          RowBox[{"gaCharacteristicPolynomial", "[", 
           RowBox[{
            RowBox[{"gaPE", "[", 
             RowBox[{
              RowBox[{"gaIndexDown", "[", 
               RowBox[{"gaHermitianConjugate", "[", "be", "]"}], "]"}], 
              "\[GeometricProduct]", 
              RowBox[{"prodExpr", "[", "n", "]"}]}], "]"}], ",", "1", ",", 
            RowBox[{"Quiet", "->", "True"}]}], "]"}]}], ")"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", 
        RowBox[{"chv", "[", 
         RowBox[{"be", ",", "n"}], "]"}], " ", "are", " ", "C_", "1", " ", 
        "coefficients"}], ",", " ", 
       RowBox[{"which", " ", "are", " ", "just", " ", "traces"}], ",", " ", 
       RowBox[{
        RowBox[{"i", ".", "e", ".", " ", "scalar"}], " ", "parts", " ", "of", 
        " ", 
        RowBox[{"MV", ".", " ", "Can"}], " ", "be", " ", "computed", " ", 
        "in", " ", "a", " ", "much", " ", "simpler", " ", "way"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chv", "[", 
       RowBox[{"be_", ",", "n_Integer"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"chv", "[", 
         RowBox[{"be", ",", "n"}], "]"}], "=", 
        RowBox[{"dim", "*", 
         RowBox[{"gaGetMV", "[", 
          RowBox[{
           RowBox[{"gaPE", "[", 
            RowBox[{
             RowBox[{"gaIndexDown", "[", 
              RowBox[{"gaHermitianConjugate", "[", "be", "]"}], "]"}], 
             "\[GeometricProduct]", 
             RowBox[{"prodExpr", "[", "n", "]"}]}], "]"}], ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Characteristic polynomials for each Hermitian conjugate basis \
\!\(\*SuperscriptBox[\(\[DoubleStruckE]\), \(J\)]\) element and \
k\[Element][1,d-1], \!\(\*SubscriptBox[\(C\), \
\((1)\)]\)(\!\(\*SuperscriptBox[\(\[DoubleStruckE]\), \(J\)]\)\
\[GeometricProduct]\!\(\*SuperscriptBox[\(A\), \(k\)]\))=\>\"", ",", 
          RowBox[{"TableForm", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"chv", "[", 
               RowBox[{"i", ",", "k"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"dim", "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "basisNoUnit"}], "}"}]}], "]"}], ",", 
            RowBox[{"TableHeadings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\"\<k=\>\"", "<>", "#"}], ")"}], "&"}], "/@", 
                RowBox[{"ToString", "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"dim", "-", "1"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"gaIndexDown", "[", 
                  RowBox[{"gaHermitianConjugate", "[", "#", "]"}], "]"}], 
                 "&"}], "/@", "basisNoUnit"}]}], "}"}]}]}], "]"}]}], "}"}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Denominator", "'"}], "s", " ", "pure", " ", "function", " ", 
        "of", " ", "variable", " ", "y"}], ",", " ", 
       RowBox[{"compute", " ", "once"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"denominatorAbstract", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "*", 
         RowBox[{"ch", "[", 
          RowBox[{"1", ",", 
           RowBox[{"(", 
            RowBox[{"dim", "-", "i", "-", "1"}], ")"}]}], "]"}], "*", 
         RowBox[{"\[FormalLambda]", "^", "i"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Denominator's pure function : \>\"", ",", 
          "denominatorAbstract"}], "}"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Denominator's pure function with coefficients substituted: \
\>\"", ",", 
          RowBox[{"denominatorAbstract", "/.", 
           RowBox[{"{", 
            RowBox[{"ch", "->", "chv"}], "}"}]}]}], "}"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Numerator", "'"}], "s", " ", "pure", " ", "function", " ", 
        "of", " ", "variables", "  ", "y", " ", "and", " ", "be", 
        RowBox[{"(", "!", ")"}]}], ",", " ", 
       RowBox[{"compute", " ", "once"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"numeratorAbstract", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ch", "[", 
             RowBox[{"1", ",", "k"}], "]"}], "*", 
            RowBox[{"ch", "[", 
             RowBox[{"be", ",", 
              RowBox[{"dim", "-", "1", "-", "n", "-", "k"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"dim", "-", "2", "-", "n"}]}], "}"}]}], "]"}], "*", 
         RowBox[{"\[FormalLambda]", "^", "n"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", 
          RowBox[{"dim", "-", "2"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Numerator's pure function: \>\"", ",", "numeratorAbstract"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Numerator's pure function with some of coefficients \
substituted: \>\"", ",", 
           RowBox[{"numeratorAbstract", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ch", "[", 
               RowBox[{"1", ",", "x_"}], "]"}], ":>", 
              RowBox[{"chv", "[", 
               RowBox[{"1", ",", "x"}], "]"}]}], "}"}]}]}], "}"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"for", " ", "presenting", " ", "in", " ", "tex"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"printDetails", "[", 
        RowBox[{"quiet", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Numerator's pure function: \>\"", ",", 
            RowBox[{"numeratorAbstract", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ch", "->", "chte"}], ",", 
               RowBox[{"y", ":>", "\[Lambda]1"}]}], "}"}]}]}], "}"}], "}"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"printDetails", "[", 
        RowBox[{"quiet", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Denominator's pure function: \>\"", ",", 
            RowBox[{"denominatorAbstract", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ch", "->", "chte"}], ",", 
               RowBox[{"y", ":>", "\[Lambda]1"}]}], "}"}]}]}], "}"}], "}"}]}],
         "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"for", " ", "presenting", " ", "in", " ", "input"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"printDetails", "[", 
        RowBox[{"quiet", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Numerator's pure function: \>\"", ",", 
            RowBox[{"numeratorAbstract", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ch", "->", "C"}], ",", 
               RowBox[{"y", ":>", "\[FormalLambda]"}], ",", 
               RowBox[{"be", "->", "E"}]}], "}"}]}]}], "}"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"printDetails", "[", 
        RowBox[{"quiet", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Denominator's pure function: \>\"", ",", 
            RowBox[{"denominatorAbstract", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ch", "->", "C"}], ",", 
               RowBox[{"y", ":>", "\[FormalLambda]"}]}], "}"}]}]}], "}"}], 
          "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rootsOfCharacteristicEquation", "=", 
      RowBox[{"SolveValues", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"chEqv", "[", "\[FormalLambda]", "]"}], "==", "0"}], ",", 
        "\[FormalLambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"In", " ", "addition"}], ",", " ", 
       RowBox[{
       "add", " ", "function", " ", "to", " ", "cancel", " ", "common", " ", 
        "factors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sumTermMainPart", "=", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Apply", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Function", "@@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"be", ",", "y"}], "}"}], ",", 
                  RowBox[{"tempContainer", "[", 
                   RowBox[{
                   "numeratorAbstract", ",", "denominatorAbstract", ",", 
                    RowBox[{"chEqv", "[", "\[FormalLambda]", "]"}]}], "]"}]}],
                  "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"ch", "->", "chv"}], "}"}]}], ",", 
             RowBox[{"Outer", "[", 
              RowBox[{"List", ",", "basisNoUnit", ",", 
               RowBox[{"{", "\[FormalLambda]", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"tempContainer", "[", 
            RowBox[{"0", ",", "x__"}], "]"}], ":>", "0"}]}], ")"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"tempContainer", "[", 
         RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"canceledFraction", "=", 
            RowBox[{"Cancel", "[", 
             RowBox[{"x1", "/", "x2"}], "]"}]}], ";", 
           RowBox[{"tempContainer", "[", 
            RowBox[{
             RowBox[{"Numerator", "[", "canceledFraction", "]"}], ",", 
             RowBox[{"Denominator", "[", "canceledFraction", "]"}], ",", 
             "x3"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"PolynomialGCD", "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], "=!=", "1"}]}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tempContainer", "[", 
        RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":>", 
       RowBox[{"tempContainer", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolynomialGCD", "[", 
             RowBox[{"x1", ",", "x2", ",", 
              RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], "===", 
            "1"}], ",", "Identity", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cancel", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Extension", "\[Rule]", "Automatic"}]}], "]"}], "&"}], 
            ")"}]}], "]"}]}]}]}], "*)"}], 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Roots of characteristic polynomial: \>\"", ",", 
           "rootsOfCharacteristicEquation"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Numerator's and denominator's fully substituted: \
{numerator,denominator,CharacteristicPolynomial}\\r\>\"", ",", 
           RowBox[{"List", "@@@", "sumTermMainPart"}]}], "}"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "if", " ", "characteristic", " ", "polynomial", " ", "shares", " ", 
        "common", " ", "root", " ", "with", " ", "formula", " ", 
        "denominator"}], ",", " ", 
       RowBox[{"then", " ", "explicitly", " ", "construct", " ", "sum"}]}], 
      " ", "*)"}], 
     RowBox[{"(*", " ", 
      RowBox[{
      "and", " ", "compute", " ", "limit", " ", "by", " ", "expanding", " ", 
       "numerator", " ", "and", " ", "denominator", " ", "around", " ", 
       "that", " ", "root"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"denominatorValuesAtRoots", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Function", "@@", 
         RowBox[{"{", 
          RowBox[{"\[FormalLambda]", ",", 
           RowBox[{"denominatorAbstract", "/.", 
            RowBox[{"{", 
             RowBox[{"ch", "->", "chv"}], "}"}]}]}], "}"}]}], ")"}], "/@", 
       "rootsOfCharacteristicEquation"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"printDetails", "[", 
      RowBox[{"quiet", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Denominators values at CharacteristicPolynomial roots: \>\"", 
           ",", "denominatorValuesAtRoots"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<Abstract term replaced by sumContainer\>\"", ",", 
           RowBox[{"(", 
            RowBox[{"sumTermMainPart", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tempContainer", "[", 
                RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
               RowBox[{"(", 
                RowBox[{"Plus", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sumContainer", "[", 
                    RowBox[{"x1", ",", "x2", ",", "#"}], "]"}], "&"}], "/@", 
                   "rootsOfCharacteristicEquation"}], ")"}]}], ")"}]}], 
              "}"}]}], ")"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<sumContainer modified\>\"", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"sumTermMainPart", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"tempContainer", "[", 
                 RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                RowBox[{"(", 
                 RowBox[{"Plus", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"sumContainer", "[", 
                    RowBox[{"x1", ",", "x2", ",", "#"}], "]"}], "&"}], "/@", 
                    "rootsOfCharacteristicEquation"}], ")"}]}], ")"}]}], 
               "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"sumContainer", "[", 
                RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
               RowBox[{"RuleCondition", "[", 
                RowBox[{
                 RowBox[{"Residue", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"thefunction", "[", "\[FormalLambda]", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"x1", "/", "x2"}], ")"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", ",", "x3"}], "}"}]}], "]"}], 
                 ",", 
                 RowBox[{"PossibleZeroQ", "[", 
                  RowBox[{"(", 
                   RowBox[{"x2", "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ")"}], 
                  "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"sumContainer", "[", 
                RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"thefunction", "[", "x3", "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x1", "/", "x2"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ")"}]}],
                 ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"denominatorValuesAtRoots", ",", "PossibleZeroQ"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"removed", " ", "wrong", " ", "answer", " ", "attempt"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Residue approach: answer can be wrong!\>\"", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "dim"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"RootSum", "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Function", "@@", 
                RowBox[{"{", 
                 RowBox[{"\[FormalLambda]", ",", 
                  RowBox[{"chEqv", "[", "\[FormalLambda]", "]"}]}], "}"}]}], 
               ",", "thefunction"}], "}"}]}], ")"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"sumTermMainPart", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tempContainer", "[", 
                   RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                  RowBox[{"(", 
                   RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sumContainer", "[", 
                    RowBox[{"x1", ",", "x2", ",", "#"}], "]"}], "&"}], "/@", 
                    "rootsOfCharacteristicEquation"}], ")"}]}], ")"}]}], 
                 "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"sumContainer", "[", 
                  RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                 RowBox[{"RuleCondition", "[", 
                  RowBox[{
                   RowBox[{"Residue", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"thefunction", "[", "\[FormalLambda]", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"x1", "/", "x2"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", ",", "x3"}], "}"}]}], "]"}], 
                   ",", 
                   RowBox[{"PossibleZeroQ", "[", 
                    RowBox[{"(", 
                    RowBox[{"x2", "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ")"}], 
                    "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sumContainer", "[", 
                    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                   RowBox[{"RuleCondition", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"thefunction", "[", "\[FormalLambda]", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"x1", "/", "x2"}], ")"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ",", 
                    RowBox[{"PossibleZeroQ", "[", 
                    RowBox[{"(", 
                    RowBox[{"x2", "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ")"}], 
                    "]"}]}], "]"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sumContainer", "[", 
                  RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"thefunction", "[", "x3", "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "/", "x2"}], ")"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", "->", "x3"}], "}"}]}], ")"}]}],
                   ")"}]}]}], "}"}]}], "\[IndentingNewLine]", ")"}], ".", 
            "basisNoUnit"}]}], "\[IndentingNewLine]", ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "branch", " ", "for", " ", "diagonalizable", " ", "matrices"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "for"}], " ", "matrices", " ", 
          "when", " ", "MinimalPolynomial", " ", "hs", " ", "no", " ", 
          "repeated", " ", 
          RowBox[{"roots", ":", " ", 
           RowBox[{"SquareFreeQ", "[", "minimalPoly", "]"}]}]}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "dim"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"activate", "[", "RootSum", "]"}], "@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Function", "@@", 
               RowBox[{"{", 
                RowBox[{"\[FormalLambda]", ",", 
                 RowBox[{"chEqv", "[", "\[FormalLambda]", "]"}]}], "}"}]}], 
              ",", "thefunction"}], "}"}]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sumTermMainPart", "/.", 
               RowBox[{
                RowBox[{"tempContainer", "[", 
                 RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"activate", "[", "RootSum", "]"}], "@@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Function", "@@", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", ",", "x3"}], "}"}]}], ",", 
                   RowBox[{"Function", "@@", 
                    RowBox[{"{", 
                    RowBox[{"\[FormalLambda]", ",", 
                    RowBox[{
                    RowBox[{"thefunction", "[", "\[FormalLambda]", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"x1", "/", "x2"}], ")"}]}]}], "}"}]}]}], 
                  "}"}]}]}]}], ")"}], ".", "basisNoUnit"}], ")"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ch", "->", "chv"}], ",", 
            RowBox[{"chEq", "->", "chEqv"}]}], "}"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CodeAssistOptions->{
 "CodeToolsOptions"-><|
  "CodeInspect" -> <|
    "Tags" -> <|
      "DuplicateKeys" -> <|"ListOfRules" -> <|Enabled -> False|>|>|>|>|>},
 CellLabel->
  "In[1333]:=",ExpressionUUID->"a054b42d-62b7-4848-b786-4a20325904c7"]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPrivate", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[1336]:=",ExpressionUUID->"e589a11d-8cb2-42a2-9d73-4a0cc5255446"]
}, Closed]],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Linear transformations"
}], "Section",ExpressionUUID->"39ed1d48-63a5-4efb-bcef-7b64dfe1d017"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Multivector derivatives (inactivated, not yet useful)"
}], "Section",ExpressionUUID->"dd66f057-db78-49d6-9fd9-189b65743a87"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Close Package"
}], "Section",ExpressionUUID->"9d64e97a-daf9-489a-b86e-8a6b45e34461"],

Cell[TextData[{
 
 CounterBox["Section"],
 ". Notes, drawbacks, future plans"
}], "Section",ExpressionUUID->"64646392-2c84-44bd-8289-d306a45113a6"]
},
CellGrouping->Manual,
WindowSize->{1416.75, 1516.5},
WindowMargins->{{540, Automatic}, {25.748031496062822`, Automatic}},
ShowSelection->True,
ShowCellTags->True,
TrackCellChangeTimes->False,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (December 7, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b2e34cb7-41f4-490f-838e-cf4fa00019f1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 98, "Title",ExpressionUUID->"9afea453-cc25-4c79-a71c-e5dfbdd1d324",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[768, 27, 190, 4, 36, "Text",ExpressionUUID->"4e44f443-be07-4aab-b2e3-346b3c4e2be1",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[973, 34, 408, 7, 60, "Text",ExpressionUUID->"b7096c71-859b-4301-9d48-460b7bed196f",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1384, 43, 165, 4, 68, "Section",ExpressionUUID->"d8cfecff-afda-4dd1-b50c-05b0a8572010"],
Cell[1552, 49, 138, 4, 54, "Section",ExpressionUUID->"246089b4-9667-4177-8ba9-b641a2c1b982"],
Cell[1693, 55, 131, 4, 54, "Section",ExpressionUUID->"2153a712-150f-4eab-9c82-4673c6899f50"],
Cell[1827, 61, 194, 5, 54, "Section",ExpressionUUID->"d373e055-74a0-4e3d-a30c-88ebbd8d41d2"],
Cell[CellGroupData[{
Cell[2046, 70, 140, 4, 54, "Section",ExpressionUUID->"304188e1-9b37-431a-8354-d6f45e36f849"],
Cell[2189, 76, 263, 7, 29, "Input",ExpressionUUID->"759e0625-efc6-47e0-a17d-83900192f928"],
Cell[2455, 85, 409, 9, 51, "Input",ExpressionUUID->"8e2eb4bf-ce36-4b31-8744-b7b7904786a8"],
Cell[2867, 96, 549, 10, 94, "Input",ExpressionUUID->"0e023f4d-15c7-4116-8afa-39d964b58fcd"],
Cell[3419, 108, 603, 11, 94, "Input",ExpressionUUID->"cc7660da-f93a-4b11-98b7-294a8745ff3b"],
Cell[4025, 121, 161, 4, 29, "Input",ExpressionUUID->"a314b866-2667-4c1d-902a-1cc2dba298d9"],
Cell[4189, 127, 227, 7, 54, "Subsection",ExpressionUUID->"d137b774-f937-486d-9bd7-5fd33bc8d35b"],
Cell[4419, 136, 203, 7, 38, "Subsection",ExpressionUUID->"b70f1179-3daf-403e-8708-0fc594dd4ca7"],
Cell[CellGroupData[{
Cell[4647, 147, 183, 7, 38, "Subsection",ExpressionUUID->"c8de79d9-8ee5-4657-a5be-2750efa5f7b1"],
Cell[4833, 156, 270, 13, 45, "Subsubsection",ExpressionUUID->"4b03d21d-cc75-4eec-9c44-6ddfcdace8d9"],
Cell[CellGroupData[{
Cell[5128, 173, 284, 12, 37, "Subsubsection",ExpressionUUID->"0e1415c1-0323-4301-9eb5-f8dc9ce1a1d0"],
Cell[5415, 187, 233, 6, 35, "Text",ExpressionUUID->"c8c3e373-71e7-4b43-b30e-0ac149b1bde3",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[5651, 195, 9012, 223, 621, "Input",ExpressionUUID->"fe8e12e2-fee0-4c9b-9f8d-576c546c53e5"]
}, Closed]]
}, Open  ]],
Cell[14690, 422, 255, 8, 54, "Subsection",ExpressionUUID->"12d768d1-d4e8-443c-8193-af0e56387e6c"],
Cell[14948, 432, 280, 9, 38, "Subsection",ExpressionUUID->"920d1dfa-501f-4fac-b444-8221440fbcd1"],
Cell[15231, 443, 217, 7, 38, "Subsection",ExpressionUUID->"d07d0b62-f9e0-4091-9ba6-6b96ff62be73"],
Cell[CellGroupData[{
Cell[15473, 454, 239, 8, 38, "Subsection",ExpressionUUID->"1b7250b8-7e24-4849-893b-d6e34db43544"],
Cell[15715, 464, 311, 11, 45, "Subsubsection",ExpressionUUID->"22e83c37-cece-45bf-bd1e-5941ab704605"],
Cell[16029, 477, 221, 10, 37, "Subsubsection",ExpressionUUID->"4d6f273a-a6c9-496c-873e-f10f708dfd88"],
Cell[CellGroupData[{
Cell[16275, 491, 401, 14, 39, "Subsubsection",ExpressionUUID->"ac214813-a822-4fd8-a149-b299831fe75e"],
Cell[16679, 507, 191, 3, 35, "Text",ExpressionUUID->"c4568d30-c21f-4b9f-b6aa-cc0a49d0cb45"],
Cell[16873, 512, 1099, 28, 71, "Input",ExpressionUUID->"06dc5628-111e-4101-beea-b872d1160f1b"],
Cell[17975, 542, 1106, 29, 71, "Input",ExpressionUUID->"0325b2ad-41d0-4a9e-ab18-2ddde716dc81"],
Cell[19084, 573, 191, 3, 35, "Text",ExpressionUUID->"bb635bfe-d382-4941-8012-b3395590a9cd"],
Cell[19278, 578, 1118, 30, 71, "Input",ExpressionUUID->"8784d2a7-f062-422f-8810-d68d587f3ca1"],
Cell[20399, 610, 1115, 29, 71, "Input",ExpressionUUID->"5c35e9e1-2974-4e22-b01f-83077ce9558a"],
Cell[21517, 641, 191, 3, 35, "Text",ExpressionUUID->"c107d3a7-65aa-48be-8ff8-a5894333eaaf"],
Cell[21711, 646, 1190, 31, 71, "Input",ExpressionUUID->"3322879b-e4a9-41a1-88dc-55a832950a43"],
Cell[22904, 679, 1199, 32, 71, "Input",ExpressionUUID->"7c60e1fb-9cd9-4a98-8744-f9473ebb8a57"]
}, Closed]]
}, Open  ]],
Cell[24130, 715, 208, 7, 54, "Subsection",ExpressionUUID->"c46d245b-c23d-4ec1-aad7-f53835f354c8"],
Cell[CellGroupData[{
Cell[24363, 726, 338, 13, 37, "Subsubsection",ExpressionUUID->"3f0c3fd6-20cd-49e0-9bbf-df925a6b51fd"],
Cell[24704, 741, 313, 12, 45, "Subsubsection",ExpressionUUID->"6287ce71-e6ac-4b87-9bf8-5cc394b1d4a1"],
Cell[25020, 755, 328, 11, 37, "Subsubsection",ExpressionUUID->"71b27afb-2132-467a-b122-c5d508bcba95"],
Cell[25351, 768, 224, 10, 37, "Subsubsection",ExpressionUUID->"692defce-ca50-4322-a5d8-61e0683ee7a4"],
Cell[25578, 780, 209, 10, 37, "Subsubsection",ExpressionUUID->"10fa0e49-d336-44ab-aa83-9fea6a380c3b"],
Cell[25790, 792, 276, 11, 37, "Subsubsection",ExpressionUUID->"2daf5d7e-dc63-4934-a109-d4fcf4da5e6d"],
Cell[CellGroupData[{
Cell[26091, 807, 273, 11, 37, "Subsubsection",ExpressionUUID->"17ae3335-b69b-4bb5-b4f1-e5d1687609de"],
Cell[26367, 820, 194, 3, 35, "Text",ExpressionUUID->"a947def1-2ad1-4bc4-b3a3-7fa50f24d621"],
Cell[26564, 825, 1067, 29, 71, "Input",ExpressionUUID->"14097973-5ad2-4ea7-b26c-c7da8aec6148"],
Cell[27634, 856, 1169, 30, 71, "Input",ExpressionUUID->"e3268b0f-229b-4de3-9621-2c0ccb1b2016"],
Cell[28806, 888, 220, 3, 35, "Text",ExpressionUUID->"1c127f23-d111-42ea-bb5e-6415f7355ac2"],
Cell[29029, 893, 539, 13, 73, "Input",ExpressionUUID->"cd3339ae-76e7-4b9d-931b-aee3b237170c"],
Cell[29571, 908, 2471, 62, 154, "Input",ExpressionUUID->"19ce5d1d-44e8-45d2-9510-94b7333574ea"],
Cell[32045, 972, 617, 18, 29, "Input",ExpressionUUID->"efdcc58f-59cd-47b1-9df9-3cc10e5eade8"],
Cell[32665, 992, 326, 5, 58, "Text",ExpressionUUID->"db2bd680-bda6-472e-acc0-a77a1d86df47"],
Cell[32994, 999, 2879, 69, 236, "Input",ExpressionUUID->"3ff442c9-bf3a-4d9c-b9cc-d184f5cacc3a"]
}, Closed]]
}, Open  ]],
Cell[35900, 1072, 159, 4, 29, "Input",ExpressionUUID->"22d496fd-d256-453b-b3a2-888781a9b824"]
}, Open  ]],
Cell[36074, 1079, 175, 4, 68, "Section",ExpressionUUID->"5a369682-a6ac-4123-ba78-b7d12d19d351"],
Cell[CellGroupData[{
Cell[36274, 1087, 171, 4, 54, "Section",ExpressionUUID->"60614cca-24a6-49cb-92b4-25008c1bebb7"],
Cell[36448, 1093, 229, 5, 29, "Input",ExpressionUUID->"6300459f-05d0-43dc-a673-2dcc3f54f916"],
Cell[36680, 1100, 409, 9, 51, "Input",ExpressionUUID->"f12f28a6-7fcc-4d1c-8984-9448d950161d"],
Cell[37092, 1111, 278, 4, 35, "Text",ExpressionUUID->"f2fd5974-1777-4119-8d78-63f518bd19a5"],
Cell[37373, 1117, 1077, 21, 178, "Input",ExpressionUUID->"861ce4db-13c5-4c7e-94a6-7b3f35ef7cae"],
Cell[38453, 1140, 300, 6, 32, "Input",ExpressionUUID->"e53eb3a5-3dbb-4160-b104-0fe712990f26"],
Cell[38756, 1148, 161, 4, 29, "Input",ExpressionUUID->"214722ac-de12-43d8-a51c-e6671ef3ae80"],
Cell[CellGroupData[{
Cell[38942, 1156, 170, 7, 54, "Subsection",ExpressionUUID->"c5c60def-87c3-4330-baa1-b293dc3443c3"],
Cell[CellGroupData[{
Cell[39137, 1167, 236, 10, 45, "Subsubsection",ExpressionUUID->"cbda8825-46d2-4dbc-bf15-a559fedee625"],
Cell[CellGroupData[{
Cell[39398, 1181, 312, 9, 32, "Item",ExpressionUUID->"6d0cb4c2-0d15-4321-826a-9aff885a5b2b",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[39713, 1192, 304, 7, 35, "Text",ExpressionUUID->"b13b6fce-2f0d-49d4-ad75-161c51c20775",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[40020, 1201, 10562, 250, 814, "Input",ExpressionUUID->"269103f7-1b09-472e-9d30-30f51e79cf13",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[50631, 1457, 183, 7, 38, "Subsection",ExpressionUUID->"da217918-c99d-4ce2-ae95-92ce0cf52804"],
Cell[CellGroupData[{
Cell[50839, 1468, 241, 10, 45, "Subsubsection",ExpressionUUID->"4752c398-43a4-45e3-97b3-28112bde453f"],
Cell[51083, 1480, 169, 3, 35, "Text",ExpressionUUID->"58de283e-5610-4dc9-8dc9-070c4976700d"],
Cell[CellGroupData[{
Cell[51277, 1487, 167, 3, 32, "Item",ExpressionUUID->"32c12529-7849-486e-89a9-69ba227b5a1b",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[51447, 1492, 157, 4, 35, "Text",ExpressionUUID->"4ff226a4-2f04-46ef-8a78-ec99f393841e"],
Cell[51607, 1498, 1064, 32, 92, "Input",ExpressionUUID->"f1e67b12-9351-49ef-b1d2-67ecd077fab7"],
Cell[52674, 1532, 95, 0, 35, "Text",ExpressionUUID->"58ccba73-06f7-42b4-9dda-3ca5231ed05f"],
Cell[52772, 1534, 573, 16, 51, "Input",ExpressionUUID->"71089eed-51f7-44d7-abed-8d0aaa3cf3fa"],
Cell[53348, 1552, 2848, 72, 174, "Input",ExpressionUUID->"9e5f6de5-b136-45eb-b35e-feb565f56d72"],
Cell[56199, 1626, 180, 3, 35, "Text",ExpressionUUID->"e8647c23-339e-4c90-817b-d00dd41117c6"],
Cell[56382, 1631, 6176, 145, 401, "Input",ExpressionUUID->"e5542a98-dda4-4ed2-a9da-0e70a77573c1"],
Cell[62561, 1778, 6315, 150, 401, "Input",ExpressionUUID->"fdf686ac-d973-4a1a-96b9-eeeef646c5e1"],
Cell[68879, 1930, 5995, 142, 381, "Input",ExpressionUUID->"320c1fd9-2c1f-4690-b7da-8b52eb4d68ef"]
}, Closed]],
Cell[CellGroupData[{
Cell[74911, 2077, 83, 0, 28, "Item",ExpressionUUID->"e0bb99f1-b6b2-4fae-be26-6d65ff645b34"],
Cell[74997, 2079, 353, 6, 58, "Text",ExpressionUUID->"c1267408-fb42-4e01-9013-6cece29d0b1e"],
Cell[75353, 2087, 16583, 384, 1371, "Input",ExpressionUUID->"583eed70-e129-4d3e-a372-817114be155d"]
}, Closed]],
Cell[CellGroupData[{
Cell[91973, 2476, 83, 0, 28, "Item",ExpressionUUID->"8ab08e55-bec0-44d6-b19f-ec3f874690e3"],
Cell[92059, 2478, 353, 6, 58, "Text",ExpressionUUID->"dedf9d7c-0afc-4807-a4c6-5d2a75546f9c"],
Cell[92415, 2486, 17212, 399, 1412, "Input",ExpressionUUID->"1084e821-5e43-4ea5-b447-e8eea822ee14"]
}, Closed]],
Cell[CellGroupData[{
Cell[109664, 2890, 83, 0, 28, "Item",ExpressionUUID->"5489a124-a492-4370-89c2-8bea07b23fcc"],
Cell[109750, 2892, 353, 6, 58, "Text",ExpressionUUID->"8efafede-b9af-46a8-ac6b-2da4f6b30f01"],
Cell[110106, 2900, 22804, 523, 1515, "Input",ExpressionUUID->"9bed5b40-59d5-4674-8cd1-450bd33201bb"]
}, Closed]],
Cell[CellGroupData[{
Cell[132947, 3428, 123, 0, 28, "Item",ExpressionUUID->"328d4f1e-abf1-46c3-adff-d0b4b0b9d828"],
Cell[133073, 3430, 353, 6, 58, "Text",ExpressionUUID->"50df9421-1a9d-4138-8a81-2151507f9197"],
Cell[133429, 3438, 22732, 521, 1515, "Input",ExpressionUUID->"7d839d58-17e2-469b-8a90-02c1b91dd383"]
}, Closed]],
Cell[CellGroupData[{
Cell[156198, 3964, 83, 0, 28, "Item",ExpressionUUID->"797bfead-0439-49d6-891f-45f3f52db796"],
Cell[156284, 3966, 353, 6, 58, "Text",ExpressionUUID->"423b2b2f-8185-4dac-a5a7-4646dc8c9ac3"],
Cell[156640, 3974, 22733, 523, 1474, "Input",ExpressionUUID->"d886fe9c-ba1f-4439-8c5c-39fdbdbb47c3"]
}, Closed]],
Cell[CellGroupData[{
Cell[179410, 4502, 83, 0, 28, "Item",ExpressionUUID->"bfe6d47a-c8fe-4120-a368-9b9f9f8ad02f"],
Cell[179496, 4504, 353, 6, 58, "Text",ExpressionUUID->"41568810-f1c8-4284-8c4f-752393da4190"],
Cell[179852, 4512, 93710, 2096, 4568, "Input",ExpressionUUID->"7f172efb-1641-453b-9665-359c59f30340"]
}, Closed]],
Cell[CellGroupData[{
Cell[273599, 6613, 83, 0, 28, "Item",ExpressionUUID->"64049c0c-c575-4904-a093-abd750ee256f"],
Cell[273685, 6615, 353, 6, 58, "Text",ExpressionUUID->"5768c394-99d0-4319-8260-cb701d700939"],
Cell[274041, 6623, 113053, 2518, 5303, "Input",ExpressionUUID->"b69ef5de-a255-4916-8aa9-9108fcb606b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[387131, 9146, 123, 0, 28, "Item",ExpressionUUID->"74f8001e-15e4-4704-8e61-b6f416fbfeb2"],
Cell[387257, 9148, 353, 6, 58, "Text",ExpressionUUID->"918cab6c-cc2c-46c0-9a11-e030ca2346e5"],
Cell[387613, 9156, 90441, 2045, 4568, "Input",ExpressionUUID->"d86a50c8-e258-460e-9c03-bd22c334874d"]
}, Closed]],
Cell[CellGroupData[{
Cell[478091, 11206, 83, 0, 28, "Item",ExpressionUUID->"3d0c09a2-0346-4269-b483-eccb54055148"],
Cell[478177, 11208, 353, 6, 58, "Text",ExpressionUUID->"18a5a6ff-048e-406a-8e29-8ee664ae3e42"],
Cell[478533, 11216, 111444, 2502, 5008, "Input",ExpressionUUID->"183d1da1-7cd0-447e-b98f-37402b018610"]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[590062, 13727, 229, 10, 45, "Subsubsection",ExpressionUUID->"ef5a79b8-23b4-4ecc-bb0c-ff97c8b1c32b"],
Cell[590294, 13739, 164, 3, 35, "Text",ExpressionUUID->"16e9211c-d78b-42b3-934d-52af48cd3710"],
Cell[CellGroupData[{
Cell[590483, 13746, 163, 3, 32, "Item",ExpressionUUID->"2f51f5e0-693f-43ec-8449-fc8752ac97fa",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[590649, 13751, 384, 9, 35, "Text",ExpressionUUID->"b414f7e6-41da-4d25-88bd-17e2185915d4"],
Cell[591036, 13762, 206, 5, 29, "Input",ExpressionUUID->"6c724a62-b7bd-4a0e-abc3-36127bc046a1"],
Cell[591245, 13769, 674, 18, 51, "Input",ExpressionUUID->"c2c7346d-8854-4251-8321-f381f2c5a0ee"],
Cell[591922, 13789, 5225, 134, 470, "Input",ExpressionUUID->"0246d1e0-d3e6-410d-886b-dd403c8fd64e"],
Cell[597150, 13925, 313, 6, 35, "Text",ExpressionUUID->"6649661c-a62f-4bc1-b940-2861cbdce1ad"],
Cell[597466, 13933, 9193, 212, 853, "Input",ExpressionUUID->"836385f4-47a8-4970-80a3-2929e9664092"],
Cell[606662, 14147, 405, 15, 35, "Text",ExpressionUUID->"ae08dbc5-b6e3-4517-8d1a-c74e67f50a71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[607104, 14167, 83, 0, 32, "Item",ExpressionUUID->"aa0ff08b-216b-4964-a6db-4f254fc6b5f7"],
Cell[607190, 14169, 2800, 77, 191, "Input",ExpressionUUID->"24950d0b-a519-493c-9c2a-cab2c7432441"]
}, Closed]],
Cell[CellGroupData[{
Cell[610027, 14251, 83, 0, 28, "Item",ExpressionUUID->"5fa525a2-aa8b-416e-9e5e-ea2e5cee6316"],
Cell[610113, 14253, 2865, 79, 168, "Input",ExpressionUUID->"223212f9-7481-4fd8-b8a6-5b5bed209380"]
}, Closed]],
Cell[CellGroupData[{
Cell[613015, 14337, 96, 0, 28, "Item",ExpressionUUID->"98c2ccb4-6c0e-4edc-94be-4c16fea74786"],
Cell[613114, 14339, 4323, 115, 213, "Input",ExpressionUUID->"dc981f8f-ec96-4a24-9d0e-53b866c7baa1"]
}, Closed]],
Cell[CellGroupData[{
Cell[617474, 14459, 83, 0, 28, "Item",ExpressionUUID->"128eed3f-cf72-4dae-a0b6-476ab8e12364"],
Cell[617560, 14461, 2450, 66, 273, "Input",ExpressionUUID->"5b754e05-cfff-4828-a6c0-8b8f176e9837"]
}, Closed]],
Cell[CellGroupData[{
Cell[620047, 14532, 83, 0, 28, "Item",ExpressionUUID->"e416b0a1-8d5f-458c-b894-546100422f99"],
Cell[620133, 14534, 166, 3, 35, "Text",ExpressionUUID->"da0ccb85-6d26-489b-aa28-5262bc398992"],
Cell[620302, 14539, 28153, 670, 1153, "Input",ExpressionUUID->"aeafc18d-9e18-4cd5-ba7d-1d04dccb82b9"]
}, Closed]],
Cell[CellGroupData[{
Cell[648492, 15214, 83, 0, 28, "Item",ExpressionUUID->"ab81da40-c148-4f32-8c7b-0d7ee59a6b76"],
Cell[648578, 15216, 283, 4, 35, "Text",ExpressionUUID->"f7cfc027-c1fd-4235-9cb8-d64301bb0b14"],
Cell[648864, 15222, 34194, 803, 1866, "Input",ExpressionUUID->"9eebbd76-ec49-4b3d-877b-294387587a31"]
}, Closed]],
Cell[CellGroupData[{
Cell[683095, 16030, 83, 0, 28, "Item",ExpressionUUID->"319ebe84-125c-4890-a66f-8ebc95dfe8ec"],
Cell[683181, 16032, 143, 2, 35, "Text",ExpressionUUID->"467db570-c86f-4037-8b3e-fbd04850ea93"],
Cell[683327, 16036, 28161, 671, 1192, "Input",ExpressionUUID->"4d603e32-6208-4110-8b3b-66e0527f36d9"],
Cell[711491, 16709, 121, 0, 35, "Text",ExpressionUUID->"8d3023e7-973e-446c-84b4-c22a50b581c2"]
}, Closed]],
Cell[CellGroupData[{
Cell[711649, 16714, 83, 0, 28, "Item",ExpressionUUID->"61029f99-4e2c-4d35-9a60-2d459fa78b5d"],
Cell[711735, 16716, 166, 3, 35, "Text",ExpressionUUID->"38b973d0-b067-4651-9363-a728a4882681"],
Cell[711904, 16721, 22881, 556, 1053, "Input",ExpressionUUID->"ea45a2f6-e678-47b5-99e4-c2315ef35f56"]
}, Closed]],
Cell[CellGroupData[{
Cell[734822, 17282, 152, 2, 28, "Item",ExpressionUUID->"4aacd167-15b7-4827-9f95-ea5731daaaa9"],
Cell[734977, 17286, 325, 6, 35, "Text",ExpressionUUID->"5f74d0db-9730-492f-987b-e83dfa54c1d5"]
}, Open  ]]
}, Open  ]],
Cell[735329, 17296, 159, 4, 29, "Input",ExpressionUUID->"f0cf4a30-fede-4afe-93bb-2ca3a1a402d8"],
Cell[735491, 17302, 172, 4, 68, "Section",ExpressionUUID->"e3a03971-e817-458b-81c9-e2dafb9dd869"],
Cell[735666, 17308, 169, 4, 54, "Section",ExpressionUUID->"336f3799-5846-4a02-a51d-b59298a2a91d"],
Cell[CellGroupData[{
Cell[735860, 17316, 398, 9, 132, "Section",ExpressionUUID->"7e860192-8e40-40bc-a8a6-dd51050ec853"],
Cell[736261, 17327, 146, 2, 35, "Text",ExpressionUUID->"953ff1e7-b568-4eb7-88c0-bf1aa8d97a07"],
Cell[736410, 17331, 161, 4, 29, "Input",ExpressionUUID->"4214214a-9997-4894-b3e1-57e02f9a1992"],
Cell[736574, 17337, 282, 8, 54, "Subsection",ExpressionUUID->"3c62d2ef-697e-4b24-8292-296ec305d39b"],
Cell[736859, 17347, 226, 7, 38, "Subsection",ExpressionUUID->"79319218-6bb3-41ca-81be-4a32ffaee378"],
Cell[737088, 17356, 192, 7, 38, "Subsection",ExpressionUUID->"28c66667-0bd3-498f-b9f2-d763a2717b76"],
Cell[737283, 17365, 181, 7, 38, "Subsection",ExpressionUUID->"611d8018-a25e-4c47-9365-8628acb9e867"],
Cell[737467, 17374, 188, 7, 38, "Subsection",ExpressionUUID->"83730c7d-346f-4e71-9d32-be54a4a0d4fb"],
Cell[737658, 17383, 179, 7, 38, "Subsection",ExpressionUUID->"fcfacdc3-379b-4fca-94f3-0bd4e0a241ea"],
Cell[CellGroupData[{
Cell[737862, 17394, 229, 7, 38, "Subsection",ExpressionUUID->"90f03b92-0361-4f06-a348-08128f4d4aa8"],
Cell[CellGroupData[{
Cell[738116, 17405, 348, 12, 45, "Subsubsection",ExpressionUUID->"7443a484-4a3a-4cff-b616-60ff10587954"],
Cell[738467, 17419, 962, 22, 74, "Input",ExpressionUUID->"fa1d3ef7-3aba-4cdb-be0e-2969c305aebc"],
Cell[739432, 17443, 393, 6, 58, "Text",ExpressionUUID->"95f17e17-b65b-4378-9272-d21f5747cd48"],
Cell[739828, 17451, 34404, 845, 2280, "Input",ExpressionUUID->"a054b42d-62b7-4848-b786-4a20325904c7"]
}, Closed]]
}, Open  ]],
Cell[774259, 18300, 160, 4, 29, "Input",ExpressionUUID->"e589a11d-8cb2-42a2-9d73-4a0cc5255446"]
}, Closed]],
Cell[774434, 18307, 139, 4, 54, "Section",ExpressionUUID->"39ed1d48-63a5-4efb-bcef-7b64dfe1d017"],
Cell[774576, 18313, 170, 4, 54, "Section",ExpressionUUID->"dd66f057-db78-49d6-9fd9-189b65743a87"],
Cell[774749, 18319, 130, 4, 54, "Section",ExpressionUUID->"9d64e97a-daf9-489a-b86e-8a6b45e34461"],
Cell[774882, 18325, 147, 4, 54, "Section",ExpressionUUID->"64646392-2c84-44bd-8289-d306a45113a6"]
}
]
*)

